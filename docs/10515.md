# 学习 SQL 对 Rails 开发人员仍然重要的 7 个原因

> 原文:[https://dev . to/rura city/7-reasons-why-learning-SQL-is-important-for-rails-developers-4jbk](https://dev.to/ruralocity/7-reasons-why-learning-sql-is-still-important-for-rails-developers-4jbk)

> 最初发布在[日常 Rails](https://everydayrails.com/2019/02/18/rails-sql-requirements.html) 中，但我不认为它只适用于 Rails 开发人员！我很想听听使用其他语言和框架的人是怎么想的。

我记得我第一次学习 SQL 的时候，那时我正和我的恐龙朋友们在一个山洞里编写 Perl CGI 脚本。太神奇了。作为软件工程师，这是我职业生涯中具有变革意义的一步。如果没有这种最初的理解，即如何将业务概念分解成离散的表，然后用简单的英语(嗯，算是)语法在这些表之间进行链接和搜索，我就不会有今天的成就。

那时候，我和我的恐龙同事必须自己编程构建每个`INSERT`、`UPDATE`和`SELECT`。那时我们没有使用对象关系映射器(它们可能已经存在了；他们只是不在我团队的关注范围内)。很多时候，构建 SQL 查询是乏味且容易出错的。因此，想象一下当我第一次使用 Rails 并开始用优雅的 Ruby 代码替换原始 SQL 来执行相同的数据库操作时，我有多高兴。

今天，在创建我的第一个 Rails 应用整整 14 年后，我很少需要编写自己的 SQL。活动记录为我解决了单调乏味的问题。如果使用正确，它可以帮助我避免愚蠢的错误和安全漏洞。而且，说实话，我对 SQL 的即时记忆已经消退到了这样一种程度，我不得不掸掉一些蜘蛛网，稍微努力地思考一下如何在那些场合执行任务活动记录*不是*的一个选项。

我最近开始思考，在活动记录如此强大的情况下，对于一个 Rails 开发人员来说，了解任何 SQL 有多重要？

虽然可以肯定地说，您可以在不了解与底层数据库通信所使用的语言的情况下构建一个非常有用的应用程序，并且在 Rails 应用程序的上下文中，依靠活动记录几乎总是比手工制作的 SQL 更可取，但是对 SQL 有一定程度的理解至少在七种情况下是有用的。

## [](#craft-better-queries-with-active-record)利用活动记录创建更好的查询

当您希望在查询中包含单独表中的数据时，会发生什么情况？如果你懂 SQL，你就会知道这是一个`JOIN`的工作。Active Record 方便地包含了一个`joins`方法来完成这个任务，但是如果你不知道行话，或者背后的概念，你可能会发现自己在盲目地寻找答案。

## [](#perform-queries-that-active-record-cant-do)执行活动记录不能执行的查询

活动记录提取了大量 SQL，但不是全部。例如，在 Rails 5 发布之前，您不能单独使用活动记录来执行`LEFT OUTER JOIN`。如果您的应用程序仍然是旧版本，或者您需要使用数据库供应商特有的 SQL 函数，那么您需要手工编写 SQL 查询。

这带来了一个缺点:活动记录背后的部分魔力是它跨多个数据库供应商应用的抽象层。代替它编写原始 SQL 会降低代码的可移植性，这意味着如果您选择从一个数据库引擎切换到另一个，您可能需要重写该查询。当采用这种方法时，确保您已经有了可靠的测试覆盖。

也就是说，我只能想到几次我不得不切换应用程序的数据库引擎。因此，如果您不得不手动编写 SQL，不要惊慌，因为活动记录不支持您需要直接执行的查询。

## [](#perform-adhoc-queries)执行临时查询

您的应用程序可能有一个强大的管理仪表板，在一个光滑的用户界面中呈现漂亮的报告——但是当被问及一些不能通过 UI 立即获得的数据时，您该怎么办？根据您的生产设置，您对数据的唯一直接访问可能是通过数据库控制台。仅通过 SQL 了解数据库就可以帮助迅速回答这种一次性问题。

## [](#improve-application-performance)提升应用性能

在后台，Active Record 必须执行一些额外的步骤，将来自 Ruby 方法链的查询转换为 SQL 命令，以便传递给数据库引擎。通常情况下，已经足够快了。不过，有时候并不是这样。在这些情况下，理解如何编写一个 SQL 查询来快速准确地获得您需要的信息是至关重要的。

关于数据库供应商锁定的同样警告也适用于此。如果您使用只适用于当前数据库供应商的性能技巧，那么如果您切换引擎，您将需要重写查询。

## [](#understand-legacy-code)了解遗留代码

活动记录在 Rails 的每个版本中都获得了新的特性。如果您的应用程序已经存在了一段时间，您可能会遇到当时活动记录无法执行的查询，因此是手工编写的。对 SQL 有所了解之后，您就可以理解早期开发人员需要用这些代码和查询来完成什么了。您可以放心地修改查询，甚至可以将其移植到活动记录的现代版本中。

在我这里列出的原因中，这是我在工作的代码库中最常遇到的一个。当与漂亮的 Ruby 代码并列时，原始 SQL 确实很突出，但我知道过去的开发人员不会无缘无故地把它偷偷放在那里。有时，我能够使用那些过去的开发人员无法使用的活动记录工具来重写查询，并为未来的开发人员最小化上下文转换。

## [](#work-outside-of-rails)在铁轨外工作

我曾经专业地使用 Ruby、Perl、Python、PHP、ASP、JavaScript，可能还有其他一些我忘记的语言来开发 web 应用程序的后端。在所有这些场景中，基于 SQL 的数据库是不变的。如果您发现自己使用的语言或框架与 Ruby on Rails 不同，那么从框架连接到数据库的技术可能看起来完全不同——但是在本质上，很可能仍然是 SQL。理解基础知识将有助于您了解所述框架的数据库交互方法的独特之处。

## [](#prepare-for-job-interviews)准备工作面试

最后一条可能有点无礼，而且毫无根据——但它也让我想到了足够了解 SQL 来写这篇文章的好处。尽管活动记录是可靠的，工作描述仍然经常将对 SQL 的理解列为一项要求。如果你明天早上去面试，你能表现出这样的理解吗？

现在，我不同意对已经很紧张的候选人进行拷问，询问他们在工作中很少遇到的技能和概念，但不是每个人都同意我的观点。正如我现在所希望的那样，有很多其他合理的理由让你对 SQL 有所了解，因为你永远不知道它什么时候会有用。