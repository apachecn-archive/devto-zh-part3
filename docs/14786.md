# tmux 窗口杂耍

> 原文：<https://dev.to/dlains/tmux-window-juggling-5e7k>

我不断发现越来越多的深度。这确实是一个了不起的软件。在这篇文章中，我将向你展示如何把一个 *tmux* 窗口变成一个窗格，反之亦然。

为什么要在 *tmux* 会话中移动窗格和窗口？我将解释我的场景，也许这能给你一些你自己的想法。

## 调试会话

我为我所有的项目创建了 *tmux* 脚本。这允许我简单地运行脚本，在一个 *tmux* 会话中启动并运行给定项目的开发环境。

对于一个 Rails 项目，我通常有一个运行 Rails 服务器的名为`server`的 *tmux* 窗口。我把它放在列表的最后一个窗口，因为我不需要经常查看它。

不过，我也用 Byebug 调试 Ruby。如果你以前没有使用过 Byebug 或类似的调试器，那么它的工作方式是在你的代码中你想要断点的地方添加一个`byebug`语句。当您运行代码时,`byebug`语句将暂停进程并将控制权转移给调试器。

在 Rails 项目中，服务器正在运行代码，因此当 Byebug 遇到断点时，调试器会在服务器窗口中停止。然后，您可以像平常一样与调试器交互，检查变量、单步执行代码等。

现在你或许可以看到这将走向何方。调试 Rails 时，将服务器窗口放在我的编辑器旁边的分割窗格中会非常方便。这样我就可以在同一个 *tmux* 窗口中看到相关的代码和调试器。

## 窗口变成窗格

我们需要的第一个 *tmux* 命令是`join-pane`。使用`join-pane`命令，你可以将 *tmux* 中的一个窗口或窗格附加到当前窗口。`join-pane`命令的形式如下。

```
join-pane [-bdhv] [-l size | -p percent] [-s src-pane] [-t dest-pane] 
```

谢天谢地，我们不需要所有这些选项。`-s`选项用于指定要加入当前窗口的源窗格或窗口。

可能需要快速复习一下如何在 *tmux* 中引用东西。

```
[session]:[window].[pane] 
```

例如，如果您当前的 *tmux* 会话被命名为`giggles`，那么对第二个窗口中第三个窗格的引用将是`giggles:2.3`。如果您当前处于包含要引用的窗口的会话中，则可以省略会话名称。是的，这意味着你可以使用`join-pane`将一个窗口或窗格从不同的 *tmux* 会话移动到你当前的会话。

对于我的例子，我想移动整个窗口，所以我可以只使用`-s N`，其中`N`是我感兴趣的窗口号。你也可以通过名字来移动窗口，所以`-s server`也可以。

`-l`和`-p`参数可以用来适当地调整新窗格的大小。我对默认的 50/50 分割很满意，所以没有必要使用任何一个。

`-t`参数可用于将源代码窗格移动到当前窗口之外的某个位置。也不是我需要的选项。`-b`选项与`-t`一起指定新窗格应该放在目标窗格的左边或上面。

当您完成`join-pane`命令时，接合窗格将被激活。如果你不想这样，你可以使用`-d`选项。

`-h`和`-v`参数分别使新窗格成为水平或垂直窗格。

现在，我可以整理出我需要的第一个命令了。对于这个调试会话，我想将我的`server`窗口移到我的`editor`窗口。首先我用`<Prefix>:`进入命令模式。现在`join-pane`命令:

```
join-pane -h -s server 
```

这就是我的服务器窗口，紧挨着我的编辑器窗口。关于 *tmux* 的一件奇怪的事情是它如何处理水平和垂直分割。上面指定的`-h`参数产生了我所说的垂直分割。左边有一个窗格，右边有一个窗格。`-v`参数正好相反，将一个窗格放在顶部，另一个放在底部。

## 窗格变成窗口

使用`break-pane`命令，反转`join-pane`操作，使窗格成为窗口。`break-pane`命令的格式如下。

```
break-pane [-dP] [-F format] [-n window-name] [-s src-pane] [-t dest-window] 
```

同样，我们不需要所有这些选项。就像使用`join-pane`命令一样，如果你指定了`-d`选项，移动后窗口不会被激活。`-P`参数告诉 *tmux* 打印关于新窗口的信息，而`-F`参数提供格式化该信息的能力。

如果你没有用`-s`指定一个源窗格，那么当前活动的窗格将被分解到它自己的窗口中。否则，您可以指定窗格以与对`join-pane`相同的方式移动。

窗格不像窗口那样命名，所以当你移动一个窗格到它自己的窗口*时，tmux* 将使用窗口的默认名称，也就是当前命令。如果您想命名窗口，使用`-n`参数和窗口名称。

另一种选择是，如果您有一个想要将窗格移动到的现有窗口，您可以使用带有所需窗口引用的`-t`参数。

对于我来说，当我完成调试会话时，我只想将窗格移回它自己的名为`server`的窗口，我不需要它处于活动状态。我宁愿`editor`窗口保持活动状态。我可以用下面的命令来实现(记得先用`<Prefix>:`激活命令模式)。

```
break-pane -d -n server 
```

这告诉 *tmux* 将当前活动的窗格移动到窗口列表末尾的新窗口，不要激活它，并将其命名为`server`。

## 创建按键绑定

根据需要，以特别的方式使用`join-pane`和`break-pane`命令来移动窗格并不困难。这需要一点输入，但是如果要移动的窗口没有命名，或者你需要移动不同的窗口，你就不得不使用命令本身。

在我的例子中，我知道`server`窗口总是可用的，因为它在设置环境的 *tmux* 脚本中。因为我知道窗口名称不会改变，所以我可以为这些命令创建键绑定。作为一个额外的好处，这些键绑定只对这个会话可用，因为它们不在主`.tmux.conf`文件中。

```
tmux bind-key u join-pane -h -s server
tmux bind-key U break-pane -d -n server 
```

现在，每当我想在我的代码旁边看到`server`窗口，我只需输入`<Prefix>u`就可以了，要让它回到自己的窗口，我可以输入`<Prefix>U`。

*最初发布于[davidlains.com](https://davidlains.com)。*