# 摊余复杂性分析的第一个例子

> 原文：<https://dev.to/tadaboody/amortized-complexity-analysis-1323>

有时对于数据结构，某些操作的成本“会相互抵消”。有些手术成本很高，但“发生的频率比其他的要低”，总的来说，我们会没事的。但是我们怎么知道什么时候呢？我们可以用它来展示我们的数据库更好吗？

在这篇文章中，我将通过几个例子解释分摊(或累积)复杂性，包括一个你可能在很多程序中使用的例子。

我假设你已经掌握了算法和数据结构的基本知识，包括最坏情况复杂性分析和大 O 符号。
如果没有，已经有几篇关于这个主题的文章，包括

[![metcoder95 image](img/40a54184a3e5016e0c369af207d08a16.png)](/metcoder95) [## 大 O 符号:初学者指南

### 卡洛斯·富恩特斯

#computerscience#codenewbie#webdev#beginners](/metcoder95/big-o-notation-beginners-guide-1h38)

我知道这一开始看起来有点棘手，甚至有点傻，但我希望至少有一个例子能坚持下去。

# 多弹出堆栈

在我们的第一个例子中，我们考虑具有三个操作的堆栈

*   这在我们的栈顶添加了一个新值
*   `Pop()`移除并返回顶部值
*   `MultiPop(pop_amount:int)`移除并返回栈顶值的`pop_amount`。

假设我们使用‏simple 链表实现了这个结构，让我们分析一下每个操作的最坏情况的复杂性。
将推送/弹出操作实现为插入/删除尾部将导致每个操作花费恒定的操作量，或`O(1)`时间。

那多波普呢？假设我们弹出 k 个最大值，那么它将需要 k 次操作，即 O(K ),因为我们不能‏pop 比堆栈上更多的值，所以该操作的最大最坏情况复杂度是 O(n ),其中 n 是堆栈的大小。

等一下。
假设我将 n 个值压入堆栈，然后使用`MultiPop(2)`，`n/2`次。

根据我们最坏的情况分析，我们将采取`O(n) + (n/2)*O(n) =O(n^2)`行动！但是如果我们使用两次`Pop()`而不是使用一次`MultiPop(2)`，那么在最坏的情况下，它将需要`O(n) + (n/2)*2*O(1)=O(n)`操作！
请问什么？
[![Confused face gif](img/844b13105522dffe1e7e7c21931e1af2.png)T8】](https://i.giphy.com/media/l3q2K5jinAlChoCLS/giphy.gif)

在我们恐慌之前，让我们记住对`O(n)`的最坏情况复杂性分析意味着这个动作可能需要*到*的 n 次操作，不一定每次调用这个操作都会有这么高的成本，那么我们如何准确地分析成本呢？
我们知道 multi-pop 没那么贵。所以还是尽量摊销吧！

```
am·​or·​tize
amortized; amortizing
Definition of amortize 

transitive verb

1 : to pay off (an obligation, such as a mortgage) gradually usually by periodic payments ... 
```

([万博](https://www.merriam-webster.com/dictionary/amortize))

这就是摊销分析的用武之地——我们需要看更大的图片！我们不单独看操作，而是看一系列的`push` / `multiPop`操作。
现在，因为我们不能弹出比我们已经推送的更多的内容，如果我们检查一系列推送、弹出和多次弹出，则弹出的总量小于推送的总量。
换句话说，假设我们有一系列 m 个动作，`pu`其中有推。无论有多少种持久性有机污染物是单一持久性有机污染物还是多种持久性有机污染物，其总量都不能超过钚。换句话说，业务摊余金额为`O(pu) + O(pu)=O(pu)`。
重新分析我们的上一个例子，我们做了`n`推送操作，所以`pu=n`。因此，我们得到了`O(n) + total amount of pops <= O(n) + O(n) = O(n)`操作，而不是多 Pop 取`O(n^2)`操作——这与我们只使用单 pop 得到的结果相同。
世界又有意义了！
使用这种分析，我们可以说，在任何种类的一系列 m 个动作中，总共我们将进行 O(m)次操作，或者每个动作 O(1)次操作。
表示我们的*摊销*多弹出栈中每个操作的时间复杂度是`O(1)`，即使对于`multiPop`操作，也是通过推送操作“还清”的。直觉又赢了！

在下一篇文章中，我将展示一些你可能已经用过的更实际的例子。以及进行这种分析的更正式的方式。