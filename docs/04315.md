# 构建日志:情感-聊天 pt2

> 原文:# t0]https://dev . to/tttaaanningg/感觉聊天-pt2-3lad

# **事情的状态**

我现在已经有了基本的功能。还没有交流，但我可以接受文本输入，提交文本，并呈现/保存情感分析的结果。

我的前端在反应。我们有一个包含两个组件的容器:一个“历史”显示组件和一个“输入”组件。

我们将状态保存在一个钩子内，useReducer。

我们的状态是这样的:`{text: '', sent: 0, history:[]}`。`text`是我们输入框的内容，`sent`是应用于我们字符串的`sentiment`的结果，`history`是先前文本和情感结果的数组。

我在使用 useReducer 挂钩时遇到了一些问题，但最终都归结于我没有正确格式化我的操作。

到目前为止，我们得到的大概是这样的:

**表单组件**

*   状态由 useReducer 维护，并在更改时更新
    *   当一个人在聊天框中输入时，字符串会遍历`sentiment`，并在每次文本更新时生成一个新的评级
*   有一个事件监听器，用回车键确认“发送”
    *   将消息和评级存储在我们州的“历史”数组中

**消息组件**

*   从消息历史中获取情感，并构建一系列消息组件

**消息组件**

*   在`<p>`标签中显示每个情感对象的情感等级。我们稍后会处理展示。

# **MVP 的下一步**

为了让 MVP 功能正常工作，我需要完成两件主要的事情。

**Websockets**

*   我想使用 Websockets 进行交流
    *   一旦我把新消息放入并存储在数组中，我可能会把它们发送给 useReducer

**显示**

*   必须把数字转化成颜色
    *   可能是基于传递给`Message`组件的道具的内联样式？

现在我对 websockets 是如何工作的还没有最好的理解，所以集成它们可能是一个挑战(朋友们已经推荐了 [socket.io](https://socket.io/) 作为替代，如果你们中的任何人对优点/缺点有意见，lmk！)

# **其他想法/很高兴有**

情绪并不是一个特别令人兴奋的库。我很欣赏它的存在，但有点令人失望的是，它本质上是一个单词的散列表/ -5 到 5 个积极/消极的评级，它基本上是平均得到最终结果。如果我感觉有点雄心勃勃，我可能会使用 [NLTK](https://www.nltk.org/) 。提升一个节点子进程来运行一个 python 脚本似乎并不太难，至少根据[这篇文章](https://www.sohamkamani.com/blog/2015/08/21/python-nodejs-comm/)来看是这样，如果能有更健壮的 NLP 东西来玩就好了。

如果我走这条路，计算从客户端计算机转移到服务器。网络请求可能会太慢，无法基于文本输入进行实时更新，特别是如果我想象这个东西有一个实际的用户群(它不会 b/c 它主要是一个艺术项目)。也许我可以在客户端保留一些基本的操作，在服务器端保留一些奇特的功能。

除此之外，我还想实现一些 UI/UX 的东西。我认为这种体验的一个关键是，用户除了凭直觉或猜测之外，无法知道他们在传达什么样的情感。

用户发送的消息将以纯文本显示，而从另一个用户接收的消息将以彩色显示。也许在聊天结束时，我们会给用户一个下载聊天记录的机会，可以是彩色的，也可以是信息和颜色的组合。

为了获得正确的体验，我必须非常注重造型和过渡。我可能应该先从 websockets 开始。我打算把样式留到最后，因为它将建立在我所做的任何其他前端脚手架之上。

最后，我将通过部署到 [zeit](https://zeit.co/) 来完成它，因为我是一个小气鬼。(或者，我会将 w/Docker 打包并在 AWS 上发布，以展示 DevOps 的实力)

# **对目前进程的想法**

老实说，我没想到要花两天时间才能做到这一点，包括让 webpack 正确地传输内容(许多演练已经过时或产生错误)，在我的前端处理数据流，计划，以及(当然)为你们写这些文章。不过，完成这个过程确实很好！