# 首次尝试系统设计

> 原文:[https://dev . to/tttaaannnggg/a-first-timer-tries-system-design-4ae 9](https://dev.to/tttaaannnggg/a-first-timer-tries-system-design-4ae9)

所以，我今天第一次参加了系统设计面试。这是一次艰难的经历。

简要情况如下:

我们想建立一个电子商务网站，向公众出售农产品。分销不是问题。我们在本地区拥有一个由大约 1200 名农民、两名买家和 100，000 名消费者组成的网络。农民提供不同数量的农产品，但每个农民最多只能得到大约 20 种不同类型的农产品(大多数都很小，即使是最大的也不会比这多多少)。它们都位于南加州。

所以，我们有三种类型的用户。农民(批发商)、买家(中间商)和消费者(公众)。

### [](#wholesalers)批发商

批发商需要几样东西。他们需要

*   清理他们当前的库存(他们在卖什么？有多少？什么价格？)
*   联系买家
*   查看买家提供的商品价格

### [](#buyers)买家

买家需要

*   来追踪他们自己的库存
*   看看批发商有什么存货
*   联系批发商

### [](#consumers)消费者

消费者需要

*   查看有什么可以购买的
*   购物

因此，我是这样处理这个问题的。我没能在 45 分钟内完成。

## [](#frontend)前端

基本上应该有 3 个不同的方法在前端 UX。批发商和买家应该有更多面向业务的界面。

对于批发商，我们希望他们能够跟踪最近的销售和正在进行的销售，并在首页上快速添加/维护他们的库存。

对于买家来说，我们希望把库存跟踪放在前面和中心，并提供工具来方便购买产品的报价和销售产品的定价。

对于消费者来说，我们需要一些基本的登录页面，浏览和搜索产品的工具，要维护的购物车，以及一些购买页面。

我在前台有点被 UX 缠住了，讨论诸如为用户提供算法建议、为批发商和买家提供历史跟踪和数据分析之类的事情。这些事情并不是严格意义上的错误，但是可能会占用一些时间，而这些时间是完成整个架构所需要的。有人告诉我，我本可以更多地谈论前端的技术堆栈，并根据我自己的经验/专业知识提供建议。

## [](#backend)后端

我决定我们应该使用某种 SQL 数据库，但是没有指定我认为哪个实现是最好的。使用 SQL 的基本原理是，数据本质上是合理的关系型数据，并且它处理货币交换，因此拥有符合 ACID 的存储(和冗余，但我们将在架构中实现)将非常重要。

我只做了一个数据库模型。

在我的模型数据库中，我设想用共享的外键创建一系列对应于买方、批发商、消费者、批发库存和买方库存的表。

我的数据库的一些组织开始失控，我的面试官慷慨地告诉我，我可以将我的数据库重新组织成一个更有效的形状。根据“名词”来组织我的数据会更有意义，而不是按照我的方式分组。比起购买者/批发商/消费者，更有意义的是有一个“人”的表，它可能有一个区分角色的字段(“购买者”/“批发商”/“消费者”)，子表将添加我们需要的任何附加信息(供应商 id？信用卡？地址？).

这是有意义的，因为用户都有某些共同点。买家、批发商和消费者都需要联系信息和姓名。产品也应该存在于一个单一的表格中，因为批发商、买家和消费者都需要知道什么是可用的，有多少，成本多少(尽管这对买家和生产商来说是一个稍微不同的问题)，何时收获(知道在腐烂之前需要消费什么)。

更细粒度的信息可以保存在子表中，这些子表具有指向主表的外键引用。如果需要，可以通过买方和批发商库存的 SQL 连接来完成总库存计数。

我没有时间处理交易数据库，但我假设同样的模式也适用，价格/买方/卖方在整个系统中都适用。

## [](#architecture)建筑

就建筑而言，我们相当幸运。一个拥有 10 万用户的电子商务解决方案不会给系统带来太大压力，一个杂货店购物应用不需要像 Instagram、网飞或 YouTube 那样处理相同的流量或负载。它在地理上也是连续的，因为一切都是本地的，所以我们不必担心延迟。

本质上，我们可能有几个 web 服务器来处理流量。就容量而言，我们可能不需要超过一个或两个，但拥有一定数量的冗余是一个好主意，这样，如果一台服务器停机，我们的操作可以继续。在数据库方面，我们也有类似的情况。

它不是一个实时应用程序，所以延迟不是 100%重要的。我们可以为最常访问的数据实现直写式服务器端缓存。客户端缓存将是产品摄影的一个选项，但我们肯定希望提供最新的价格和产品可用性(这是相当轻量级的数据)。

随着时间的推移，我们的事务历史数据库可能会增长到需要共享数据库的程度。我不确定确切的截止时间是多少，但旧的事务可以被推到冷存储，确保我们仍然可以快速读取最近的事务。

## [](#conclusion)结论

无论如何，就我所能想到的，这是关于这种规模的系统设计。如果我们继续扩大规模，或者有更多的交易，我们需要开始考虑如何分配我们的服务器和数据库。我们可能会开始考虑负载平衡和 cdn。

其他几件事:我的心态肯定不太好。我非常紧张，时间过得有点奇怪。

除了我缺乏的技术知识之外，我认为我遇到了两个主要的挑战。其中一个是弄清楚在设计 UI/UX(以及一般的范围)方面如何细化，另一个是我没有领域知识，不太确定什么信息对我们的用户来说是优先的(我不得不问很多澄清性的问题，并猜测什么是有价值的)。总的来说，我肯定可以更好地利用我的时间(如果能真正完成这件该死的事情就太好了！)，但我觉得第一次尝试也没那么可怕。

(显然)我对这种事情不太有经验！如果你对系统设计有任何建议、评论或资源，我会非常感激！