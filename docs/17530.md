# 如何编写真正面向对象的程序

> 原文:[https://dev . to/rlxdprogrammer/how-to-write-a-really-object-oriented-program-2d nb](https://dev.to/rlxdprogrammer/how-to-write-a-really-object-oriented-program-2dnb)

**简介**

当我开始采访我们团队的新候选人时，我意识到面向对象编程是一个大多数人都不清楚的话题。对于问题:“你知道什么是面向对象编程吗？”我通常得到的回答是:是的。对于后续问题:“你能简短地告诉我是什么吗？”我从来没有得到两次相同的答案。我得到了很多好的答案，也有很多答案与我的理解不太相符。在某个时刻，我开始思考如何回答这个问题，我意识到这一点都不容易。

还有一个例子:我需要为我的组件重用一个已经存在的 C++代码。它基本上是一个包含大约 200 个函数和 100 个变量的类，所有这些函数和变量都是公共的，并且不清楚它们代表什么。经过分析后，我发现我不能像现在这样重用它，原因有很多:

它使用了第三方记录器，我不想把它包含到我的项目中

最初使用它的程序是基于 TCP/IP 通信的。如果 TCP 通信没有正确建立，大多数函数都会抛出异常，即使它们与此无关

一些成员变量被用于目的完全不同的多个函数中。所以如果你想从外部调用一个成员函数，首先你需要设置 ca。10 个成员变量的正确值，以便能够从函数中得到一些结果。

考虑到所有的事情，我决定在重用这段代码之前对其进行重构，这花了我很长时间才弄明白如何做到这一点，因为许多函数需要解耦到一个单独的类，并且需要弄清楚每个变量对不同的函数有什么影响。那是一场噩梦。当客户问我为什么需要这种重构时，我只是回答说:“因为它不是以面向对象的方式实现的。”。在这一点上，他告诉我:“为什么不，它都是在一个类中实现的，所以它是面向对象的。”。好的，从技术的角度来看，它是在一个类中实现的，所以它是面向对象的，另一方面，它没有遵循任何对我来说意味着面向对象编程的东西。

在这篇文章中，我想向您展示面向对象编程不仅仅是使用相关的编程语言元素，它的意义远不止于此。在我看来，你也可以用官方不支持的语言(如 C)进行面向对象的编程，你也可以用纯面向对象的语言(如 Java 或 C#)进行非面向对象的编程。我来给大家展示一下我对 OOP 的理解。

**面向对象编程原理**

首先让我们看看 OOP 的官方定义。我在这里找到了一个清晰的定义:[https://www . techopedia . com/definition/3235/object-oriented-programming-OOP](https://www.techopedia.com/definition/3235/object-oriented-programming-oop)

上面写着:

*“面向对象编程(OOP)是一种围绕对象构建的软件编程模型。该模型将数据划分为对象(数据字段)，并通过声明类(方法)来描述对象内容和行为。

OOP 特性包括以下内容:

封装:这使得程序结构更容易管理，因为每个对象的实现和状态都隐藏在明确定义的边界后面。

多态性:这意味着抽象实体以多种方式实现。

继承:这是指实现片段的层次安排。

面向对象编程允许简化编程。它的好处包括可重用性、重构、可扩展性、可维护性和效率。"*

让我们先来看看它的特点:

**封装:**我觉得这是最重要的一个。每个对象都有一个对其他对象隐藏的状态。另一方面，每个对象都有一个“实现”。我认为对象的成员函数。状态和实现一起是一个单元，或者用 OOP 术语来说是一个对象。因此，如果你的对象是一个矩形，它会有一个状态，包含宽度、高度、位置、颜色等元素。它将有一个实现，实现成员功能，如:移动，调整大小，绘画等。这是一个物体，不多也不少。

**遗传:**我会先提多态性，因为不然很难理解。继承代表父类/子类别名基类/继承类之间的连接。因此，对于每个类，你可以定义所谓的子类，它可以做基类能做的一切(具有相同的公共方法和成员变量)，但它可以过度定义方法的实现，它可以扩展功能(引入新的成员函数和成员变量)。例如，你有一门动物课。每种动物都能自己移动。但是如果每个动物都不一样，他们如何移动自己。因此，不同的动物将从动物基类继承，并将覆盖 move 方法的实现。另外，一些动物有一些额外的技能，比如狗会叫。所以你可以为 Dog 类定义一个 bark 方法。

多态性:这正是我所说的动物的移动方法。例如，你可以有一个动物的集合，你可以为它们中的每一个调用 move 方法，你不应该介意它是如何为动物实现的。

这是官方的说法。让我们进一步用一些实际的理论。

**对象和类以及它们之间的联系**

从面向对象编程的名称我们可以看出，对象是这种范式背后的基本单位。下一个重要的特性是类。但是对象和类的关系是什么:类实际上是一个集合，是相似对象的模板，是具有相同方法和成员变量的对象的模板。所以如果你有一个矩形，那么你将有一个矩形对象，它是矩形类的一个实例。rectangle 类定义它需要有一个大小和一个位置，而对象拥有它的确切大小和位置。有些编程语言(如 JavaScript)不需要定义对象的类。在这种情况下，对象是基于所谓的原型创建的。

所以当你计划一个面向对象的程序时，首先你需要考虑你的程序需要什么样的类。

另一个重要的问题是:这些类之间有什么联系。

类之间有 4 种类型的连接:

**构图:**

这意味着连接的类属于我们的类。它们具有相同的生存期(它们在同一时间创建和删除)。我们的班级离不开相关的班级。就像如果我们有一个叫做 House 的类和一个叫做 Wall 的类，那么它们之间很可能会有组合。

**聚合:**

类 A 和 B 之间的聚合意味着类 A 有一个类 B 的实例。但是车主没有车也可以存在，车没有车主也可以存在，车主可以随时更换。

**关联:**

类 A 和 B 之间的关联意味着类 A 正在使用类 B 的一个实例。通常，对象之间的这种关系只是一种短期关系，仅在特定函数运行期间。例如，你有一个类，它有一个日志函数。但是这个日志函数需要 Logger 类的一个实例作为参数。这是一个典型的联想例子。

**继承/概括:**

这是前面已经提到的关系类型。这意味着 A 类是 b 类的一个特例，也称为子类/父类。

所以接下来要做的是决定你的类之间有什么样的关系。为你的类做一些图形建模会有一个更好的概览。为此，UML 的类图是一个很好的工具。我建议在开始编程之前，至少在纸上做一个你的课程计划。

我想澄清另外两个定义:

**对象的状态:**事实上，这是基于所有成员变量的当前值建立的。所以如果你改变了至少一个成员变量，你的对象的状态也会改变。

**类的公共接口:**这是所有公共的方法和变量，从类的外部是可见的。

基于此，你可以做一个你需要的类的计划，但是在 OOP 编程中仍然有一些所谓的“最佳实践”。

**固体**

这些最佳实践被称为可靠的。这代表以下内容:

**单一责任原则**

你的每个班级都应该有一个简单明确的责任。你应该能用一句话描述这门课的目的，而不用“和”和“或”这样的词。所以是的:大班是大多数违背这个原则的情况。

**打开/关闭原理**

您的代码应该对扩展开放，但对修改关闭。

**利斯科夫替代原理**

这可能有点复杂。但这意味着，你的每个父类都可以用它的任何子类来替换，而不会影响功能。这来自于一种叫做“契约设计”的东西。我打算单独写一篇关于这个话题的文章。

**界面偏析原理**

你的界面应该小而清晰，并且有一个明确的目的。所以你应该避免使用返回大量数据的接口。所以你的类的公共接口需要设计得很好，并且易于使用。把一切都公开不是好做法。

**依存倒置原则**

你应该以这样一种方式设计你的类，作为你的类的依赖的类可以通过一些 setter 函数或者构造函数参数来设置。以便以后可以将它们更改为任何子类型。例如，如果您有一个用于创建日志文件的 Logger 类，并且您可以通过 setter 函数来更改它，那么您可以在 XMLLogger、JSONLogger 或 SimpleLogger 之间更改您的 Logger，如果所有这些类都是从同一个 Logger 基类派生的话。如果在单元测试中你需要模拟你的依赖关系，这也是有帮助的。

让我用我自己的建议来扩展它:

总是尽量保持所有成员变量(也就是你的类的状态)私有，并使用 setter 和 getter 函数进行更多的控制

总是试图为你的类设计一个用户友好的公共接口

避免在成员函数中使用长参数列表，在这种情况下，如果有意义的话，总是要考虑将一些参数转换成成员变量

阅读面向对象设计模式，尽可能使用它们

**实践中的面向对象编程**

现在，在熟悉了所有的理论之后，我想加入一个简短的实例。这是关于实现一个画布，可以可视化不同的形状，如矩形，圆形，三角形和星形。

一个不是真正面向对象的解决方案是用成员方法创建一个画布类，如:drawRectangle，drawCircle 等。但是这种解决方案并不好，它没有使用面向对象编程的特性，并且很难扩展你的代码(这违背了开放/封闭原则)。

基于这一点，我的建议如下:

创建一个画布类。它应该有一个形状的集合(与形状类聚合)。它还应该有成员方法，如用于添加新形状的 addShape 或用于删除已添加形状的 deleteShape。它应该有一个 drawAll 功能，绘制所有添加的形状。Shape 是一个具有 draw 方法的基类。每个形状都有一个(组合)大小和位置。Position 是一个具有 x 和 y 坐标属性的类。Size 有一个 with 和一个 height 属性。每个特定的形状(矩形、三角形、圆形和星形)都是形状的子类。以便它们中的每一个都有一个位置、一个大小，并且它们都应该实现 draw 函数。有了这个解决方案，用新的形状(只需实现新的子类)来扩展程序，改变位置在其他坐标系中的表示是相当容易的。

**总结**

如果你是一个有经验的软件开发人员，也许我没有告诉你任何新的东西，但根据我的经验，许多程序员对这个话题有不清楚的理解，所以我真的希望我能帮助他们。根据我对这种理解的经验，你可以确保你的工作质量更好。

[http://howtosurviveasaprogrammer.blogspot.com/](http://howtosurviveasaprogrammer.blogspot.com/)