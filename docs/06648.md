# 并发、并行和异步。网

> 原文:[https://dev . to/scotthannen/concurrency-vs-parallel-vs-async-in-net-3812](https://dev.to/scotthannen/concurrency-vs-parallel-vs-async-in-net-3812)

我看了几个帖子，让我质疑我是否理解这些概念，或者能否解释清楚。有很多图表，至少对我来说，有太多的文字。那不是他们的问题，是我的问题。这有点尴尬，因为我已经编写了应用所有这三者的代码。

这里有一个简化它的尝试。尽管目的是使这些概念更容易理解，以便有人可以更详细地了解它们，而不是预先包括所有这些细节，但请随意提供更正。

虽然*并发*、*并行*和*多线程*不是一回事，但我认为最大的困惑是将这三个相关概念与*异步*执行(`async` / `await`)混为一谈。

另一个困惑是在。NET 代码中的“并发”和“并行”这两个词与它们在其他地方的用法不同。真不幸。我在这篇文章的末尾添加了一些澄清。

### [](#concurrency)并发

不同的线程同时在做不同的事情。一个简单的例子是一个 web 应用程序，它可以在一个线程上开始处理一个请求，然后，如果在它还在处理第一个请求的时候有另一个请求进来，就在另一个线程上开始处理下一个请求。

### [](#parallelism)排比

我需要完成 100 个任务。如果我把这项工作分配给多个同时工作的线程，我会完成得更快。

就是这个:

```
void ProcessThingsInParallel(IEnumerable<ThingINeedToProcess> things)
{
    Parallel.ForEach(things, thing => thing.Process());
} 
```

### [](#async)异步

这与另外两个混淆了，可能是因为它与线程有关。但这完全不同。

Async 描述了如何使用*单独的*线程。

*   如果我使用`SqlCommand.ExecuteNonQuery`执行一个存储过程，并且该过程运行了十秒钟，那么用于调用该方法的线程将在十秒钟内不做任何事情，除了等待。
*   如果我在一个`async`方法中使用`await SqlCommand.ExecuteNonQueryAsync`执行它，那个线程可以在十秒钟内做其他事情。当命令执行完毕时，该线程(或另一个线程——我们并不关心)将从第一个线程停止的地方继续执行。

这些不是全面的定义或详细的技术描述。根据我的经验，有时我们需要简单的解释，然后才能处理有大量图表的大文章。或者只是我需要这样。

也许当这是抛光了，我可以添加第二个职位与一些细节，我不想杂波这一个。

* * *

## [](#how-concurrency-and-parallelism-differ-when-speaking-of-net)谈到“并发”和“并行”有什么不同。网

我真的想让这篇文章简单明了。这不是命中注定的。

### [](#concurrency)并发

*并发*是指一次做多件事，但并不特指使用多线程。JavaScript 使用事件循环来实现使用单线程的并发性。

在…的背景下。NET 应用程序中，并发性几乎总是与并发线程的执行相关联。那很可能不是故意的。

考虑将 [`ConcurrentQueue`](https://docs.microsoft.com/en-us/dotnet/api/system.collections.concurrent.concurrentqueue-1) 和其他集合放在同一个名称空间中。描述是:

> 表示线程安全的先进先出(FIFO)集合。

如果我们的并发性不是使用多线程实现的，我们就不需要线程安全的集合。我们将只使用一个`Queue`。

在名称空间和类中使用“concurrent”这个词是准确的——这个词的意思是“同时发生的”但结果是当你和。NET 并发和多线程已经交织在一起。

如果“并发”意味着多线程，那么它与`async/await`无关。如果这意味着一次做多件事情，那么`async/await`通过允许单线程启动一个进程，然后做其他事情，而不是等待第一个进程完成，来支持并发性。

### [](#parallelism)排比

*并行*泛指通过在多个 CPU 之间分配工作来实现并发。所以在。当我们谈到并发性时，我们指的是并行性。

英寸当我们谈论并行时，我们通常指的是并行的一个子集，一个特定的应用。当我们有一组非常具体的计算要执行，我们将它分布在多个线程中。

为什么？看看微软的[任务并行库](https://docs.microsoft.com/en-us/dotnet/standard/parallel-programming/task-parallel-library-tpl)，你会发现大多数提到“并行编程”的链接都指向`Parallel.ForEach`或其他以一组任务开始并分发它们的实现。

这并不意味着。NET 开发人员对这些概念感到困惑。只是在文档或堆栈流讨论中，我们倾向于使用不同的术语。

请考虑这一段，它来自中一本名为 [*并发的书的描述。*](https://www.amazon.com/Concurrency-NET-patterns-concurrent-programming/dp/1617292990/ref=sr_1_1?keywords=concurrent+c%23&qid=1555438029&s=gateway&sr=8-1) 网，重点地雷:

> 释放您的多处理器机器内置的难以置信的性能。*并发应用运行速度更快，因为它们将工作分散在处理器内核上*，同时执行多项任务。现代工具和技术。NET 平台，包括并行 LINQ、函数式编程、异步编程和任务并行库，为传统的基于线程的并发性提供了强大的替代方案。

好吧，现在我知道不仅仅是我。并发等同于在不同处理器上执行的线程，基于线程的并发是“传统的”更重要的是，当任务并行库是一种使用多线程实现并发的明确方法时，它被称为基于线程的并发的替代方法。我想我知道他的意思，但是我们混淆了一些意思。

甚至指的是”。NET”在这一点上有点模糊，因为我们曾经把它等同于运行在多 CPU Windows 计算机上的软件，但现在它可以运行在各种各样的东西上。

现在我的澄清比原帖长，涉及三个术语的五个定义。真的很抱歉。