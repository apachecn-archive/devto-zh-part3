# ui 和网站可以做微服务吗？

> 原文:[https://dev . to/wparad/can-UIS-and-websites-be-microservice-22gi](https://dev.to/wparad/can-uis-and-websites-be-microservices-22gi)

我已经多次进行同样的对话，这告诉我是时候把它打出来，并与我所写的每一个社交媒体网站分享。在这种情况下，我想分享我对 UI 微服务的看法。

我就陈述一下:

你的网站应该被当作一流的微服务。不要让任何人告诉你不是这样。

我假设实际上没有什么不同，一个服务通过精心制作的 HTTPS url 路由返回 RESTful JSON，另一个服务通过精心制作的 HTTPS url 路由返回 RESTful HTML。除非你声称微服务需要返回 JSON，那么我猜这也排除了一开始就使用`Content-Type`头文件的好处(所以你当然不会提出这个论点)。

核心的重要性是解耦的性质，而根本的事实是今天的大多数网站都不是微服务。这是因为它们通常与一些“后端服务”紧密相关。作为一个快速题外话，我真的不喜欢这个词，就像我不喜欢“前端”一样。实际上，唯一的区别是用户使用的是用特定语言描述的“前端”,并显示在特殊的渲染引擎中。我指的是`HTML`和你的浏览器，还是`OpenAPI specification`和`Swagger`？`site-map`和`root basepath`之间的相似之处令人震惊。

因此，你应该把你的 ui 当成一等公民。这意味着为用户提供良好的 RESTful urls。他们不应该需要改变 url 中的一些字符来确保他们到达正确的位置。必要的令牌包含在那里，所以他们永远不会看到像*这是一个表单重新提交，你确定要这样做吗？如果出现这种情况，你就知道有人违反了休息时间。在 rest 中，您可以发出请求，并返回一个 409 错误，提示该请求已经提交。(对于训练有素的人来说，你可能会说，如果他们提出了一个继续请求，并得到一个失败的先决条件，那该怎么办？当然你是对的，但是我不记得上一次我看到一个 API 正确地实现了这一点，而且“重新提交警告”的例子比正确实现的 RFC 标准要多得多。*

为了配合这一点，我最近就合并请求进行了一次对话，并得到了以下评论:

> 我认为最好避免像`team?next=WW91clRlYW1pbmF0b3I%3D`这样的网址，它们看起来很神秘，也不太友好。

他们当然有，但`https://service.com/v1/route-path/6ed669b0-f8a4-48c0-9646-f04212f7e00d/sub-resources?q=search-string&s=more-order`也有，对吧？我的意思是，实际上我希望用户不要倾向于改变服务中的 url。至少在服务中，我可能提供了一些非 RESTful 文档来解释`q`和`s`查询字符串参数实际上是做什么的。

有一个我们想要提供什么样的经验和我们有什么样的工具去做的组合。假设我们开始违反 REST 一点点(只是一点点)，并开始向用户暗示这个不透明的 url 的内部语义是什么，并让他们对应用程序有所了解。

你可以争辩说，在某些情况下，数据位于应用程序逻辑的边界上，知道这些不会伤害用户。然而，在 REST 中，URL 是神圣的不透明的字符串，是不可解释的。我们应该记住这一点，在 url 中提供错误消息并不是一个好的模式，例如:

*   作为开发人员，我们决定一个路由的内部名称是`Hello-There`
*   我们决定告诉我们的用户这是“欢迎”屏幕

这真是太棒了，我们有一个解耦，但这并不意味着它们必须相同。现在，这两者之间出现了脱节，试图让我们所有的内部名称都符合预期是一种负担，并且在数据/路线和该信息的显示之间存在不必要的紧密耦合。也就是说，每次我们改变标题页，我们需要改变所有的引用。相反，你可以想象我们也把这条路线叫做`Welcome`。现在，当我们显示该路线时，您会得到类似于`https://route/welcome`的内容，当您将页面翻译成德语时会发生什么，您是否也提供了`https://route/guten-tag`。我要大胆地说，当然不是。这是因为路由中数据的呈现与我们使用的内部命名是分开的。此外，如果用户切换语言，我们会将他们重定向到不同的路径吗？我们会确定，但我会建议`https://route/guten-tag?lang=en`或`https://en.route/gutan-tag`，看起来会不会很奇怪！

实际上，在开发 Authress 时，我发现我们确实有类似的案例。在实验中，我们经常移动我们的“主页”屏幕。即使不再有独占的`Authentication`屏幕，我们仍然有大量指向`Authentication`的指针。事实证明这是一个非常好的主意。因为这意味着如果我们决定将授权屏幕从现在的`Home`屏幕(T3)中分离出来，一切都已经指向了正确的位置。现在，人们期望它们是同一个屏幕，这是通过路由器中的重定向来完成的，而不是要求所有的路由名称都与它们的用法相匹配。导航到`Authentication`总是有效的，导航到`Home`总是有效的，而且它们现在恰好是相同的。

在一些罕见的情况下，我们确实需要告诉用户他们在哪里，并为他们提供容易导航的路径，但这些也不是 ui 所独有的。

*   如果他们想去 Authress = >他们可以在浏览器中输入 url 是什么。
    *   由此推论，如果他们想了解你的服务的所有顶级路线，他们会去哪里？
*   他们在路由/管理上，这应该与他们在 UI 中看到的路由相匹配，也就是说，如果你在`/error-page` url 和你看到的`Welcome to Authress`网页上，那岂不是很糟糕。

实际上即使在后一种情况下`/manage`也应该被抽象掉。

> 但是我们可以为用户提供更漂亮的东西。

我将在这里用荒谬的极端来说明这一点。另一种看待这个问题的方式是，要求我们的账户服务返回一个人类可读的`accountId`,当然，我们可以这样做，但这实际上没有意义。用户不需要知道或关心`accountId`是什么，这给提供这些并确保它们有意义的服务带来了不必要的负担。更不用说帐户的描述/标题与 accountId 之间的耦合，如果没有差异，就无法更改一个。也就是说，如果账号有一个名字“账号一”，你会把任务命名为`account-one`还是`accout-one`(是的，重点是拼写错误)？

今天，我的团队构建的 ui 已经将部署和版本控制从他们所依赖的微服务中分离出来。没有专门的服务直接支持 UI。事实上，支持 UI 所需的任何服务经常被重用来支持直接的 API 集成或另一个 UI。想试试就试试吧，我建议去 [Authress](https://authress.io) 直接查看 UI 等交互。