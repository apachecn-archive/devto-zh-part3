# Java 中“i = i++”的行为

> 原文:[https://dev.to/renegadecoder94/the-behavior-of-i-我-在-爪哇-ch1](https://dev.to/renegadecoder94/the-behavior-of-i--i-in-java-ch1)

不久前，我在管理一个 Java 实验室，我的一个学生问我为什么他们的代码不工作。当我浏览他们的解决方案时，我注意到一行奇怪的文字写着`i = i++`。在那之前，我从未见过任何类似的代码，当然也从未尝试过。所以，我做了任何一个好老师都会做的事情，去谷歌上寻找更多的信息。

## [](#java-loops)Java 循环

作为写了一些 Java 学习材料的人，我认为自己至少精通这门语言。然而，随着我继续教书，我发现学生们总能想出创造性的方法来扩展语言。

在我最近教循环的尝试中，我无意中发现了一个学生解决方案，它有以下 while 循环语法:

```
int i = 0;
while (i < 10) {
  i = i++;
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

也许这段奇怪的代码是我的错。毕竟，我经常告诉我的学生，解决一个问题有很多方法。

为了帮助传达这一信息，我喜欢不时地改变我的语法。例如，对于我来说，每次使用不同的循环语法来分享循环问题的解决方案并不少见。有时我会使用 for 循环，而有时我会使用 while 循环。如果我感觉良好，我甚至可以展示一下 for each 循环。每隔一段时间，我甚至会抛出一些递归来动摇事情，但你永远不会发现我死于使用 do while 循环。

无论如何，当我增加变量时，这种心态也会表现出来。例如，我倾向于先教`i = i + 1`,因为它会让那些没有认识到等号实际上是赋值运算符的学生犯错误。当然，一旦我认为他们已经理解了这个概念，我通常会求助于像`i++`和`i += 1`这样的速记。

不幸的是，我对自我表达的追求有时会导致语法混乱，比如:

```
int i = 0;
while (i < 10) {
  // Do something
  i++;
} else {
  // Do something else
} 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

每次我看到这样的东西，我都觉得我离克服知识的[诅咒](https://therenegadecoder.com/blog/the-curse-of-knowledge/)又近了一步。输入:`i = i++`。

## [](#java-increment-operators)Java 增量运算符

正如我已经提到的，在 Java 中有很多增加变量的方法。下面的列表涵盖了相当多的例子——尽管有些很傻

```
i = i + 1;
i += 1;
i++;
++i;
i = i - -1;
i -= -1;
i = -(~i) 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

尽管有以上所有的选择，我从未想过尝试`i = i++`，然而它很有意义。毕竟，看起来我们增加了变量并存储了结果。老实说，当我在实验室里看到它时，我有点不知所措。

事实证明，`i = i++`并没有像预期的那样工作，这与赋值语句右侧如何求值有关。因为`i++`是一个后缀运算符，所以 I 会递增，但会返回它的旧值。因此，I 用旧值覆盖了它本身。

如果上面的解释不太好，试着看看下面的代码片段，它复制了这个行为:

```
int temp = i;
i++;
i = temp; 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

如果我们在一个循环中使用`i = i++`语法，我们将会有一个无限循环，而没有什么可以用来诊断 bug。谢天谢地，我在那里至少认识到了这个问题。我是否真正理解这个 bug 是另外一个问题，但是我确信我为那个学生节省了很多时间。现在，我希望与他人分享我的发现！

## [](#the-take-home)该带回家了

在这个系列的这一点上，我开始注意到一个趋势:

*   一个学生写了一些有趣的代码
*   出乎我的意料，它不起作用
*   我花了一些时间困惑
*   我写了一篇文章来讨论我的发现

无论是[与扫描仪 API](https://therenegadecoder.com/code/be-careful-with-scanner-methods-in-java/) 斗争，还是[发现玩石头剪子布的新方法](https://therenegadecoder.com/code/rock-paper-scissors-using-modular-arithmetic/)，我不得不说我从我的学生那里学到了很多乐趣。我迫不及待地想成为一名教授。

与此同时，我会继续记录我教书时的所有乐趣。如果你喜欢我的作品，[考虑订阅](https://therenegadecoder.com/members/)。如果你已经订阅了，你可以通过与你认识的人分享这篇文章来帮助传播。

无论如何，再次感谢你花时间支持我的工作。