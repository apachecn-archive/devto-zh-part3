# 测试的 5 个存在理由

> 原文：<https://dev.to/nmattia/the-5-raisons-dtre-of-testing-1kk6>

# 测试的 5 个存在理由

我描述了我认为测试很重要的五个原因:

*   确保您编写的代码能够正常工作。
*   确保你写的代码明天能工作。
*   确保你写的代码在其他地方也能工作。
*   尽早发现可用性问题。
*   展示你的功能应该如何工作，以及应该如何使用。

**重要的**:在
制作这个帖子的过程中，例子中使用的动物都没有受到伤害。

* * *

首先，让我们进入状态(或者[跳过](#ensure-that-the-code-youve-written-works)):

* * *

*故事时间*

你是可爱
事物著名网站`MyCuteThings.com`的后端工程师。一个星期三的早上
，你的老板找到你和汤米(你的前台助手)并宣布:

> 将有一个`"breed"`下拉列表列出两个猫品种:波斯猫和
> 暹罗猫。当用户在`"breed"`中选择一个品种时，该品种的
> 猫的图片将显示给用户。功能代号:《忍者》。
> 
> -你的老板

Tommy 将处理 HTML、CSS 和其他前端人员使用的东西。您的
工作是提供一个 API 端点，它将返回正确的
图片的字节。你找到一张非常可爱的波斯猫的图片，你把它保存为
`cat.png`。你给自己的暹罗猫拍了一张照片，并保存为
`CAT.png`。你决定在下面休息一下:

```
GET /cats?breed=<nameOfTheBreed> 
```

用法很简单*:*

 **   如果`nameOfTheBreed`是`persian`，那么你读取`cat.png`，返回结果字节和`200 OK`。
*   如果`nameOfTheBreed`是`siamese`，那么你读取`CAT.png`，返回结果字节和`200 OK`。
*   如果`nameOfTheBreed`是别的，你返回零字节和`200 OK`(公司政策 GTE-421-f，2003 年引入，禁止你使用`404` s)。

* * *

因为我们在和软件打交道，任何可能出错的东西都会出错。我们将更详细地讨论我上面列出的五个原因，并看看
测试如何帮助你控制损失。

## 确保你写的代码有效

这可能是编写测试最直接的原因。然而，尽管知道你刚刚写的东西有用是有价值的，但这可能是最不重要的原因。

> 测试代码工作是测试的存在理由！！！你怎么敢说
> 这不重要？？？
> 
> -来自内布拉斯加州的吉米

别误会，吉米，我没说这不重要:其他原因
只是*更*重要。大多数情况下，在编写代码之后，你最终会尝试这个功能
(打开网站，点击`Siamese`，敬畏地看着你的猫出现在
屏幕上)——这是你从测试中获得的最多信息。无论如何，你会直接发现类似“试图打开`cat.jpg`而不是
`cat.png`的错误。

当你开发一个
特性时，在编写代码的同时运行测试可以节省很多时间，因为你(通常)只需要运行一个命令来检查
你是否做对了。此外，通过编写接近您的规格的测试，它
充当了一个截止日期(一旦您的测试通过，您就完成了，您可以继续进行
别的事情)。此外，通过*首先*编写一个(失败的)测试，当任务是
修复一个 bug 时，你可以确保这个 bug 确实存在。这就是典型的
[TDD](https://en.wikipedia.org/wiki/Test-driven_development) 。

## 确保你写的代码在其他地方也能工作

* * *

*故事时间*

你写了你的特写，汤米写了他的部分。在你努力手工测试之后,“忍者”被合并到了主分支中。那天晚上你回到家
，当你准备开始看《T2 火线》第三季的时候(第二次，因为你第一次认为你不需要英语
字幕)你接到了 Jason 的愤怒电话，他是销售代表，在
工作到很晚，因为他正在向另一个时区的人演示产品。Jason
解释说他只能得到一张波斯猫的照片。即使他从下拉菜单中选择了
暹罗选项。调试过程是这样的:

> 你:你用的是什么操作系统？
> 
> 杰森:什么是敬畏？

这时你意识到 Jason 正在他的 Windows
机器上运行你的代码。不幸的是，它无法区分
`cat.png`和`CAT.png`。你叹了口气，放下遥控器，回到
画板。

* * *

测试套件在运行于几个
环境中的项目中尤为重要。你写了能在你的机器上运行的代码？很好，但是很有可能
你忘记了更新一些配置，你刚刚
编写的组件一旦被部署到其他地方就会崩溃，因为你依赖于
特定于你的(高度调整的，非常特别的)系统的东西。

如果您有一个单元测试，您将确保它也能在 CI 机器上工作。
如果您对它进行了集成测试，您将确保它能在 CI
机器上以及部署所经过的各种集群上运行。

## 确保你写的代码明天就能工作

*故事时间*

一个月过去了，你不仅因为第三季比第二季好得多而松了一口气，而且还忘记了关于“忍者”的所有事情。下午 5 点，你
坐在办公桌前，越来越频繁地盯着墙上的时钟
。你的老板从他的办公室出来，额头冒汗，脸颊因愤怒而泛红。他扫视了一下工程室，目光锁定了你。他
开始朝你的方向走去。你心里想:“这不可能是好事。”。

20 分钟后，有点高兴的是你的周六晚上腾出了
(你的老板和他的妻子应该过来吃晚饭)，你正在
查看 git 日志，心中只有一个目标:试图找出谁应该为
从存储库中删除猫图片负责，从而破坏了功能
“忍者”。

```
commit 45d2fcd272a273c57033a493ca3df47a67f9bf01
Author: Jenny Marshalls <jen@mycutethings.com>
Date:   Tue Aug 21 01:15:33 2018 +0300

    Remove unused kitten pictures 
```

你开始走向她的办公桌，想出尽可能多的不合理的家长式论点来为你的特征缺乏测试辩护。

假设你写了一个(客观地)完美工作的特性，尽管没有任何相关的测试。然后明天我会过来，调整你的代码来添加一个新的特性，无意中破坏了你的。然后你怪我
破坏了我的代码。不要怪我。

你不能指望其他人在
调整你的代码时预见到所有的暗示，因为很可能连*你*都不能。因此，你的
有责任添加一个测试来说明你的特性
今天和明天的正确行为。

**旁注:**不言而喻，注释掉测试并不是将我的新特性硬塞到你现有代码中的
正确方式，但是那种
东西有望在评审期间被发现。

## 尽早发现可用性问题

当你决定为你的新特性编写一个测试时，你可能会意识到你的界面很难使用。这确实是你可以执行的最简单的可用性
检查，也就是吃你自己的狗粮。

在这些问题被合并之前，在其他代码依赖于
之前发现它们，意味着其他人会更喜欢使用你的代码(和
,从而使人们更倾向于尝试、理解和重用你的
特性——而不是复制它——这将简化
新人的学习过程。

## 展示您的功能应该如何工作以及应该如何使用

It's been three weeks since you blew your chance at a promotion. In order to
avoid similar situations in the future, you've added tests. Feature "ninja" has
been working seamlessly ever since.

你的搭档 Tommy 告诉你，Jenny 需要帮助使用你写的后端功能
。珍妮的事情变得很奇怪，你仍然对
责怪她丢失照片和你对
情况的反应感到内疚。从那以后，你尽力避免冲突。

告诉她去看测试，你告诉汤米。

* * *

阅读测试是一个很好的方式来弄清楚事情应该如何运作。它显示了输入应该是什么样子，以及输出应该是什么样子。
它显示了您的功能还能做什么。

如果你的特性没有相关的例子或测试，用户不得不依靠
源代码和可能过期的文档来弄清楚应该如何使用
(以及是否应该*而不是*)。测试要好得多。

* * *

## 结论

底线是，有一个工作的
代码库有不止一个方面:它应该是未来的证明，在不同的环境中运行，是
可用的，并且是自我描述的。测试是实现这一点的好方法，当
你把它们和[良好的流程](https://nmattia.com/posts/2019-01-08-hunt-bugs-down-before-they-are-merged.html)结合起来，你就会成为世界之王。或者至少是一个快乐高效的程序员，一个快乐团队的一部分。*