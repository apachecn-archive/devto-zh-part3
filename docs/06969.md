# XGBoost:用监督学习预测预期寿命

> 原文:[https://dev . to/striking loo/xgboost-predicting-life-expected-expected-expected-learning-19b 6](https://dev.to/strikingloo/xgboost-predicting-life-expectancy-with-supervised-learning-19b6)

今天，我们将使用 XGBoost Boosted 树对官方人类发展指数数据集进行回归。谁说监督学习就是分类的？

## [](#xgboost-what-is-it)XGBoost:什么事？

XGBoost 是一个 Python 框架，它允许我们利用多核并行来训练增强树。它在 R 中也是可用的，尽管我们不会在这里讨论它。

### [](#the-task-regression)任务:回归

提升树是用于回归的机器学习模型。也就是说，给定一组输入和数字标签，他们将估计在给定相应输入的情况下输出标签的函数。

与分类不同，我们对标签感兴趣的是连续的值，而不是一组离散的类。

例如，我们可能希望根据一个人的体重和年龄来预测他的身高，而不是给他们贴上男性、女性或其他的标签。

对于每个决策树，我们将从根开始，根据决策的结果移动到左边或右边的子树。最后，我们将返回到达的叶子的值。

### [](#xgboosts-model-what-are-gradient-boosted-trees)XGBoost 的模型:什么是梯度增强树？

提升树类似于随机森林:它们是决策树的融合。然而，在我们预测的空间中，每片叶子将返回一个数字(或向量)。

对于分类，我们通常会返回落在每片叶子上的训练集元素的类的平均值。在回归中，我们通常会返回标签的平均值。

然而，在每个非叶节点上，树将做出决定:某个特征值和阈值之间的数字比较。

到目前为止，这只是一个退化森林。区别在哪里？

### [](#boosted-trees-vs-random-forest-the-difference)助推树 vs 随机森林:区别

与随机森林不同，在训练增强树时，我们每次添加新树时都会更改标签。

对于每一棵新树，我们通过减去先前树的预测之和，再乘以一定的学习速率来更新标签。这样，每棵树都将有效地学习纠正先前树的错误。

因此，在预测阶段，我们将简单地返回所有树的预测总和，乘以学习率。

这也意味着，与随机森林或袋装树木不同，如果我们任意增加树木的数量，这个模型**将**过度适应。然而，我们将学习如何解释这一点。

要了解更多关于助推树的知识，我强烈推荐你阅读 XGBoost 的[官方文档。他们教了我很多，并且用更好的图片更好地解释了基础知识。](https://xgboost.readthedocs.io/en/latest/tutorials/model.html)

如果你想更深入地研究这个模型，这本书[介绍统计学习](https://www.bookdepository.com/book/9781461471370/?a_aid=strikingloo&chan=ws)是最终让我明白这些概念的那本书，我怎么推荐它都不为过。

## [](#using-xgboost-with-python)用 Python 使用 XGBoost

XGBoost 的 API 非常简单，但是我们还将了解一些它的超参数。然而，首先我将向你展示今天的任务。

### [](#todays-dataset-hdi-public-data)今日数据集:HDI 公开数据

人类发展指数数据集包含许多关于大多数国家几十年来发展水平的信息，涉及许多指标和领域。

对于今天的文章，我决定只看最近一年的数据:2017 年。这只是为了让事情保持最新。

我还必须执行一些数据整形和清理，以使原始数据集更易于管理，尤其是更易于使用。

本文的 GitHub 资源库在这里可以找到[，我鼓励您跟随 Jupyter 笔记本。然而，我会一直在这里添加最相关的片段。](https://github.com/StrikingLoo/XGboost_HDI_analysis)

### [](#preprocessing-the-data-with-pandas)用熊猫预处理数据

首先，我们将数据集读入内存。因为它包含一整列的年份，以及一行的国家和指标，所以管理起来相当麻烦。

我们将把它重新塑造成如下的东西:

```
{country: {metric1: value1, metric2: value2, etc.}
 for country in countries } 
```

<svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-on"><title>Enter fullscreen mode</title></svg> <svg width="20px" height="20px" viewBox="0 0 24 24" class="highlight-action crayons-icon highlight-action--fullscreen-off"><title>Exit fullscreen mode</title></svg>

这样我们就可以把它输入到 XGBoost 模型中。此外，由于所有这些指标都是数字的，因此在训练之前不再需要预处理。