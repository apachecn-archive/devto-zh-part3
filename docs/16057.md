# 快速 tmux 会话

> 原文:[https://dev.to/dlains/quick-tmux-sessions-ko3](https://dev.to/dlains/quick-tmux-sessions-ko3)

我使用 [*tmux*](https://github.com/tmux/tmux) 已经有几年了。对于我参与的每个项目，我都会创建一个 *tmux* 脚本来启动该项目的开发环境。

在很长一段时间里，我创建的 tmux 脚本只是打开 windows 来运行项目需要的各种服务器，除此之外别无其他。对于一个 Rails 项目，它通常是一个用于 [Rails](https://rubyonrails.org/) 服务器的窗口，另一个用于 [Redis](https://redis.io/) ，一个用于 [Sidekiq](https://sidekiq.org/) ，有时一个用于 [Mailcatcher](https://mailcatcher.me/) 。

只需运行一个脚本就可以让项目的整个环境启动并运行起来，这非常方便，但在那之后，我通常不会与 *tmux* 会话进行太多的交互。只是不时地检查服务器输出。其余时间我都在 [Atom](https://atom.io/) 或者浏览器里。

当我开始使用 Neovim 时，我开始花更多的时间在 tmux 上。我更新了我的项目特有的 *tmux* 脚本，在现有的服务器窗口中加入了一个*编辑器*窗口。

我已经习惯了这种工作方式，以至于每当我需要在一个完整的项目之外做任何类型的快速编辑工作时，我会发现自己只用一个*编辑器*窗口和一个*控制台*窗口来创建迷你 *tmux* 会话。建立一个简单的双窗口会话很容易，但是为什么要一遍又一遍地重复同样的过程呢？

下面是一个简短的 shell 脚本，它将创建一个简单的双窗口 *tmux* 会话，给出一个目录路径。

```
NAME=`basename $1`
cd $1
tmux new -s $NAME -n editor -d
tmux send-keys -t $NAME $EDITOR C-m
tmux new-window -n console -t $NAME
tmux select-window -t $NAME:1
tmux attach -t $NAME 
```

这只是脚本的主要部分，完整的脚本被注释并检查输入参数。这里可以看到实际的脚本[。](https://gist.github.com/dlains/b28690d9975bec72c811b1824bfe3ee3)

该脚本需要一个参数，一个目录的路径。它将路径中的最终目录名提取到`NAME`变量中。它在整个脚本中使用这个名称作为 *tmux* 会话名称。

提取名称后，脚本将目录更改为提供的路径。之后它创建一个新的 *tmux* 会话，并将第一个窗口命名为*编辑器*。一旦创建了会话，脚本就向 *tmux* 会话发送一个命令，以启动与`EDITOR`环境变量相关联的编辑器。在我的系统上设置为`nvim`，但是它可以是任何可以从命令行启动的编辑器。但是要注意，如果你启动一个基于 GUI 的编辑器，它会在终端之外打开，这个 *tmux* 编辑器窗口没有多大用处。

现在第一个窗口已经创建，命名为，编辑器正在运行，脚本创建第二个窗口。它简单地将其命名为`console`。我发现有一个专用的控制台窗口对使用 Git、检查文件或其他任务很有帮助。其中一些任务可以在 Neovim 中完成，但我喜欢为一些任务提供一个专用的控制台窗口。

一旦`console`窗口被创建，脚本告诉 *tmux* 选择`editor`窗口，然后连接到会话。

这就是了。一个简单的脚本，你就可以在几秒钟内运行一个迷你的 tmux T2 会话。我将这个脚本命名为`qs`，用于快速会话，并将它放在我的路径中。现在每当我需要做一点工作时，例如在我的*点文件*项目中，我可以简单地运行:

```
qs ~/dotfiles 
```

如果你想自己使用该脚本，只需将代码复制到一个文件中，确保该文件可以用`chmod +x [file]`执行，并确保你的`EDITOR`环境变量被设置为合适的值，或者将脚本中的`$EDITOR`引用更改为你喜欢的值。