# 听听该死的警告。

> 原文：<https://dev.to/dannyaziz97/listen-to-the-god-damn-warnings-3ld1>

(大部分)开发者都不是傻逼，他们知道自己在做什么。所以，当你(我)在使用一个开源项目时，出现了一个警告，听听它。

几周前，我试图将 Elasticsearch 整合到我的 Django 项目中。在我的本地机器上设置很好，因为我用的是`django-elasticsearch-dsl`，它会帮你完成所有的繁重工作。

部署到我的服务器上是另一回事...

我有 800，000 个对象，我想与 Django 和 Elasticsearch 保持同步，在本地这很好，但在我的 AWS t3.medium 服务器上就不行了。

首先，服务器在尝试同步时会变得没有响应——太多的 RAM 使用，所以我使用了`queryset_pagination`参数来为我的同步对象分页(不是一次同步所有对象，而是成批同步它们)。

🎉正在同步！

30 分钟过去了，是时候检查一下了，你猜怎么着？只有大约 40 万个物体。只有一半的对象同步！我的本地机器上没有发生这种情况，它有一个相同数据库的副本，怎么会发生这种情况呢？

接下来，我认为 Elasticsearch 占用了太多的内存，所以我把 Django 和 Elasticsearch 分开放在不同的服务器上。

⏳再次同步的时间到了。

500，000 -额外的 100，000 个对象，但不是我需要的 800，000 个。这一次，我花了更多的时间翻遍文档、GitHub 问题和源代码，试图理解一切是如何工作的。

我尝试了不同人的叉子，但即使这样也无济于事。

然后我看到了...

`Pagination may yield inconsistent results with an unordered object_list`

这是一个警告信息，在我同步的时候一直显示，但是因为某些原因我忽略了它。

简而言之，`queryset_pagination`参数帮助我节省了 RAM(并且需要在服务器上同步),这就是问题所在。`django-elasticsearch-dsl`将所有的对象放在一起进行同步*但是*没有顺序，所以有些对象被同步了不止一次，有些被忽略了。

我所要做的就是派生出回购协议并添加一行代码:`.order_by("id")`

最后，世界又变得美好了🎈