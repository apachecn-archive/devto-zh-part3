# 神鹰发布——一个开源的渐进式 Web 应用程序前端

> 原文:[https://dev.to/deity_pwa/deity-falcon-launch-安-开源-渐进-网络-应用-前端-4pb1](https://dev.to/deity_pwa/deity-falcon-launch---an-open-source-progressive-web-app-front-end-4pb1)

*发射日期:2018 年 10 月*

*技术栈:Node.js、React.js、Webpack 和 Babel、GraphQL(通过 Apollo GraphQL — ApolloClient 和 ApolloServer)、Koa (web-server)、Jest(测试库)*

上周，2018 年 10 月，我们发布了开源版本:神鹰，这是我们旅程中的一个重要里程碑。神隼是一套工具，一个库，使开发人员能够建立任何类型的网站或网络应用程序的进步网络应用程序:博客，网店或任何其他用例。

我们开始将神作为无头产品的概念验证，建立一个由 NodeJS 和 ReactJS 组成的前端，以及一个基于 Magento 2、Wordpress 和 Algolia 的后端。虽然我们的主要目标是共享我们的产品开源，但我们决定将该产品专门发布给我们的合作伙伴，这样我们可以以可控的方式看到发生了什么，并收集关于应该改变什么的反馈。去年，这个版本已经在几个项目中使用。从完整的商店实现到比较网站、博客网站，甚至是模块化的无头收银台。

基于这些项目，我们从我们的合作伙伴和我们自己的经验中收集反馈，并确定我们有一些由我们的架构引起的问题。神核是一个整体，所有东西都在一个包中，很难用新的定制功能来扩展解决方案。我们也知道时间不多了，我们必须尽快开源，所以我们必须做出一个重要的决定。下一步做什么？开发更多功能，增加功能，这样我们就可以展示完整的功能列表——但是我们知道架构给我们带来了问题，无论如何都应该改变？或者退一步，重构整个架构，使其灵活并面向服务，但却没有一个闪亮的特性列表？

对我们来说，第一个真正的用户是开发者。因此，开发人员体验、代码质量、灵活性和可扩展性比向最终用户展示一系列闪亮功能的营销价值更重要。我们代表质量——所以我们决定后退一步，这样我们就可以通过完全改变建筑来前进两步:于是神鹰诞生了。

**那么神鹰是什么？**

 **神鹰是一个工具和库，用于构建渐进式网络应用程序，不仅仅局限于电子商务，而是你可能需要的任何类型的 PWA:网店、博客、作品集、比较平台——真的是你能想象到的任何东西。

我们开始建立一个我们称之为 F.I.R.E .的原则:

- **灵活**:因为用神鹰的人应该可以造出你想要的任何一种 PWA。

- **可集成**:因为使用神鹰的人应该有可能用它集成任何一种数据源。

- **可靠**:因为使用神鹰的人应该不用担心高流量和可扩展性

- **可扩展**:因为使用神鹰的人应该可以根据需要扩展它的自定义特性。

牢记这些核心原则，我们开始将我们的代码库分割成小的自包含包，这些包提供了一组预定义的特性，并且可以以任何方式重用。接下来，我们决定拆分应用程序架构本身:创建 Falcon 服务器和 Falcon 客户端。

[![Falcon Architecture](../Images/cc75180829daa19a66e6694bda82ce09.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--RIPEGF6U--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/ojvp188zljy5ietl0qib.png)

**猎鹰服务器**

 **Falcon Server 充当 API 服务器，将整个平台粘合在一起。它充当你在浏览器中看到的前端和提供数据的后端服务之间的中间件层，如 Magento、Wordpress、Algolia、Elastic Search 等。

它建立在 ApolloServer 之上，为我们提供了 ApolloServer 提供的所有功能，例如可以进行模式拼接。模式拼接允许我们从多个 GraphQL 源创建一个单一的 GraphQL 模式。因为我们的扩展返回了一个部分模式，所以在构建过程中它们将被合并成一个单一的模式。更具体地说，我们使用 Apollo DataSource REST 来映射我们的远程 REST API——例如 Magento 和 Wordpress 到我们的模式。因此，它让扩展可以自由决定如何交付它的模式部分——要么将每个查询映射到远程 REST API 端点，要么直接交付远程 GraphQL 模式

Falcon Server 还有一个内置的扩展框架，它为扩展提供了一个抽象层，使得任何人都可以轻松地构建和连接扩展。

这些扩展可以扩展 GraphQL 模式，提供解析器并对 GraphQL 结构进行任何类型的修改，从而给开发人员连接任何类型数据源的充分自由。此外，它为 REST 调用提供了一个抽象薄层，这将简化在扩展代码中使用外部 REST 端点。神隼的用户不会被我们为他们选择的数据源或结构所束缚:神隼是真正的平台不可知的。

对于基本的商店特性，我们提供了 Falcon 商店扩展，它提供了 GraphQL 数据类型。Falcon 商店扩展也是后端不可知的——它可以连接到任何能够提供商店功能的 API。默认情况下，我们将其与 Magento 2 API 连接，为此我们创建了一个单独的包——允许猎鹰与 Magento 2 交互。

**猎鹰客户端**

 **神鹰客户端是前端服务，负责处理前端相关的任务，如连接后端，HTML 渲染等。对于开发模式，它集成了最新版本的 Webpack。由于前端完全基于 JavaScript，谷歌搜索引擎优化的价值可能会有风险。为了保护这一价值，并确保任何类型的机器人可以抓取用神鹰建立的网站，我们已经集成了服务器端渲染。这个特性无缝地工作，不需要修改任何东西:它只在应用程序中工作。测试它的一个简单方法是关闭 DevTools 中的 JavaScript，您仍然会看到完整的内容出现。

此外，我们为您的内容内置了动态路由。由于它相当复杂，我们将很快写另一个关于它的博客，但基本上主要的优势是你可以通过各种服务的神鹰提供内容-例如 Magento 的产品页面和 WordPress 的博客帖子-在那些源中配置的相同 URL 下。然后，神鹰负责从正确的来源获取所请求的内容。这样你就可以将商店和博客的前端整合到 DEITY Falcon 中，但仍然可以像现在一样管理 Magento 和 WordPress 后端的内容。一件好事是:你不必担心你的应用中有太多的后端类型，你的捆绑包大小不会急剧增加——我们已经为你解决了这个问题，代码分割也由 Falcon 处理。

作为一项额外的功能，为了帮助开发人员，我们在服务器端渲染中添加了性能测量，这样您就可以看到 GraphQL 查询执行了多长时间，从而知道服务器上的某些进程需要多长时间。为了让您能够以统一的方式管理您的状态，无论数据是在浏览器本地还是从服务器远程加载，我们都将状态管理更改为 Apollo 链接状态。当然，我们内置了渐进式 Web 应用程序功能，如基本离线模式、添加到主屏幕、服务人员、清单等。

但是还有更多！

 **在多年建造商店的过程中，我们发现许多网店至少在视觉部分是相似的。尤其是开发的初始阶段，如概念验证和从 PoC 到第一个 MVP，大多数商店的视觉结构都非常相似。

为了帮助您完成开发的初始阶段，我们创建了一个 UI 组件库，具有内置的主题功能，允许您快速构建商店原型。一旦你使用我们的用户界面库建立了一个商店，你就可以改变所有组件的全局定义的主题，这使你有可能立即完全改变商店的外观和感觉。此时的主题包括配色方案、响应、间距、字体、布局(带有 css 网格属性)等等。有了这些功能，你甚至可以改变商店的整个布局，而不用接触任何 HTML 结构。

最重要的是，UI 库是基于 JavaScript 中的 CSS 的，它不使用任何常规的 CSS。我们这样做是为了实现更高级别的可定制性和性能。使用 JS 中的 CSS，您可以:

真正限定范围的样式—您只为特定的组件定义样式，因此您不必担心一个组件的样式会影响 HTML 文档的其他区域。这个库可以用来构建任何类型的 UI——商店、博客、网站、web 应用——任何可以用 JavaScript 构建的东西。

为了使它更容易，我们包含了一个可视化主题编辑器作为 React 组件。一旦它被嵌入到使用 Falcon UI 的应用程序中，您就可以以一种超级快速和简单的方式调整您的 UI，同时立即实时地看到变化。
开箱即用的卓越性能，无需依赖任何底层服务来提高性能。这是因为:
只加载当前对象渲染所需的 CSS
CSS 选择器非常简单，浏览器不必关心复杂 CSS 选择器的解析或匹配。
关键的 CSS 总是在 HTML 中加载——在页面加载过程中不会出现难看的闪烁，因为你会得到一个完整的 HTML，其中包含渲染页面所需的 CSS。不需要 CSS 前置或后置处理器。这使得构建过程更简单，从而更快。

**那么如何开始使用神鹰呢？**

 **如果您和我们一样对此次发布感到兴奋，并希望立即开始使用神鹰，请访问我们的 Github:[https://github.com/deity-io/falcon](https://github.com/deity-io/falcon)或者您可以通过以下方式使用我们的 CLI 工具生成一个示例项目

*   npx create-falcon-app my-app

这将生成一个连接到我们的演示后端服务器的基础应用程序，这样您就可以查看神隼和所有工具是如何协同工作的。

我们为我们所取得的成就感到非常自豪，并且很高兴几个月前我们决定改变架构，而不仅仅是增加更多的功能。然而，这个项目仍在(大量)进行中，我们正在努力工作，以尽快推出一个更好的版本和更多的组件。你愿意帮助我们完成永远改变网络的使命吗？请加入我们，成为合作伙伴或开始贡献！

请联系我们:[contribute @ diving . io](mailto:contribute@deity.io)，我们很高兴与您交谈！

这篇博客是一个全新系列的第一篇。在我们接下来的博客中，我们将讨论路线图，并展示您对我们的期望。接下来，我们将向您介绍新的功能和工具，我们将深入探讨为什么我们认为服务隔离架构是电子商务的未来。

敬请期待！**********