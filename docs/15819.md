# 我对安全一窍不通(或者至少我不知道)

> 原文：<https://dev.to/rionmonster/i-dont-know-crap-about-security-or-at-least-i-didnt-3g0>

*这篇文章最初发表在[我的博客](http://rion.io)上。*

最近，我参与了一个项目，该项目要求在大规模审计之前对应用程序进行严格的锁定(可能会造成数百万美元的损失)。所有的流行语都在那里:“笔测试”、“红队”和“一切都取决于此”。这不会是一个简单的一键修复。这需要我摘几颗山露水，穿一身黑，假装成一个黑客:

[![the-virus-uh-finds-a-way](img/c0dc7d335546426a5e551047ad7940a4.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--dlJ6L6MY--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/http://rion.io/conteimg/2018/10/goldbloom.gif)

不用说——我害怕承担这个责任，因为正如这篇文章的标题所表明的:我对安全一窍不通(或者至少，我不知道)。

## 你不知道你不知道的事

我想说，我可能和大多数开发人员处于同一条船上，在构建应用程序时，安全性很少是首先想到的事情(如果我甚至想到过它的话)。通常，我会告诉自己如下的事情:

*   “这是一个本地应用程序，所以我不需要担心有人会入侵它。”
*   “我在{insert-framework-here}中写这篇文章，所以我确信他们已经为我处理好了这件事。”
*   “我以后再做……”

问题是，通常所有这些都有一个共同点:你并没有真正做任何事情来确保你的应用程序受到保护。你可能会依赖你最喜欢的框架，或者以任何理由为推迟事情找借口——但是**你的应用程序的安全性应该像你的代码一样对待，在这点上，你应该实际测试它。**

你的申请可能没问题。您可能已经遵循了所有的最佳实践，并将安全性视为应用程序中的一等公民，但您不知道自己不知道什么，除非您尝试破坏东西，否则您不会知道。

## 打破事物

在我的特殊情况下，我试图测试的应用程序是一个已经存在了几年的旧应用程序，所以它没有使用最新和最棒的技术和框架。如果您已经做了几年的开发人员，我相信您可以准确地想象我所说的应用程序的类型。这里有一点 WCF，那里有一点 Web API，也许一些 ASPX 页面被放在一个 SPA 上面，就像我说的——你可能知道我在说什么。

我和一个不可思议的团队一起工作:令人敬畏、充满激情的开发人员每天都让我感到愚蠢，但我知道我们并不完美。聪明人也会犯错，这只是游戏的一部分。与安全相关的问题通常不是实际的 bug，而是没有给予足够考虑(或时间)的事情。

正因为如此，我们不得不烧掉一些东西来建造它们。**我们需要抓起办公室里最大的球棒，反复敲打我们的应用程序，这样我们就能看到剩下的一堆瓦砾中还剩下什么**:

[![](img/ff36c6149781b1e17ad9304de346ef1d.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--s5bA30vT--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/http://rion.io/conteimg/2018/11/damn-it-feels-good-to-be-a-gangsta.gif)

一旦你看到你的应用程序的哪些部分容易崩溃，你就知道从哪里开始尝试改进。虽然有很多方法可以做到这一点，但自动化将成为我们的朋友。不要试图发明你自己的安全测试平台，你只会让事情变得更糟。有许多公开可用的工具(以及一些提供免费试用的商业工具)可以完成所有繁重的工作，例如:

*   **[打嗝](https://portswigger.net/burp)** -渗透测试领域的黄金标准，打嗝是全球安全专业人士使用的真实交易。它可以作为代理运行您的流量并实时扫描它，快速识别潜在的安全问题，并为您提供对您希望在应用程序中尝试和利用的内容的细粒度控制。它可能不是有史以来最漂亮的工具，但它非常强大，可扩展，值得探索。
*   一个伟大的静态分析工具，集成到 Visual Studio 中，可以帮助识别坏模式、死代码等等。无论是在安全领域内还是在安全领域外，这都是一个非常有价值的工具。
*   **[Puma Scan](http://www.pumascan.com)**——一个 Rolsyn 驱动的分析工具，与 Visual Studio 集成为一个扩展，可以帮助轻松识别代码中的安全漏洞，如 SQL 注入、XSS 等(并帮助您修复)。它是免费的，但是它也有一个商业版本，你可以把它作为你构建过程的一部分来帮助*保持*你的应用程序的安全。
*   **[ZAP](https://github.com/zaproxy/zaproxy)**——OWASP 的另一个很棒的基于社区的工具，它非常类似于打嗝，如果你能掌握打嗝(或者不需要它附带的所有功能)，它是一个很好的选择。
*   **[设防](https://www.microfocus.com/en-us/products/static-code-analysis-sast/overview)**——这是一个神奇的工具，我刚好有机会接触到。它非常强大，可以根据您的需要，使用高度可配置的合规级别自动抓取您的站点/应用程序(甚至 spa)。

拥有所有这些美妙的工具是很棒的，但也可能令人不知所措。您可能需要考虑您自己对应用程序的关注点，否则，您可以考虑对应用程序进行广泛的扫描，然后再深入一些(即广度优先，深度优先)。

## 你需要一个计划

您需要考虑如何开始保护您的应用程序，确定对您(和您的组织)来说什么是重要的，然后对出现的关键项目进行分类。

[![](img/387560434c0ebb812a8b0a96e01deec1.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--bEuevZb5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/http://rion.io/conteimg/2018/12/hannibal-gonna-hannibal.gif)

每个应用程序都不同。没有灵丹妙药，一键扫描就能神奇地找到应用程序的所有问题(尽管一些商业级工具非常接近)。我将提供一个工作流的例子，我用它来帮助把一个漏洞百出的应用程序变成一个可以通过高级渗透测试的东西:

*   设定期望 -这个过程非常耗时。有些扫描可能需要几天才能运行，有些可能会失败，机器可能会死机，环境可能会遭到破坏。如果你想让这一过程物有所值，你需要投入一些认真的时间，并且你需要很好地了解你试图改进的内容(例如，消除所有关键漏洞，消除任何 XSS 漏洞，通过 HIPAA 合规性测试等)。)
*   **创建工作流程** -在某些情况下，自动扫描可能还不够。如果你有一个非常先进的水疗中心，一些爬虫可能会放弃，所以你必须变得聪明。考虑设置一个代理，比如 Burp，来捕获一些共享测试环境的所有流量。这将给你*现实世界*的请求，以馈入这些工具，使他们可以更好地访问你的应用程序，并试图打破它。
*   **建立一个测试环境** -通常渗透测试会*毁掉*一个开发环境和任何相关的数据库，所以如果你能创建一个“一次性”的地方来执行这些测试，那么你的生活会变得容易得多。像 Docker 这样的工具可以帮助您做到这一点，因此每次您需要执行扫描时，您可以在一个容器中水合一个数据库，将您的渗透测试工具指向它，然后在您完成后将它吹走。
*   **定义基线** -考虑对你的应用程序进行全面的漏洞扫描。把设置调到最高，让它运行。这可能需要几个小时、几天或者超过一周的时间，但是它会帮助你了解你在安全之神眼中的位置以及你需要做什么。
*   **关注严重性** -前面提到的大多数工具会为您遇到的任何漏洞分配严重性级别，因此相应地权衡这些是很重要的。几个关键级别的漏洞可能会胜过数百个而不是数千个无关紧要的漏洞，所以我知道看到您的数字显著下降可能会“感觉良好”，如果您没有解决主要问题，您可能会想首先考虑您为什么要这样做。
*   **减轻、清洗、重复**——在你确定了一些令人担忧的问题后，开始对它们进行分类。许多工具会提供严重性级别，这是一个很好的指南。一旦对这些问题进行了修复，重复该过程并重新扫描，以确保工具不再发现漏洞。

经过几次迭代后，您应该会看到应用程序中的漏洞数量下降了。重大问题可能需要对代码、流程等进行一些严肃的工程设计和重构，但是当一些超级恶棍选择攻击您的系统并将其放在头条新闻中时，这是非常值得的。

真正的挑战是保持安全。

## 建筑习惯

假设您已经花费了数百个小时来冒应用程序存在安全漏洞的风险。像 XSS 攻击、SQL 注入和 CSRF 这样的事情已经成为过去...或者至少，它们*是你最后一次扫描你的系统时的*。

[![](img/8dbdb1c1233948929e06791f8165fe4b.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--xMdnkcSd--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/http://rion.io/conteimg/2019/01/habits.gif)

在一个持续部署/集成的世界中，维护安全标准和代码质量是一项挑战。大型团队、极小的迭代周期和高压力的最后期限很容易导致为了发布下一个版本而将安全性抛在一边。这就是为什么培养良好的习惯如此重要，作为一个团队，利用工具，可以帮助确保您保持生产力和保护。

考虑帮助这些工作的一些事情包括:

*   **利用静态分析工具** -现在有很多工具，包括我之前提到的 Puma Scan，它可以与您的 IDE 集成，并提供开发和构建时的错误和警告，帮助您和您的团队在编写漏洞之前就阻止它们。
*   **构建管道门** -几乎每一个有价值的构建管道都有支持(或者内置或者通过扩展或插件提供)来禁止代码提交，如果它导致一个不完整的构建，或者在安全的背景下，任何你的团队已经决定的漏洞都不能被允许进入生产。
*   **自动化和容器化** -使这一过程自动化、脚本化等。如果你做敏捷，考虑在 sprint 的开始做一些事情，通过共享的测试环境收集代理的数据，在 sprint 结束时，对所有的流量进行扫描，看看会出现什么(以确保不会引入新的漏洞)
*   **分享知识** -考虑举行技术讲座，讨论如何应对特定类型的漏洞，如何识别漏洞，漏洞的危险是什么，以便您的开发人员能够更好地了解情况，并知道他们应该如何(以及为什么)避免漏洞。

安全是一个非常广泛的话题，类似于架构，因为你不能试图一次解决所有的问题。专注于培养良好的习惯和解决出现的重要问题*，你会发现你的应用程序的安全性将变得更少的分类和更多的维护，这是一个很好的位置。在把这些部分放在适当的位置后，你会知道更多你知道的(和你不知道的)，这应该有助于放松你的产品、你的公司和你的工程团队的集体思想。*

 *所以，我把这个留给你——你不需要成为一个安全专家来开始关心安全。如果你一直在逃避安全，不要这样做；开始一步步把拼图拼起来。作为一名经验丰富的工程师，我可以诚实地说，我一头扎进了这个池子，并活着讲述了这个故事(并写了这篇文章)，所以我毫不怀疑你也可以。不要让“对安全一无所知”成为你不关心安全的最大原因。在这个领域，少量的努力就能产生巨大的回报，你的产品、你的公司和你的整个工程团队都会因此变得更好。*