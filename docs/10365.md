# 初创企业中的代码审查:以思考的速度平衡完美主义和理智

> 原文:[https://dev . to/pcloudy/code-review-in-a-startup-balancing-perfection ism-and-sanity at-the-speed-of-think-2635](https://dev.to/pcloudy/code-review-in-a-startup-balancing-perfectionism-and-sanity-at-the-speed-of-thought-2635)

[![mobile app testing](../Images/819af0139e8ec92751dcc81539762b1d.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--CC67ZwMI--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/69log32onhi6758eeru6.png)

在这里，我为您带来了 DevOps 系列的第五篇博客，展示了我们在#scalingup 中的学习。阅读我们以前的博客，了解我们在发展过程中的不同时期使用的一系列策略，以在我们的 DevOps 之旅中实现成功的时钟。

适当的优化代码审查是许多创业公司所忽略的。有些人选择简单的方法并忽略它，而其他人花费数年时间讨论最佳实践、惯例和风格，却从未提交代码。这两个都是稍微夸张的失败例子，但是我确信如果你曾经试图回答关于代码评审的所有重要问题“你的团队到底应该做多少代码评审？”

对于完美主义者来说，答案是代码应该总是被审查，你应该总是重构代码并在你看到范围的地方改进它。我在一些公司工作过，那里的人们过去花在审查代码上的时间几乎和他们写代码的时间一样多。有一些实践，比如结对编程，其结果之一就是最大化代码审查。所以这不完全是一个错误的思考方向。然而问题是，当你在时间有限的环境中工作时，比如一家初创公司，你就没有时间在合理的时间之外继续修改和改进代码。我发现令人惊讶的是，许多人完全避免代码评审，因为时间限制。我甚至不需要提及这有多危险，这种行为有多危险。然而，似乎许多人正是这样做的。

在这篇博文中，我将尝试阐明我们在决定多少才算够时的经历。我们也像其他创业公司一样，有一个时间有限的环境，一些(谢天谢地只有少数)客户希望昨天就完成所有功能。因此，作为一种文化，我们也努力确保更快地完成所有事情。开发更快，[测试更快，](https://www.pcloudy.com)，部署到各种环境更快。但是我们不会忽视代码审查。我们确保我们做代码审查。我们有一些原则，我们遵循这些原则来确保代码审查总是发生，既不太少也不太多。他们在这里。我们所看到的是，如果你遵循所有这些步骤，那么你有一个理智的代码审查过程，你可以保证上帝代码稳定地流入你的仓库。这些要点的重要性没有特定的顺序。

你应该做代码审查:第一个原则不是开玩笑的蹩脚尝试。这个想法是，无论发生什么情况，都应该进行代码审查。没有这个原则的遵循，列表中的其他原则都会失效。我们使用 git-flow 作为开发 git 的方法之一。这个系统的优点之一是内置了代码审查。除非代码被指定的审查者批准，否则代码不会进入下一个级别，无论是测试还是生产。批准者和最初的开发者一样对一段代码负责。这样，评审者就可以花更多的时间进行评审，而原始编码者也可以提前评审和修正他的代码，以抢占评审者的先机。这在系统中增加了更多可以进行代码审查的点，并确保代码总是得到审查，并且审查不会被忘记。

需求匹配:你的代码做了需求要求它做的事情了吗？我们做得少了吗？我们做得更多吗？快速检查会发现任何不匹配。这对于发现代码中是否有问题大有帮助。

可读性:有一种虚假的说法，认为代码只需编写一次，就可以阅读数百次。虽然这种说法可能不准确，但你可能不止写一次，也可能不会读几百遍，你仍然可以了解情况。基本前提是，代码被阅读的次数确实比它被编写的次数多得多。此外，一旦编写完成，您的代码也将准备好接受审查、错误修复、增强等，而不总是由您来完成。同样在 IT 部门，工作变动经常发生，所以一个新人应该能够尽快理解和使用代码。因此，在你离开后，无论是谁看了你的代码，都能够很好地理解你的代码，如果需要的话，可以修改并很好地维护代码，直到产品生命周期结束。

可评审性:进一步的子集是代码也应该是可评审的，你和你的代码应该能够向评审者传达代码应该做什么和评审者应该评审什么。

可伸缩性:您的代码能够承受未来频繁和/或持续的需求变化吗？它能够处理合理数量的需求变更，而不必重写整个东西吗？整个应用程序都是动态的，尤其是在敏捷时代，你的需求永远不会冻结，因此代码也不应该冻结。它应该能够处理需求的变化。这里需要注意的是，不要做得太过。虽然您的代码应该能够处理需求变化，但是您不能(也不应该)让您的代码如此通用，以至于它可以处理众所周知的“世界上的一切”。您的代码应该具有合理的可伸缩性。过多的可伸缩性和过少的可伸缩性一样糟糕。在这条道路上走多远将取决于您的具体业务需求。然而，与你的商业利益相关者谈论细节并不是一个坏主意。他们可以告诉你如何使用，更重要的是某个特性会被使用到什么程度。然后，您可以决定您希望该特性的代码具有多大的可伸缩性。达到多少才是正确的过程需要时间来设定，但是一旦完成，你们将会为可预见的未来而感谢自己。

改进:这是代码审查的基本目的之一。这就回答了“我们能不能用更好的方式做同样的事情？”。更好的方式可能意味着更快的性能、更好的可读性、更大的模块化等等。你需要在代码评审中不断问这个问题。如果你能，那么你的代码评审是不完整的，如果你不能再改进了，那么很可能代码是经过多轮评审才到达这里的。或者是从审查良好的代码中复制的。同样，这也是有可能做过头的事情之一，所以仔细想想你想在不失去理智的情况下在这个兔子洞里走多远。

BNBR:这是摘自 Quora 的一个政策，意思是要善良，要正确。重点是在复习的同时，需要态度好，要对。先做好人。代码审查的目的是看是否可以通过多个头而不是一个头来做得更好。这不是伤害或按摩自我。仅仅指出数据的问题所能做的不应该演变成一场大喊大叫的比赛(口头或通过键盘)。确保你的评论措辞礼貌并且正确。

代码扫描器:在你提交你的代码供审查之前，你的代码应该被工具扫描，以确保基本的检查已经完成，比如括号匹配、格式、打字错误、缩进、命名约定等等。如果您不解决这些问题，您的审阅者将很难浏览您的代码。如果您的评审者发现了这些问题，而不是代码扫描器，那么您没有为您的评审做好准备。

不愉快的经历:代码运行良好，但是有些场景没有经过测试。您如何知道您的代码是否能够处理大多数基本错误或异常？你的回顾应该确保这是在适当的时间之前。同样，你需要明智地使用这一点。你不应该过度。

及时性:您的代码审查应该有一个截止日期。您不能无限期地审查代码，您的审查应该在截止日期内完成。如果您晚发布了几年，更好的代码将如何帮助您？

黑点:每个评审者可能无法评审代码的所有方面。因此，在评审意见中指出哪些方面被评审，哪些没有被评审是一个好的实践，这样每个人都知道代码评审的程度。如果每个人都说我看起来不错，但是每个人只是碰巧回顾了命名约定，那么如果只有一个人回顾可能会更好。如果每个评论者都提到这个小信息，那么每个人都会提前知道在那个特定的评论中是否有任何黑点，并且他们将能够纠正它。

疲劳:不要一次审查太多的代码。如果您碰巧花了很长时间进行评审，那么可能被评审的代码太大了，或者您同时评审了太多的 pr。复习是一个思想密集的过程，你需要确保它被正确地完成。所以，请休息一下，如果你厌倦了评论，但仍然在努力通过，这将反映在评论的质量。一个经验法则是一次不要审查超过 60 分钟，或者一次不要审查大约 400 行代码。

清单:一个很好的捷径是使用清单来检查 PR 或一段代码。这些清单确保你不会走神，不知道你错过了什么，你也将根据预先确定的指标进行审查。

缺陷:你如何处理你发现的问题？并非每个问题都需要或能够立即解决。你必须决定如何处理每一条评论。无论你是修复它们，忽略它们，还是把它们放回你的待办事项中。确保这是一个单独的技术债务积压。

总的来说，这些是我们在进行代码评审时遵循的东西。其中的许多帮助我们确保我们审查的足够多，同时保持我们的过程正常运行，不忽略主要问题。