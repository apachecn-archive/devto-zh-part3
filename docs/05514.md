# 记忆、指称语义学和太阳系中的生命

> 原文：<https://dev.to/loganwohlers/memory-reference-semantics-and-life-in-our-solar-system-990>

我写这篇文章的目的是为刚接触编码引用语义的人提供一个更吓人的概念的高层次概述。当我第一次学习如何编码的时候——我发现这个话题非常难，我甚至都懒得去理解计算机中的内存是如何工作的。最近，我努力去理解在引擎盖下发生了什么，以及为什么事情会以他们的方式运行。这应该(希望)是对这些概念的一个简单介绍。我陷入了一个陷阱，认为这些都是不实用的材料，你可能只会在面试或课堂上看到，但我发现，即使对这些概念的基本理解也可以很好地翻译成多种语言(以及帮助处理更高级的数据结构，如链表/二叉树)，并使我的生活变得容易得多。

让我们从一个简单的尝试开始，揭开引用语义的神秘面纱——引用传递与值传递的主题。最终，这个想法涵盖了变量如何在项目中存储和修改，并且不太复杂——但是经常以一种过于混乱的方式呈现。用最简单的术语来说，计算机中可能的内存就像一个巨大的“数组”。每个“元素”保存一个字节的数据，并有一个从 0 开始向上的内存地址(想想数组中的索引)。这些地址是以十六进制表示的，这就是为什么它们看起来像 0x11cee8，而不是我们熟悉和喜欢的普通数字。因此，考虑到这一点，我们必须看看这些元素中的每一个实际上可以存储什么。只有一个字节的存储空间——每个元素只能存储一个简单的原始值(字符、数字、布尔值等)。不同的语言定义了它们自己的原始值，但是它们大部分是重叠的。一行中的多个内存元素是我们获得更高级的数据结构(如数组和对象)的方式——原语和更复杂的数据结构之间的根本区别是引用语义背后的关键。

按值传送

```
let x=5;
let y=x;

function changeX(x) {
  x=x+1;
  return x;
}

x=changeX(x) //x is now 6
console.log(x) //prints 6
console.log(y) //still 5? 
```

当我们在程序中声明一个变量时——在某个地方划出一块内存来存储这个值。然而，所有的原始值都已经存储在内存中的某个地方——这些是我们的计算机知道的并且不会改变的值(即，我们不是在字母表中创建一个新的字母，而是一个对象或数组可以存储任何东西)。所以当我们创建一个变量，并把它的值设置为一个原语，我们的计算机会说，“哦，我知道这个值，它存储在哪里，这是它的一个副本，用于你的变量”，这里的关键是变量包含了那个值的一个副本。

在上面的例子中:
-我们在内存中为变量‘x’留出空间-它被传递了一个 int 5 的副本

-我们设置 y 等于 x，它也传递了一个 int 5 的副本

-我们将 x 的值改为 6-但这不会影响 y。它们都是从数字 5 的副本开始的，彼此没有关系-所以改变 x 对 y 没有影响。

现在让我们用一个物体做同样的事情..

通过引用传递

```
let person1={name: 'logan', age: 24}
let person2=person;

function agePerson(person){
  person.age=100;
}

console.log(person) // { name: 'logan', age: 24 }

agePerson(person) //person's age is now 100

console.log(person) // { name: 'logan', age: 100 }

console.log(person2) //also changed? { name: 'logan', age: 100 } 
```

这一次 person 对象确实发生了变化——但是这段代码与上面的例子完全相同——那么这里发生了什么呢？当一个变量被声明为一个对象/数据结构时，计算机会说一些类似这样的话——“我不知道你要在这里放什么，但是这里有一些空间和实际的内存地址，这样你以后可以再和它交互”——它会给我们传递一个变量在内存中实际位置的引用。

person1 和 person2 变量只包含对底层对象内存地址的引用-它们不存储其值的单独副本。

-这个引用只是对象在内存中存储的十六进制地址。因此，当我们通过年龄函数改变 person1 时，底层对象(person2 也指向的对象)发生了变化，因此这种变化反映在两个变量中。

当您将复杂的数据结构作为变量传递时，所做的更改将影响实际的底层对象，因为我们有一个对它的底层内存地址的引用。这就是为什么我们经常制作副本/在修改它们时必须小心，以确保我们不会破坏/无意中修改它们的值。对于原语——不需要这么小心。引用语义负责所有这一切。希望有人发现这很有帮助。如果有任何问题/意见，请告诉我！

有用阅读
“数组”即内存的简单例子:
[https://www . cs . Utah . edu/~ germain/PPS/Topics/memory _ layout . html](https://www.cs.utah.edu/%7Egermain/PPS/Topics/memory_layout.html)

非常详细的帖子，带有更复杂的引用语义示例:

[https://code burst . io/explaining-value-vs-reference-in-JavaScript-647 a 975 E12 a 0](https://codeburst.io/explaining-value-vs-reference-in-javascript-647a975e12a0)

谢谢，

洛根