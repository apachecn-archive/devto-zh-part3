# 我的编译器是机械师

> 原文:[https://dev.to/rpalo/my-compiler-is-a-machinist-54g6](https://dev.to/rpalo/my-compiler-is-a-machinist-54g6)

*最初发表在简单程序员上。由他们才华横溢的团队创作的封面图片。蹩脚的手绘草图？全是我。*

编译器。它们是强大的工具，允许程序员使用高级语言编写非凡的软件，而不是编写汇编代码或更糟的代码:1 和 0。

他们是初级程序员最严格的老师。他们一丝不苟地梳理你代码中的每一个字符，寻找缺陷并指出，但最终，他们会与你一起让你的代码运行起来。

编译器还提供了一些安全性和舒适性，一些开发人员发现很难没有它们，因为它们在您开始运行代码之前很久就发现错误并警告常见问题。

我的编译器也是这样做的！只是，他们的名字是肯、艾德和杰西。

我是一名机械工程师。这意味着我已经研究了力、负载、冲击和能量如何影响有用的机械设备和系统。这并不意味着我可以修理你的汽车/冰箱/空调/马桶/电脑/狗。实际上，我很擅长修马桶。我爷爷是个水管工。但那是题外话！

机械工程师负责设计各种很酷的东西:航天飞机、增压器、热交换器、机器人、洗衣机等等。

就我个人而言，我设计用于注射成型机的模具，以制造塑料医疗部件，如手术设备的手柄和流体腔室。机械工程是一个相当广泛的领域，所以有很多专业你可以重点学习。

一些机械工程师做一些超理论的工作，比如做所有需要的数学和计算，以确定航天飞机上的面板是否能承受重返大气层的热量。

其他工程师从事更直接、更实际的工作，比如设计具有正确公差的零件，这样当所有零件制造出来时，所有尺寸都是正确的，所有东西都像预期的那样配合和工作。

有没有试过做一个木箱，结果所有的东西都歪了，因为其中一块面板仅仅大了 1/16 英寸？如果事情与计划相差 0.005 英寸，我设计的许多模具在*都不能工作。*

然而，仅仅想出一个事物应该如何看起来的设计通常是容易的部分。当我挥动神奇的计算机辅助设计(CAD)棒时，我的 3D 设计软件中的一切都显得如此简单，事情看起来就像我想要的那样。

真正困难的部分是弄清楚每一件作品是如何制作的。当你在设计东西的时候，很容易对某些细节置之不理，并且说“我们以后会解决的”但是当你去加工它们的时候，*就没有后来的*。你必须把一切都确定下来。每一个。单身。细节。因为，在一个真实的、完成的设计中，没有办法说“这些部分会以某种方式连接在一起。”好的。怎么会？什么时候？被谁？因此，为了弄清楚所有这些小细节将如何工作，我不断地依靠我们机械师的专业知识。

## [](#the-mechanical-engineering-compiling-process)机械工程"编制"过程

这个过程会因公司而异。一些团队规模较大或法规较多的公司会有更严格的设计审查和验证程序。在较小的团队和不太关键的应用程序中，可能会有稍微自由的过程。这和软件行业没什么区别。

“编译”过程始于你完成一个设计，并把它送到车间让机械师看一看。他们开始关注这样的事情:

*   是什么材质的？基材应该是什么形状？圆杆？扁平的长方形盘子？厚一点的方形块？这类似于软件编译器决定它需要分配什么内存。

*   机械师在加工时如何安装材料并使其保持稳定？一把[老虎钳](http://www.wiltontools.com/us/en/view-series/machinist-vises/MachVise)？双面超级胶带？[夹子](https://www.cnccookbook.com/cnc-jigs-fixtures-workholding-solutions-milling/)？这就像软件编译器必须决定它的目标平台一样。

*   他们将如何加工每个特征？他们将按什么顺序做这件事？这一点很重要，因为机械加工总是会在某个方向留下细小的金属毛刺。有些地方有毛刺比其他地方好得多，也容易清理。

*   在软件方面，根据我的设计，它们可以执行哪些“优化”？他们可以添加一些小的、不显眼的特性来加速构建吗？软件编译器可能会展开循环或内联常量，这样就不必在运行时查找它们。

*   他们会使用什么尺寸和形状的工具(通常是看起来很像高级钻头的端铣刀)？更大的工具会更稳定，更容易切割，但有时，你无法将更大的工具放入更小的区域。他们会使用平底工具、全圆工具还是介于两者之间的工具？这是编译器计算出哪些库对它可用的时候。

[![Different tool shapes: Flat-bottom, bull-nose, and ball-end.](../Images/43b0e1e62716afbb464827f53f5293b7.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--_dsOz2rv--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/h3mbctveuotxigaexh8n.png)

当他们查看零件时，他们试图提出一个单一的统一策略来回答上述所有问题，并以一种允许他们更聪明地工作、犯最少错误和花费更少时间的方式来完成。

通常，他们会在制定策略的过程中走一段路，他们会偶然发现一个“编译器错误”,我们马上会谈到这个错误，这会毁掉他们的整个策略。

很多时候，他们会回来找我，他们会说，“我计划用英寸的杆做它，把它夹在老虎钳里，用 1/16 英寸的球头立铣刀切割整个东西，*除了这个特点使它不可能*。”这时，我不得不把头往桌子上一撞，回到我的设计上，想出一些能让我的“编译器”高兴的调整。

你能看出软件和人这两个“编译器”所经历的过程的相似之处吗？寻找资源，设置工具和库，设置和发现环境，规划出策略，一路优化，然后去工作，使工程师的愿景来到(有希望)功能生活！

## [](#some-common-mechanical-compiler-errors)一些常见的机械“编译错误”

### [](#syntax-error)语法错误

很多时候，从远处看，一个设计可能看起来很好，很干净。

[![A cool mold core pin CAD view, zoomed out.](../Images/1c0b789a9366beb27619a16f776b1ed7.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--fnC6TAXr--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/0wwip5yymwzwvp9k0g0q.png)

但是我们的机械师必须加工这个零件的每一个特征，这意味着他们必须检查、布置和计划制造这些特征的方法。当他们这样做时，他们可能会注意到一些事情:

[![A zoomed in view of the core pin showing a flaw in the design.](../Images/11a13634a228655ad7bb069edd0abb70.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--oK86SpYF--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/843bcrde6irl6tq8jrcm.png)

*喘息！*我们无法用圆形旋压工具加工的尖角。

想想吧。这种工具是圆形的，围绕着它的圆形边缘旋转并切削掉金属。我们不可能像那样切尖角，因为同样的原因，你也很难用手指在沙子上画尖角(嗯，除非你有这些[中的一个](https://youtu.be/rI-15fovYEY?t=75))。

当出现这种情况时，我的机械师们会重重地叹口气，把我带到车间，指着那个尖角说:“你打算怎么做？”

当您快速通读代码时，从高层次上看，代码可能看起来很好，但是一个小小的手指滑动就会让您不顾一切地寻找额外的括号，因为您的编译器坚忍地提醒您在某个地方有语法错误，它无法编译。

### [](#type-error)类型错误

当我第一次开始作为一名工程师工作时，有一件事让我感到惊讶(也许不应该如此),那就是你永远无法真正地按照你应该达到的数量加工东西。十进制数不是这么算的！

测量一些东西。任何事。它有多大？寸？真的是*吗*？或者只是比那大一点点？大概 0.251 英寸？大概 0.250001 英寸？你怎么能确定？你能精确到 0.000001 英寸吗？有些人可以！

在某一点上，讨论变得愚蠢，每个工程师都知道在某一点上“足够好了”但是这有什么意义呢？嗯，这叫做[公差](https://en.wikipedia.org/wiki/Engineering_tolerance)，作为工程师，我们的工作就是计算出公差应该是多少！在我的组件不能工作之前，这个洞的绝对最大值是多少？绝对最小的呢？

现在，你有了一个范围，而不是一个单一的数字测量。可能在 0.245 到 0.255 英寸之间。+/-0.005 英寸的公差在机械加工领域实际上是相当标准的，它每天都在打击我的思想，我们可以期望在一张纸的厚度范围内精确地制造东西。

一个常见的错误是，一些工程师会设计零件，但忘记在不太重要的地方留出额外的公差。他们会要求他们设计的每个部分都有+/-0.001 英寸的尺寸。这是可行的，但是时间和成本的差异可以用*天*来衡量，当你必须满足那个规格的时候！

代码是否指定了实际需要的内容？它能要求更普遍的东西来使生活变得更容易吗？构建的主要特性会因为这种粗心的过分具体的需求而被迫经历重重困难吗？你在整个代码中满足这些自我施加的限制了吗？否则，您将会看到一个类型错误。

### [](#runtime-error)运行时出错

有时你的零件单独工作很好，可以没有任何问题地加工，直到你去把所有的零件组装在一起，你才发现你的错误。

[![Two plates together, with holes that don't quite line up.](../Images/1f1d5787a298ac51dc877d643d572a0a.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--18_rToHo--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/ojcffr0nnpqtfuouk0qt.png)

万岁黛西。这是行不通的。那些洞没有排成一行。根据发生的情况，这些错误可能是最隐蔽和最难发现的。直到为时已晚。它们可能对构建产生最大的影响，并引起最大的客户焦虑。

每个部分看起来都设计得很好，没有明显的缺陷，所以编译器很乐意编译它们。然而，到了要使用它们的时候，突然问题出现了，装配无法工作。

这类似于运行时错误。它看起来可以编译，但在运行时会崩溃，因为各个部分不能很好地组合在一起。因为在这一点上，问题离客户更近，他们更有可能直接受到这类错误的影响。

### [](#segmentation-fault)分割断层

这本质上不一定是编译器错误，但有时在你的几何图形中有一个偷偷摸摸的. 0001 英寸不一致的边或面，因为有人对他们的[俯冲表面](https://www.youtube.com/watch?v=NXM27688UAs)有点太疯狂了(看着你，杰瑞)。

对我和机械师来说，一切看起来都很好，但它会在告诉机器做什么的代码中产生一些小“错误”。这些虫子不会抬起它们丑陋的头，直到你起来运行。

[https://www.youtube.com/embed/fTzZpjLC3OQ](https://www.youtube.com/embed/fTzZpjLC3OQ)

这可能更具破坏性(也更可怕！)比典型的简洁但吓人的软件版本:

[![Segmentation Fault.](../Images/bd934c9e0307955f4438306b27bb2223.png)T2】](https://res.cloudinary.com/practicaldev/image/fetch/s--5ScmT1Su--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/7l4olpqz5rgzoc6bilph.png)

然而，基本的相似之处仍然存在。代码看起来不错。编译器很高兴。这个程序运行得很好…直到它遇到了一个偷偷摸摸的内存问题并严重崩溃。

而你这个程序员，也不知道到底哪里出了问题。你知道你犯了什么样的错误。有人去了不该去的地方。但是它没有告诉你如何修复它。它只是告诉你它很糟糕。

## 我们解决问题，只要我们的编译器说没问题

每当我阅读一篇关于软件工程实践、关于良好设计的讨论或关于苛刻编译器的失眠咆哮的博文或文章时，我都会很高兴地看到，尽管软件工程和机械工程看起来如此不同，但两者之间有如此多的相似之处。

我们都在努力为需要我们帮助的人解决问题，我们努力以最符合人体工程学、最高效、最灵活的方式来做到这一点，以便下一代工程师可以在我们已经完成的基础上再接再厉，而不是把所有东西都扔掉，重新开始。我们与工具和队友一起工作，让我们的生活和产品变得更好。