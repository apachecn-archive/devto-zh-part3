# 选择伟大的钥匙

> 原文：<https://dev.to/korenmiklos/choose-great-keys-e2f>

键是我们用来引用数据表中的实体的东西。主键是表中每个观察的唯一标识符，外键指向另一个表中的其他实体。

但是这些钥匙在现实生活中是什么样子的呢？它们是从 1 开始连续编号的吗？我们可以用公司和人名作为关键字吗？我们是否应该使用加密哈希函数来生成[通用唯一标识符](https://en.wikipedia.org/wiki/Universally_unique_identifier)？通常情况下，您会通过加载数据的数据存储中已经给定的键来决定这一点。但有时你会面临选择自己钥匙的独特乐趣。

[![Photo by [Tim Evans](https://unsplash.com/@tjevans?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)](img/e241c43e5383b1879c0a55d4a87f9654.png) ](https://res.cloudinary.com/practicaldev/image/fetch/s--C3bfm7aT--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://cdn-images-1.medium.com/max/9478/0%2A_VYwP0-zFPcTmacT) *照片由[蒂姆·埃文斯](https://unsplash.com/@tjevans?utm_source=medium&utm_medium=referral)于 [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)* 

### 名称不唯一

最重要的是，键应该是*唯一的*，也就是说，任何两个不同的观察都不应该接收同一个键。这听起来是显而易见的，但是您的设计可以使这个需求更难或更容易满足。

假设您决定以用户的姓氏来称呼他们(这显然是一个愚蠢的想法)。在第二部《史密斯的 T1》和《T2 的琼斯的 T3》之后，你必须改变你的系统。然后你决定加上名字。你是安全的，直到第二个"*约翰 _ 史密斯*或"*查尔斯 _ 琼斯*"你最终会得到“ *john_smith_02* ”，这实在是太难看了。(如果您的数据中有 99 个以上的约翰·史密斯呢？)

如果你认为你永远不会犯这种愚蠢的错误，读一读帕特里克·麦肯齐的 40 个关于名字的错误清单。我来自一个使用东方姓名顺序、使用许多重音字母的国家，在那里，妻子的婚后名字通常不包括她们的名字(如“*szabójánosné*”~“*John Smith 夫人*”)。我遇到过只有一个名字的人。他们在任何网络应用程序或数据库中输入自己的名字有多难？

公司和组织的情况更糟。几乎不可能不止一次使用他们的正确名字。我的大学所在的布达佩斯地区的市政府正式名称为“ *Belváros-Lipótváros 布达佩斯 Főváros 诉 keru let polgármestri hiva tal*”你认为在真实世界的数据中拼写正确的频率是多少？此外，匈牙利还有 37 所小学，它们的官方名称只是“*小学*”

不，名称不是唯一的，对于唯一键来说是一个糟糕的选择。这就是为什么大多数 web 应用程序和数据库选择用户选择的字母数字用户标识、电子邮件地址或计算机生成的数字标识符。

### 详细按键

遵循这四个提示来创建有用的密钥。

1.  **如果你描述的实体有一个很好的标识符，使用那个**。人们有社会保险号，公司有雇主识别号，地区有坚果或 FIPS 代码，国家有 ISO 3166 代码。除非万不得已，否则不要发明自己的钥匙。

2.  您的密钥应该是人类可读的，而不仅仅是机器可读的。顺序递增的整数 ID 没有太大帮助。也不是诸如 dc6e 5923 f 968 db 05 aee 116d 94d 11792385 a9 fcca 8 的 SHA1 散列。根据上下文，组合 2-3 个字母和 8-10 个数字效果最好。

3.  **一种类型实体的键应该很容易与另一种类型实体的键区分开来**。当你看一个键的时候，你应该立刻看到它指的是什么实体。每个美国人都知道“*08540”*是一个邮政编码，“*770-10-2831”*是一个社会安全号码。

4.  **使用连字符或其他标点符号来表示**键中的层级。邮政编码+4 "*53075-1108 "*清楚地将 5 位邮政编码与 4 位路由号码区分开来。URL 是层次键的最好例子:“【medium.com/data-architect"】指的是这个博客，但是你可以使用这个结构为 Medium 上的其他博客生成键。

    > 例如，你可以用 *F-DE-01234567* 来指代一家德国公司。 *F-HU-12345678* 是一家匈牙利公司。(注意使用两个字母的 ISO-3166 国家代码。) *P-1234567890* 可能是一个人。

根据您正在建模的实体的类型，寻找这些现有的唯一标识符。

*   **公司**:税务标识符、雇主识别号(EIN)、欧盟增值税标识符、开放公司 ID

*   **个人**:社会安全号码，电子邮件地址

*   **地区** : FIPS、坚果、邮政编码(尽管邮政编码并不指*地区*

*   **国家** : ISO 3166 标准、2 字母、3 字母或数字标识符

寻找好看的钥匙很有趣。出去吃点。