# 财产是一件大事。

> 原文:[https://dev.to/willmenn/properties-is-a-big-thing-cd3](https://dev.to/willmenn/properties-is-a-big-thing-cd3)

很难看到一个开发人员关心并培养与系统中所有属性文件的良好关系。当您只定义了几个属性时，就很容易处理和理解发生了什么。然而，当你开始拥有一个包含许多行的大文件，并且每个版本都有一些修改时，理解什么将会被生产或者不被生产将会是一场噩梦。

### [](#properties-left-in-the-file)属性留在文件中

我注意到的第一件事是，当项目中有很多修改时，会添加大量的属性，然后在几个版本之后，它们将不再使用，这通常是功能标志的情况，当团队启用功能标志时，他们忘记了他们需要删除属性，导致生产时出现噪音。

当团队不再使用它时，我的建议很容易被删除。

### [](#properties-not-structured)属性未结构化

当文件很大，并且每个环境都有几个文件，或者最糟糕的是所有环境都有一个文件。yaml 文件使我们能够拥有它，属性是无序的。当你需要验证属性是否相同，或者它们是否存在时，这真的很难找到，而且人类会犯错误。

处理这种情况的最好方法是有一个很好的结构，绑定下面行中的属性，比如 HTTP 调用，HTTP 层次结构下的所有内容。另一个解决方案是编写一个代码来检查，这会有所帮助，但会让开发人员创建一个混乱的文件。

### [](#one-file-for-all-environments)一个文件适用于所有环境

如果有 30 行属性，有 4 个环境(`DEV,QA,PRE-PROD,PROD`)，那么在一个文件中有 120 行属性。当您需要查看属性 X 是否将投入生产，并且该属性仅在 QA 环境中添加时，您将需要上下滚动几次以在文件中迷失(哈哈哈，在我身上发生了几次)来查看属性是否被正确地设置为投入生产。

一个简单的解决方案是为每个环境创建不同的文件，并使用 git diff 来了解文件之间的不同之处。如果性质是相同的顺序，差异将很容易解决它。

### [](#dont-use-files-cross-environments-but-use-common-files-for-each-environment)不要跨环境使用文件，而是对每个环境使用通用文件

当您有一个在所有环境之间共享的文件时，总是有可能有人合并了一些用于开发的内容，并最终用于生产，这是我们甚至不希望出现的小可能性。然而，拥有它是一件好事，它是一个在同一环境中由所有`apps`共享的文件，可以是一个集中的功能切换，或者是所有应用程序共享的另一种类型的属性。在应用程序之间共享一些文件有助于了解系统正在使用什么，而无需查看每个应用程序的每个文件。

### [](#protect-production-properties)保护生产属性

我们不希望——至少是可以容易避免的错误——投入生产，比如属性错误。我的想法是，我们需要有一种方式，开发者需要明确地说他希望修改进入生产，通过不注意来最小化错误，这就是著名的`git push -f`。

对此的一个建议是有一个分支来保存产品属性或标记，开发人员需要指向它来将属性发送到产品。

### [](#do-not-create-breaking-changes-in-the-properties)不要在属性中创建突破性变化

尽量不要做破坏性的更改，比如直接更改属性名或属性值。尝试添加一个新的属性来保存它的新版本，部署它，查看所有的工作，然后删除旧的，并将新的属性更改为当前的。通过这样做，如果您有一个自动部署，您将能够始终顺利地部署和回滚。