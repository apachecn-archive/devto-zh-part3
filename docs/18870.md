# Keycloak SSO 第 1 部分:什么是单点登录？

> 原文:[https://dev . to/just _ anine/key cloak-SSO-part-1-what-is-single-sign-on-57gf](https://dev.to/just_insane/keycloak-sso-part-1-what-is-single-sign-on-57gf)

在这个系列中，我们将看看 Keycloak，这是一个开源的单点登录解决方案，类似于微软的 ADFS 产品。

在第一部分中，我们将简要了解什么是 SSO 和 Keycloak，以及为什么使用它们。

## [](#what-is-single-sign-on)什么是单点登录

单点登录(SSO)是多个相关但独立的软件系统的访问控制属性。[维基百科](https://en.m.wikipedia.org/wiki/Single_sign-on)

这意味着，我们可以使用单一的身份验证服务来允许用户登录到其他服务，而无需为正在登录的服务提供密码。

这不同于将每个应用程序连接到 LDAP，因为这需要为您想要登录的每个服务提供用户名和密码。

### [](#benefits-of-sso)单点登录的好处

1.  身份验证的中心位置便于审计和安全。

2.  授权配置的中心位置，即 Jane 能够访问电子邮件，但不能访问 CRM 套件

3.  无需通过互联网发送 LDAP 请求，即可对托管 CRM 套件等外部服务进行身份验证

4.  令牌作为 HTTPS 连接的一部分包装在 SSL/TLS 中，但也可以使用仅在身份提供商和服务之间已知的密钥进行签名和/或加密，以提高安全性

## [](#what-is-keycloak)什么是钥匙锁

Keycloak 是一个开源程序，允许您设置一个安全的单点登录提供商。支持 SAML 2.0、OpenID Connect 等多种协议。它还可以在本地或通过 LDAP 或 Kerberos 后端存储用户凭证。

这些特性使得 Keycloak 具有高度的可配置性，同时也非常容易安装和设置。

更多关于 Keycloak 的信息可以在这里找到:[https://www.keycloak.org](https://www.keycloak.org)

### [](#basic-workflow)基本工作流程

从用户的角度来看，对使用 SAML/OIDC 的服务进行身份验证的基本工作流程如下:

1.  用户转到受 SSO 保护的服务(称为服务提供商或 SP)的网址。

2.  该服务要求用户的浏览器可能已经存储了一个 cookie，其中包含一个令牌，如果它在浏览器中找到一个有效的令牌，它就让用户登录。如果此令牌不存在或无效，该服务会将用户定向到已配置的身份提供者(IDp)。

3.  一旦用户到达 IDp，就会出现一个登录页面。

4.  用户使用他们提供的凭据登录。IDp 可以将这些凭证与本地存储的凭证进行比较，或者与 LDAP 或 Kerberos 后端进行比较。

5.  用户成功登录后会获得一个令牌，该令牌作为 cookie 存储在浏览器中，并自动重定向回他们最初尝试访问的服务。如果使用像 OIDC 这样支持授权的协议，这个令牌通常包含一个用户名，以及关于用户可以访问什么的信息。

6.  该服务从浏览器请求令牌，如果令牌有效，则允许用户访问该服务。

令牌验证是在服务和身份提供者之间的安全反向通道上完成的，不涉及浏览器，以提高安全性。