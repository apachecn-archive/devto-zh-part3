# 向云迁移

> 原文：<https://dev.to/davorg/moving-into-the-cloud-4p4>

当然，在过去的几年里，我已经看过亚马逊网络服务(AWS)很多次了。我目前使用 S3 作为一些数据库备份的廉价存储，我已经尝试过启动 EC2 和 RDS 实例(是的，像大多数人一样，当我忘记再次关闭它们时，我已经被巨大的成本刺痛)。

但上周，我在伦敦 ExCel 举行的 2019 AWS 峰会上意识到两件事。首先，我真的需要努力掌握亚马逊的云服务是如何工作的，其次，为了做到这一点，我需要将我的一个真正的项目转移到云中。我决定在这里写下我的经历。

让我告诉你我将要作为例子的项目。这是一个名为[传宗接代](https://lineofsuccession.co.uk/)的网站。该网站有一个目标——它能让你看到从维多利亚女王统治时期开始的任何日期的英国王位继承顺序(计划是将这追溯到 1701 年，当时[现行继承规则](https://blog.lineofsuccession.co.uk/2019/01/the-act-of-settlement/)颁布——但这需要我添加更多的数据)。它有几个活动部件:

*   有一个数据库(目前是 MariaDB)包含了皇室家族的详细资料，可以用来计算任何日期的继承顺序。
*   有一个 web 应用程序(使用 Dancer2 框架用 Perl 编写),它接受一个日期请求，进行计算，并向用户呈现正确的顺序。
*   计算出的继承线很少改变，所以一旦我们计算出一个，我们可以存储它，而不必再次计算。目前，这个预先计算的数据存储在 memcached 中。
*   有一个 WordPress 博客，我在那里写(希望)关于皇室的有趣文章。
*   nginx 将所有的事情联系在一起，确保 HTTP 请求被转发到正确的地方。

这一切都运行在我在数据中心租用的一台服务器上。但这都是上一个千年的事了，我想做一些更符合时代的事。目前，这是我的想法。

*   该数据库将成为一个亚马逊 RDS 实例。
*   网络应用将被封装并运行在亚马逊 ECS 或 T2 亚马逊 Fargate 上。
*   缓存将变成[亚马逊弹性缓存](https://aws.amazon.com/elasticache/)
*   博客将是另一个容器——大概是基于 WordPress 团队提供的标准容器。
*   我不确定 nginx 会怎么样。这就把我带到了...

我需要找到答案的一些问题:

*   我应该从 MariaDB 切换到不同的数据库吗？那会有多难？
*   我如何在 ECS 和 Fargate 之间选择？什么最适合我的用例？
*   我应该考虑哪些 ElastiCache 选项？
*   博客是一个单一的容器吗？WordPress 数据库是一个独立的容器，还是另一个 RDS 实例？
*   nginx 会是另一个容器吗？还是 AWS 有更好的东西我可以用？

事实上，整个路由的事情对我来说是一个没有答案的大问题。我需要对 AWS 如何处理这个问题做更多的研究。我有点担心这种转换。我的网站有访客(好吧，访客不多，但仍然...)一旦我让站点在 AWS 上工作，我如何无缝地将 HTTP 请求转移到新系统？

我也在考虑改进。正如我上面所说的，数据很少改变——只有当某人出生或死亡，或者当我添加更多数据时。因此，也许构建缓存数据应该完全脱离 web 请求。也许是后台工作(一个 [AWS Lambda](https://aws.amazon.com/lambda/) ？)可以监视数据库的变化，并且只重建和无效高速缓存中需要的位。

这就是计划。我希望能够每隔几周左右就在博客上记录我的进步。如果你对我正在做的事情有任何建议，我很乐意听听。