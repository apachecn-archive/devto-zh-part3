# 构建降价解析器和处理器的时间到了(MDL 日志#1)

> 原文:[https://dev . to/mortoray/time-to-build-a-markdown-parser-and-processor-EDL-log-1-44 B1](https://dev.to/mortoray/time-to-build-a-markdown-parser-and-processor-edl-log-1-44b1)

我需要写一个 markdown 解析器和处理器。我的写作项目已经超出了我现有工具的能力。也缺乏高质量的写作工具——这是我在写书时发现的。我最终决定我必须为自己解决这个问题，希望其他人也能利用这一点。

我认为最好的开始方式是在 dev.to 上发一个帖子。也许我有点拖拉，但这是有原因的。我想从一开始就提供跟踪发展的机会。到目前为止，我有一个[存储库](https://github.com/mortoray/mdl)，但是它是空的。

我鼓励你提出问题，质疑你在项目中看到的任何东西。

## [](#requirements)要求

正确的起点应该是用户故事。但是，用一个用户故事来说我，有点尴尬。还有，我的需求有些明确，所以要求也挺严格的。尽管如此，当我继续向前时，我将回到正确的用户故事。有些功能缺少一些动机。

以下是我需要的一些关键东西:

*   我在技术博客文章中做的所有事情。这包括标准格式，包括代码、图像以及 latex 方程。(用更好的东西代替 latex 是长期特性)。
*   多个目标。我在我自己的网站上发帖，在 dev.to 上，在 Medium 上，在我的[烹饪网站](https://edaqaskitchen.com)上，还有一些写作网站。这些都有不同的格式和编码要求。
*   电子书和印刷就绪。我被写作领域可用的工具惊呆了。应该可以用基本的减价方式出版一本好看的书。

如果时间允许，我会用用户故事来扩展这些。它将帮助您理解我为什么需要这些特性，以及它们应该如何工作。我也在 Skill Share 上写用户故事的课程；我会回复你的。

## [](#architecture)建筑

我已经写了数不清的解析器和树处理器。我不会评估任何现有的解决方案——我想我已经做了 20 多年了，仍然对现有的方案不满意。我最近在 Leaf 上的工作有一个典型的解析器结构，我想我会模仿它。

这个文档系统的工作方式很像一个编译器，有以下几个阶段:

*   *树解析器*:将原始文档解析成节点树。这将处理底层的源代码细节，并部分处理语法。通过坚持使用通用树，我们将大量语言细节排除在解析器之外；这样就更简单了。
*   *解析树转换器*:从这里，解析树被扫描并转换成抽象语法树(AST)。这将低层结构提升为高层语法。
*   AST 处理:这是许多工具将被构建的地方。输入树被标注了更多的信息，像用户模板之类的东西被解析，片段被组合在一起。虽然导出模式可以影响这个阶段，但它仍然是一个抽象的树。
*   *下降/导出*:AST 导出为最终文件格式。这包括语法突出显示、latex 图形创建、将源代码上传到 gist 等功能的处理。

在我工作的过程中，我会提供每个阶段的更多信息。这种结构提供了几个不同的层，可以在其中添加扩展。

虽然我会用 Python 编码，但树解析器最终会用 C++实现。这是处理过程中成本最高的部分——在解释型或动态语言中，一次扫描一个字符是很困难的。然而，我最初的需求是针对单个文档的，所以，就目前而言，速度不是问题。

## [](#first-goal)第一个目标

我的第一个目标是得到一个基本的树解析器。这是一个可测试的组件。它也是链中的第一个，是所有其他组件的入口点。

我完成后会给你一个更新。同时，请随意提问。你可以看看[库](https://github.com/mortoray/mdl)，但是会空一段时间，然后混乱。我相信重构比设计更重要。