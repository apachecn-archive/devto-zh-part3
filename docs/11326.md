# 进行代码评审的 10 个经验教训

> 原文:[https://dev . to/jnschrag/10-经验教训-指导-代码评审-5di6](https://dev.to/jnschrag/10-lessons-learned-conducting-code-reviews-5di6)

去年秋天，我的开发团队从 1 个人(我)增长到 3 个人。适当的拉取请求和代码审查突然变得至关重要，以确保在来自不同背景的多个开发人员工作之后，我们有一个内聚的代码库。

作为团队中的首席开发人员，我是负责进行这些评审的主要人员。我以前从来没有这样做过，所以要让这些评论变得有效，我还有很多东西要学。以下是我在过去几个月里进行代码评审的经验中得到的提示和教训。

## [](#1-always-start-with-a-positive)1。总是以积极的态度开始

有时候，PR 有很多错误:没有使用正确的元素，实现的设计与模型不匹配，逻辑没有意义，等等。作为一个评论者，你的工作就是寻找这类错误，并指出它们需要被纠正，而只关注那些负面的错误是很容易的。

但是没有人会故意犯错，所以公开指出这些错误会是一种消极的、不舒服的经历。写出所有这些错误对评论者来说也不好玩。为了建立一个积极的基调，我学会了总是用感激和我认为他们做得好的事情来开始我的评论。即使代码中有很多问题需要解决，感谢他人的贡献也是很重要的。有错误的代码总比没有代码好，所以感谢他们第一次解决问题。

如果代码没有在评审中被提及，它通常被认为是好的，但是积极的表扬会有很大的帮助。这可以建立信心，让人们更容易接受反馈，因为他们知道你已经花时间彻底检查了他们的代码。如果他们对 X 的逻辑没有那么伟大，但是他们对 Y 和 Z 做得很好，让他们知道！

## [](#2-its-not-you-its-the-code)2。不是“你”，是“代码”

如果你曾经学习过解决冲突，你可能已经知道“我”的陈述的重要性。使用类似“我认为……”，“我感觉……”而不是“你做了…”在化解紧张局势和将焦点从个人转移到问题本身上有很大的帮助。

同样的方法应该应用于代码评审。提出批评时，避免使用“你”这个词很重要。接受对你工作的批评已经很难了，所以不要让这个人觉得是他们错了，这样会让事情变得更难。例如，切换

> 你在第 25 行的逻辑不清楚。

到

> 我不明白第 25 行的逻辑。

完全改变评论的语气。我知道当我的代码被审查时我更愿意读哪一个。

## [](#3-use-line-item-suggestions)3。使用行项目建议

我的团队在我们的大多数项目中都使用 GitHub，我最喜欢的功能之一是能够发布关于特定代码行的评论。它消除了在更大的注释中写出特定的文件/行号所带来的许多麻烦和潜在的混乱。如果你的大部分评论都是简单的修改，这可以帮助你做一个简单的需要修改的清单。

**奖励:GitHub 有行货建议。详情请查看[@ _ Darren burns](https://dev.to/_darrenburns)[“GitHub 的 8 个生产力技巧”](https://dev.to/_darrenburns/8-productivity-tips-for-github-44kn)。**

如果你使用一个不提供这个功能的不同平台，那么我强烈建议在写你的评论时包括/链接到特定的行号。作为审阅者，这可能会增加您的工作量，但这将有助于确保那些必要的更改不会被忽略。

## [](#4-set-project-standards-early-amp-tools-to-help-review)4。尽早设定项目标准&工具来帮助评审

我们都学习如何并且更喜欢以不同的方式编写代码。当我是唯一的开发人员时，我从来不需要担心代码风格、命名约定或其他项目标准，因为无论我如何做都是“正确”的。当我开始审查其他人的代码时，我很快意识到，并不是每个人都有和我一样的内部标准，这不仅会导致代码库的混乱，而且需要我花费大量额外的精力来审查。

这里学到的经验很简单:尽早设定项目标准。

无论这些标准是什么，重要的是整个团队都认同它们，并且知道期望什么。你在任何事情上都需要它们:使用的语言、分支命名约定、项目组织、注释约定等等。

旁白:这个过程让我意识到我对 CSS 属性顺序有强烈的看法，所以我在我们的讨论中强调了这一点。

你是在内部开发自己的标准，还是使用现有的标准，这取决于你，但是如果你想在项目结束时有一个内聚的代码库，这是非常重要的。

### [](#tools-to-help-review)帮助复习的工具

一旦有了项目标准，就值得花时间来设置专门帮助实施这些标准的工具。您可以使用 Linter 来分析您的代码，并将其与一组语法相关标准的指南进行比较。它会标记任何错误，甚至可能自动为您修复它们。

为了捕捉任何进入 PR 的错误(尽管理想情况下，它们首先在本地被捕捉和处理)，我们已经设置了 TravisCI 来运行额外的检查。因此，如果 Travis 构建在我进行评审时失败了，它给了我一个在深入研究之前开始的地方。

## [](#5-start-broad-amp-then-dig-into-details)5。开始泛泛而谈&然后深入细节

在一个拉取请求中可能有很多代码，所以在实际进行代码审查时，我喜欢从大处着手，深入细节。对我来说，这个过程通常是这样的:

1.  有没有失败的测试？如果是，为什么他们失败了？
2.  PR 中是否包含任何不应该存在的额外文件？
3.  我可以没有任何错误地检查分支吗？
4.  是否更新了任何相关文档以反映这些变化？
5.  项目中是否添加了新的包或依赖项？如果有，为什么要增加？需要它们吗？
6.  HTML 是有效的、语义的、可访问的吗？
7.  CSS 是否遵循项目标准？实施中是否考虑了所有的视口宽度？跨浏览器兼容性呢？
8.  JavaScript 是否遵循项目标准？是模块化的吗？容易按照逻辑来吗？是否考虑了边缘情况？控制台中是否有零散的日志？

如果在最初的几个步骤中有很多问题，我通常会在那里结束我的审查，并等待这些问题得到解决，然后再深入代码的密集部分。

## [](#6-establish-dedicated-review-time)6。建立专门的审查时间

这对我来说是最难学的课程之一，也是我仍在努力克服的事情。做一次彻底的、有成效的代码审查需要*时间*。即使 PR 很小，它仍然(通常)需要检查分支，检查逻辑，审查问题，等等。当你有其他优先考虑的事情时，忽略这个拉取请求或者在回顾时做最少的事情是很有诱惑力的，但是这不是一个好的长期解决方案。

我对此的解决方案相当简单:我有专门的时间做评论。我把它记在我的日历上，我的团队知道这些时间是什么时候，所以他们知道什么时候期待反馈。为你的团队和你自己设定期望是关键。

## [](#7-establish-what-youre-expecting)7。确立你的期望

您是否将拉动式请求与问题相关联？提交拉取请求时需要某种格式？对一个请求中应该包含多少行代码有限制吗？

如果你对这些问题中的任何一个回答是肯定的，那么预先建立这些期望是很重要的。作为评审者，这可以节省你的时间，并有助于防止你的团队不得不猜测你在寻找什么。花时间和你的团队交流，找出最适合你们的方法，因为...

## [](#8-everyone-reviews)8。人人点评

在我们的团队中，每个人都有机会做代码评审，每个人都有自己的代码被评审。作为团队中的高级开发人员，我的 pull 请求在被合并之前要经过其他两个成员的审核。我这样做是因为:

1.  我的代码有错误，通常可以改进，而且
2.  它为更多的初级开发人员创造了空间，让他们可以询问我是如何/为什么以这种方式实现某些东西的。

我坚信，学习如何写好代码的最好方法是阅读写得好的代码，所以即使没有什么要改变的，也可以让他们阅读与他们正在从事的项目相关的好的代码示例。在我们的代码评审中，我们经常就实现进行很好的对话，当我能够回答关于它们的问题时，这让我对我的决定更有信心。

## [](#9-reevaluate-often)9。经常重新评估

对我和我们的团队来说，进行代码评审是一个很大的学习过程。基于我们的经验，我们已经做了很多改变。抽出时间思考项目的这一方面很重要；我通常将它作为项目更广泛的事后分析的一部分，这有助于将代码审查作为开发过程的一个关键部分。

问清楚哪些有效，哪些无效，诚实回答！询问您的团队成员他们认为哪种反馈是有帮助的，或者确定评论中可以改进的地方。考虑你花了多少时间做回顾，并从中找出任何模式。如果你经常评论相同类型的问题，你能采取什么措施来解决它，以便在下一个项目中减少这些问题吗？思考这些类型的问题并做出改变将会改进团队中每个人的评审过程。

## [](#10-theres-more-than-one-solution)10。解决方法不止一个

这个很难。真的很难。当你是评审者时，开始重构提交者的代码来反映你会如何做是非常诱人的。开始时只是简单的重构，很容易转变成重新编写整个代码段来得到“正确”的解决方案。但是这不是代码审查的目的。

可以肯定的是，这是一条细线。有时代码确实需要重新构思和完全重写，但这不应该经常发生。如果是这样，那么更好的方法是在代码评审阶段之前将程序配对。

但是仅仅因为它不是你应该如何处理和解决问题，并不意味着它不好。当你打开一个拉动式请求并开始评估时，你需要在门口检查你的自我，并以开放的态度考虑新的解决方案。把它当作学习的机会，而不是炫耀你认为自己有多聪明。

**奖励: [@maxwell_dev](https://dev.to/maxwell_dev) 在上写了一篇精彩的文章《这不是关于你的》。**

这是一个学习所有这些的旅程，我很感激我的团队在我弄明白这一点的时候给了我持续的耐心。在持续学习和经常重新评估的本质中(#9！)，你有哪些进行代码评审的小技巧？