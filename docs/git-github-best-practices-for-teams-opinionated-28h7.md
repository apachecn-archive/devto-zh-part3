# Git + GitHub 团队最佳实践(固执己见)

> 原文：<https://dev.to/bholmesdev/git-github-best-practices-for-teams-opinionated-28h7>

***免责声明:**这是改编自我们内部编写的一份指南，旨在帮助新手在加入项目团队时站稳脚跟。如果你有兴趣，你可以在这里了解更多关于这个组织的信息。是的，在接下来的几个月里，我们正在改造网站:)*

有一些关于如何最好地使用 Git 的文章有了新的见解。鉴于该工具的通用性和自由形式，很容易找到一个适合某人的新系统。因此，真的没有人人都必须遵守的通用黄金标准。所以不要把这篇文章的内容当成法律！这仅仅是一个意见，建议我们的好的组织已经发现工作得很好。

请注意，Bits of Good 是一个大学级别的组织，所以我的观点是基于在较小的团队而不是在大公司工作的经验。因此，鉴于我有限的接触，像积压、票务和用户反馈这样的问题不在这里讨论。

## 目录

1.  [创建和组织问题](#issues)
2.  [使用 Gitflow 分支流量](#flow)
3.  [分支最佳实践](#branching)
4.  [提交最佳实践](#committing)
5.  [拉请求最佳实践](#pull-requests)

## 创建和组织问题

在开始修改代码库之前，让我们先讨论一下组织需要做的事情。一个漂亮的 GitHub 特性是可以选择创建“问题”来将任务分解成可分配的块。在团队环境中，这有助于决定截止日期和优先事项，以保持每个人都在正轨上。

### 多好的问题应该说什么

让我们从一个坏问题的例子开始:

[![Example of bad GitHub issue](img/05f33a26db0e55dc95d60950f242d059.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--wjoDuHT3--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/tpjshixy7vhwkb2c1nji.png)

不仅不清楚最终结果应该是什么样子，而且也没有足够的方向来防止新手的脑袋爆炸。帮大家一个忙，把问题分解开来！

每当你创建一个新问题时，GitHub 本身就很好地包含了示例标题。这些对于开始来说非常好，但是对于你制造的问题来说可能有点太多了。至少，尝试包括:

1.  如果是一个特性:添加到项目中的特性的描述
2.  如果是 bug:描述 bug 是什么以及如何复制它
3.  **行动项目**的分解。这应该是为了完成特性/解决 bug 而要完成的小任务的列表(最好有复选框)
4.  特性/ bug 或未来可能需要的改进的一般说明
5.  如果团队仍然需要决定某些细节，讨论要点

行动项目应该是问题的主体。只要能让人们更容易地阅读这个问题，你可以随心所欲地细化或技术性化。好主意是包含潜在解决方案的超链接和支持图片，如作为指南的实体模型。

**可选:**像教程一样分解行动项目，向读者介绍解决问题的一种潜在方法。这对新团队成员来说很好，这样他们就不会在不熟悉的代码库中迷失方向。

这里有一个例子，可以说明如何加强前面那个令人困惑的一行程序问题:

[![Example of good GitHub issue](img/422e9f5d4d678ff66975cbc029e3fe0e.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--l9js0xIt--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/whvbzrw1l6cesm5xn76j.png)

### 利用里程碑

如果你的团队碰巧使用了[敏捷开发](https://linchpinseo.com/the-agile-method/)或者另一种形式的快速发布周期，你应该避免在没有任何完成时间框架参考的情况下抛出问题。GitHub 允许你使用“里程碑”来获得你在每个开发周期/ sprint 中工作的焦点视图。这只不过是特定时间回购中发行的一个子集。

要查看这些，请在“问题”选项卡中查找“里程碑”按钮。从这里，您可以用有用的标题、描述和截止日期创建一个新的里程碑。创建新问题时，您可以使用边栏将问题添加到给定的里程碑中。一般来说，确保在给定的里程碑中没有太多问题。可能需要一些时间来感觉某些任务需要多长时间，所以在开始时保持乐观，然后根据工作量进行调整。

[![Example of a GitHub milestones setup](img/18c58508ffebc27d8d23771a160e3459.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--l1M1iSLL--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/wc3c731g2nsb9o3cbldh.png)

查看我们团队过去在敏捷开发时间表上的里程碑。我们发现表情符号有助于关注里程碑目标😛

## 分支流程使用 Gitflow

很容易跳入一个新项目，并立即想到“去他妈的手续，我要跳进一些代码！”当被兴奋冲昏头脑时，很容易忘记一个重要的细节:你应该总是首先从一个开发分支分出一个分支！

这种方法在初学 Git 的项目中经常丢失，单独从 master 中分支出来，每当代码获得好评时就合并进去。这种方法在大部分时间只被开发人员看到的小规模项目上工作得很好。然而，当用户参与进来时，可能会在任何时候访问活动项目，将每个变更都推送到“生产”分支(如 master)可能并不总是一个好主意。例如，假设您在一个团队中构建一个通知仪表板，其中两个开发人员负责 UI，第三个开发人员负责 API 端点。与其推进到 master 或一些笨拙的中间分支，不如推进到 develop 分支，优雅地合并每个人的变更，这不是很好吗？

这个过程被称为 [Gitflow](https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow) ，使用一个`develop`分支来构建特性，一个`master`分支用于面向用户的代码。其他流程包括进一步的分支阶段，如`staging`分支，用于在代码合并到`master`分支之前测试和验证代码。

在 Git 中建立这个流非常容易。只需保留默认的`master`分支，将其视为生产分支，并从`master`中签出一个新的`develop`分支，以继续前进。还要确保对项目的所有拉请求都是针对这个分支而不是主分支的！大多数情况下，唯一需要掌握的 PR 应该来自开发分支本身。

## 分支最佳实践

如果你以前参加过研讨会或基础 Git 教程，你可能会给分支起个名字，比如`Ben-Holmes`、`bug-fix`或`homepage-57`。**请不要这样！**

一般来说，试着给分支命名，就像给你自己一个首要的任务。因此，它应该有足够的描述性，让你确切地知道你在做什么，但保持在 5-7 个单词或更少，这样对队友来说不是不可能的。此外，一个分支的范围应该更加集中而不是宽泛，这样你所有的提交都是为了一个共同的问题。这有一个额外的好处，在你编码的时候可以避免一些小的“支线任务”。如果你在页面上看到一个与你正在做的事情无关的拼写错误，不要在你当前的分支中修复它！

### 格式化

当然，您可以使用最适合团队的方式，但是一个可靠的做法是:

1.  以您的名字或您的 Git(hub、lab 等)用户名开始分支名称。这使得以后更容易回来找到你的分支。
2.  包括您的分支机构解决的问题编号。如果你的建筑没有附加问题(不要经常这样做！)，在您的分支机构试图解决的问题上使用简短的标签。这可能是`feature`、`bug`、`poc`等。
3.  添加一个 4-5 个字的标题，说明你的分支机构做什么。您可以使用破折号、下划线或大小写来分隔单词。
4.  使用一致的字符来分隔所有这些👆像一个点或一个破折号。你也可以使用斜线，但是这可能会产生一些意想不到的后果！

### 我们来看一个例子

假设您正在处理一个标题为" **#154** :将个人资料图片编辑添加到“我的帐户”页面的问题顾名思义，你在用户的账户管理页面上添加了一个选项，当用户点击图片时，你可以编辑他们的个人资料图片。这里有一个合适的分支名称:

```
git checkout -b pr0H@ck3r.154.my_account_edit_profile_pic 
```

Enter fullscreen mode Exit fullscreen mode

是的，对于一个简单的分支机构名称来说，这是一个非常严格的结构。然而，当在给定时间有几十甚至几百个分支打开时，它确实提高了扫描能力！

## 提交最佳实践

今天结束了。你喝完了第三杯咖啡，并最终消灭了一个花了几个小时才找到的网络浏览器漏洞。现在，您已经准备好推进您的更改，并最终关闭您的计算机。那么，与团队交流你所经历的痛苦和磨难的最佳方式是什么呢？

```
git commit -m "fixes" 
```

Enter fullscreen mode Exit fullscreen mode

😓☕️井...肯定不是这个。提交消息不是一些没有人会看的被丢弃的文本块。这是开发人员解释他们的代码要完成什么的机会，因此当一个同事梳理您所做的更改的日志时，他们将能够一步一步地提交并跟踪哪些更改值得添加。这对于偶尔的回滚来说是非常宝贵的，当超出某个提交的更改应该被丢弃时。

### 写好提交消息

那么，如何充分利用提交消息呢？首先，最好用一些动词来描述向项目添加提交将会完成什么。这通常是一个现在时态短语，如“添加”、“修复”或“包含”

接下来，用一个简短的短语来描述提交的目的，通常不超过 50 个字符。如果您使用 VS 代码，内置的 commit 菜单(侧边栏中的第三个按钮)会为您做这项检查。这个限制应该是对您自己的一个检查，看看提交的内容实际上有多集中。例如，如果您正在为 Internet Explorer 中一个不合适的个人资料图片提交一个错误修复，一个可靠的消息可能是:

```
git commit -m "fix profile picture position on homepage IE" 
```

Enter fullscreen mode Exit fullscreen mode

### 间隔提交

是的，这是一个非常简单的例子。提交可以轻松跨越更多的文件和更多的特性。总是尽可能地在字符限制内，但是如果有太多要解释的，可能值得将提交分成更小的块。

起初这听起来令人生畏，但是当您准备提交所有内容时，Git 为此提供了一个方便的工具:`git add -p`。这允许您逐个文件地遍历您对代码库所做的每个更改，为您提供了在每个步骤进行分段的选项，而不是一次分段所有的更改。以下是存放一些 ESLint 配置文件的示例输出:

[![Example output of git add -p](img/e6a5fea18b484e636437fe730844f3d1.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--dICznVm4--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/7im4h1ai8ypah5prj31y.png)

这里，我们看到一个添加到文件`package.json`中的脚本，以及许多响应暂存的方法。如果你不确定这些随机的字母是什么意思，只要输入“？”。

对于较大的提交来说，这可能是一个乏味的过程，但是对于刚开始使用 Git 的人来说，这是非常有用的。像疯子一样提交也是最安全的做法，这样你的改变很容易被总结，你也不会经常羞愧地走完这一步。

*扩展阅读:这一节的大部分内容来自经验和各种堆栈溢出来源，但是[这](https://who-t.blogspot.com/2009/12/on-commit-messages.html)是一篇关于高质量提交消息的很好的长篇阅读。*

## 拉式请求最佳实践

到目前为止，我们所谈论的关于 Git 的一切都是非常标准的:你通读一个问题，你创建一个分支，你向它提交代码，你向上推它。在这一点上，很容易将所有事情都推到开发分支，然后就到此为止...但是等一下！如果你在一个团队中工作，最好在合并之前让其他人检查你所做的更改。

拉取请求的第一个最佳实践是...去做吧🤷每当一个问题被你创建的分支解决，你的改变被推进，就制造一个公共关系。

不可否认，从终端实现这一点没有很好的方法，所以直接从 GitHub 实现可能是最简单的。请注意，PR 的目的是允许其他人在合并到另一个分支(通常是开发分支)之前审查您的变更，所以请确保**您已经将远程`master` / `develop`分支重新基于您的**分支，以使审查变更更容易一些。

*注意:如果您不熟悉重定基础，它本质上是合并，但是对提交历史进行了调整。使用 rebase，remote 中的所有提交都将放在您自己的提交之前，使您的分支看起来像是建立在新的 remote 之上。[这篇文章](https://medium.com/datadriveninvestor/git-rebase-vs-merge-cc5199edd77c)有一个很好的视觉辅助来展示它是如何工作的。*

发出拉取请求后，添加人员进行审核，以便他们会收到通知。通常最好是联系那些没有和你一起改变的人，这样他们可以用一种全新的眼光来审视你的方法。然而，如果你[是结对编程](https://www.agilealliance.org/glossary/pairing/)的粉丝，在与你的搭档进行了充分的交流后，有可能绕过审查过程。

[![Example of a good pull request](img/c9c697abcd70718284c6c8116c3eee27.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--CVja2of2--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/srgwp1ttv0ho7fetgxmb.png)

这是一个我认为是好的拉取请求的例子。首先，请注意团队领导被请求进行评审(在“评审者”部分显示为复选标记)。还要注意注释框提供了分支中所做变更的详细分类。这可以按照您选择的方式来构建，但最好至少:

1.  包括问题编号，以便读者可以参考正在解决的问题
2.  写下每一个添加的特性或为解决一个 bug 而做的改变的项目符号/编号的细目分类

在此之下，有一个在请求合并的分支中进行的每个提交的日志。这表明高质量的提交消息是多么重要！

## 感谢阅读！😊

我是一个前端培训中的网站开发人员，总是在修补一些东西。我会试着定期在这里发帖，所以如果你喜欢的话，欢迎关注！