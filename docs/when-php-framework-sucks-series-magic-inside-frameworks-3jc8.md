# 当 PHP 框架吸收系列:框架内的魔法

> 原文：<https://dev.to/damnjan/when-php-framework-sucks-series-magic-inside-frameworks-3jc8>

在我的“当 PHP 框架糟透了”系列中的所有主题中，这一个可能是最让我恼火的。不是因为我对注释和配置的风格或标准有特殊的问题，而是因为我无法重用代码，并期望在任何其他环境中有相同的行为。我说的“框架魔法”是什么意思？我更喜欢抱怨这四个神奇点:

1.  在方法或类注释中定义代码
2.  在 yaml 或任何不同于的文件中定义类实例。服务器端编程语言（Professional Hypertext Preprocessor 的缩写）
3.  yaml、XML 或任何其他文件中的所有配置
4.  “包含”任何东西的容器

#### 在方法或类注释内定义代码

我们倾向于经常使用注释来定义方法属性。我最近在控制器的每个动作上面看到了 swagger 的完整文档。天啊，它太长了，以至于我无法将它放入我的屏幕高度。超过屏幕高度的符号！那是一级红色警报。长符号不仅难看，还会产生太多噪音，妨碍您看到实际的代码。在符号内部看到验证也是很常见的。我非常不同意这一点。首先，如果你改变验证库，在其他地方重用你的代码，验证库变得过时或者类似，你将会在你的方法上面得到无用的字符串。相反，使用一些值对象来验证特定的数据类型，尝试在每个方法中强制使用强类型。

```
/**
 *@library I‘m the useless piece of comment if you change the library hehehehe
 */
public function someMethod()
{
} 
```

Enter fullscreen mode Exit fullscreen mode

#### 在 yaml 或任何不同于的文件中定义类实例。服务器端编程语言（Professional Hypertext Preprocessor 的缩写）

非 PHP 文件中的类实例是非常有问题的，如果你想在你的 IDE 中遵循执行行，然后你会发现一些类是一个死胡同。这个类并不像它看起来那样是一个死胡同，有一个实例化它的代码，但是它在 yaml 中。等等，YAML？？？
没错，我多次看到我们必须定义为“服务”的类的声明，例如，在 XML 或 yaml 文件中。

#### YAML、XML 或任何其他文件中的所有配置

通常，yaml 文件中的配置让我很恼火。我知道它给人们带来了一些可读性，但我总是想，为什么不简单地用 php 呢？不需要解析，不需要预热。

#### 容器里面“装”着什么东西

这一条是错误的，至少从两个角度来看是这样。视角一，容器返回类型是什么？容器可以在 get 方法调用(或类似名称)时返回任何类型、任何对象或属性。以上帝的名义，我怎么知道？既然我不知道对象的类型，我怎么能对它调用任何方法呢？

```
public function testAction()
{
    $something = $this->container->get('hehehehe_you_newer_know_who_I_am');
} 
```

Enter fullscreen mode Exit fullscreen mode

第二个问题是，容器违反了这样一个硬性的“界面隔离原则”即固体原则中著名的“我”。您的控制器或任何其他可以访问容器的类在这一点上知道太多事情。

#### 结论

符号是注释，你可以用它来指定一些方法属性，但是要小心。如果您试图找到 yaml 中定义的类的用法，祝您好运！对 yaml 和 XML 配置有不必要的解析。控制器和其他容器感知对象知道的太多，但是你不知道容器返回什么。