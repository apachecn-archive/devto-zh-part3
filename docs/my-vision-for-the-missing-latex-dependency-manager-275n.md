# 我对缺失的 LaTeX 依赖管理器的看法

> 原文：<https://dev.to/fpolster/my-vision-for-the-missing-latex-dependency-manager-275n>

## 摘要

在这篇文章中，我声称 LaTeX 开发人员的体验可以通过学习和复制编程语言来提高。尤其是自动化的包管理(包括基于`\usepackage`指令的自动包获取)将是一个巨大的收益。

## 我对 LaTeX 的用户体验

TL；速度三角形定位法(dead reckoning)

*   我不应该一个接一个地手工安装我的文档需要编译的包。这应该是自动化的。
*   Tex Live 安装程序问了太多问题。
*   LaTeX 编译器不是用户友好的

我是一名 Linux 用户，在大学作业中使用 LaTeX。我通过发行版的软件包管理器获得了 texlive。安装 Texlive 是一个大约 2GB 的累积下载。从一个同学那里拿到了现成的乳胶模板。我查了 pdflatex。它发现一些。sty 文件找不到，进入了一些奇怪的交互模式。我想出了如何永久防止这种奇怪的交互模式，这样编译器就会在出错时终止。然后，我必须手动安装提供所有。我的系统上没有的 sty 文件。

这两个是我想指出的前两个问题。用户不应该面对编译器的这种奇怪的交互模式。交互模式最糟糕的地方就是退出好难(是 Ctrl+C，q，退出还是退出？).包的检索也应该是自动化的。手动安装它们很繁琐。另一种方法是安装所有的 texlive-*包，这样就不需要手动安装了。但是下载量超过了 6GB...

然后我想在大学实验室的计算机上写我的论文。它没有通过发行版安装我的论文所必需的包。由于没有管理员权限，我无法定期安装它们。我可以做的是从 CTAN 手动下载这个包，并把它放到我的源代码路径中。

当时我不知道 texlive 可以独立于系统包管理器手动安装。我可以将 texlive 安装在我的主目录中，并使用 tlmgr 来安装所有的包。那会有用的。然而，最近尝试过之后，手动安装 texlive 也很繁琐:安装程序会给用户很多选择。安装位置、要安装的软件包集的大小以及许多其他不太相关的东西。此外，安装后，所有程序(编译器、tlmgr 等)都需要添加到 PATH 环境变量中，以便可以从命令行执行它。

## 编程语言中的依赖管理

程序员更喜欢使用库和框架，而不是从头开始编写任何东西，因为这种方法有许多明显的优点。依赖外部开发的代码有一些后果:外来代码需要在本地可用(取决于语言的类型)来构建或运行软件。不仅如此，外来代码还可能依赖其他库来执行其任务。手动下载、集成和设置外部代码及其依赖项非常繁琐。并且该过程需要对被设置来构建/运行该软件的每台新 PC 以及对依赖关系的每一次版本更新重复进行。

长话短说:大多数编程语言都有依赖管理工具。举个例子，让我描述一下 JavaScript 依赖管理器和构建工具 *npm* 为用户做了什么。

#### NPM

*   有一个在线注册/存储库，在那里发布库/框架(更一般的术语是“包”)。[http://npmjs.com/](http://npmjs.com/)
*   有一个 CLI 程序`npm`可以从注册表中查找、下载和更新软件包。
*   如果您使用 npm，您将文件 *package.json* 放在代码项目的根文件夹中。该文件提供以下信息:
    *   它有一个代码项目依赖的所有包的列表。您还可以指定包的版本。
    *   它有一个(构建)脚本列表。它们由脚本名称和 CLI 命令组成。
    *   不太重要的是，这个文件包含项目的所有元数据，以防您希望将项目发布为 npm 包。因此，您可以指定标题、作者、当前版本等。

当某个新人开始从事一个项目时，他们需要做的就是从版本控制中获取项目代码(只有内部代码和`package.json`文件在版本控制中——而不是外部依赖项),然后在根目录中运行`npm install`。这将读取`package.json`中的依赖项列表，从注册表中下载所有的依赖项，并将它们放到项目根目录下的一个目录中。

#### 乳胶应该从中学习和借鉴什么

LaTeX 很容易建立自己的自动化依赖管理工具。在 CTAN，我们已经有了一个在线的包裹注册系统。此外，LaTeX 已经有了描述文档依赖关系的方法:序言中的`\usepackage`指令。

我对 LaTeX 依赖管理器的设想是一个小程序，它读取主 LaTeX 源文件来自动安装所有需要的包。可以通过以下任何一种方式进行安装:

1.  如果系统上安装了 texlive，则使用该安装中的可执行文件。直接从 CTAN 下载文件要求但不存在的包到...
    a .项目中的目录
    b .位于用户主目录中的与项目无关的目录

2.  下载并安装 TeX Live。提供快速安装，即不要询问安装位置等。，使用相同的默认值。除了 absolut bare minimum，不要安装任何乳胶包。之后，使用 tlmgr 安装文档所需的所有包。不会了。有多种方法可以做到这一点:

    a.npm 风格:安装在项目目录中。
    b .安装在用户的主目录下。这对许多用户来说已经足够了，因为通常一台计算机只被一个人使用。
    c .为所有用户全局安装。这将需要摆弄管理权限。

3.  使用系统包管理器。我认为找到一种方法将包名映射到系统包管理器中的包名是可行的。

这些选项按难度递增排序。

## 建立管理

重温 NPM 构建脚本:对于一个典型的前端 JavaScript 项目，在 package.json 中定义了两个非常常见的脚本:
-一个`dev`脚本:这通常通过本地运行的 web 服务器为浏览器提供前端服务。它还监视项目中的文件是否有变化，并自动重新构建代码和重新加载提供的页面。
-一个`build`脚本:这将构建用于部署的项目。

通过从命令行调用`npm run <scriptname>`来运行脚本。

“构建工具”是自动化构建过程的程序的通用术语。我认为很多人使用 Makefile。LaTeX 文档的构建过程通常包括书目处理和最多三次 LaTeX 编译运行。此外，您可能希望执行一些操作来保持工作目录没有编译副产品。也许您正在用 Markdown 或其他标记编写文档主体，并且需要执行 markdown-to-LaTeX 翻译步骤。也许在构建过程中需要绘制一些数据。

TL；灾难恢复构建自动化几乎是常态。应该考虑这样一个问题:在一个可能的 LaTeX 依赖项管理器中包含一个构建脚本特性，从而将它变成一个像 sbt 和 Maven 一样成熟的构建工具，是否会有什么好处。也许 Makefile 也能很好地完成这项工作。然而，我想让 TeX Live 用户不必了解 TeX 编译器的 nonstop 模式。此外，在文件更改时自动重新编译的创作模式将会非常简洁。