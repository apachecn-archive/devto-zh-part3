# 作者标记的注释特性(MDL 日志#3)

> 原文：<https://dev.to/mortoray/a-comment-feature-for-author-markings-mdl-log-3-gfk>

第二个用户画像和故事的时间到了。我想写的东西太多了，也有很多用途，但我会试着一次添加一个。这有助于支持开发过程，并保持一切以用户和实际需求为中心。

像往常一样，接下来是代码的更新。

## User: Fionn

[![Image of person](img/11671059fbd1660116014a574947238b.png)](https://res.cloudinary.com/practicaldev/image/fetch/s--we3rYs5Y--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/gj7upvxev0ze42us3rcd.jpg)

Fionn 是一名 45 岁的内容作家。他住在一个农村社区，为各种出版物和内容提供商做远程自由职业工作。他写政治，以及任何内容代理机构需要的东西。

他的主要产品是 Word，其中他使用了简化的样式表。他使用样式来做标准标记，但也有自己的特殊注释样式。这些是他在发送给编辑之前必须手动删除的注释。他也会对不那么笨重的解决方案感到满意。因为他只处理文本，所以不需要任何格式特性；他把这留给了编辑。

我想帮助费恩工作。我认为改进后的减价会符合他的需要。嗯，短期内不会。他不太可能接受基于文本的解决方案。他更喜欢图形编辑器，因为他已经习惯了。也许我可以向他追加销售。相反，我将关注 web 前端可能使用的底层技术。

这里的关键特征是私人标记。这些听起来像源代码注释。我们可以在协作编辑工具等地方看到它们。我认为行内和段落标记都是有意义的。我将首先关注段落标记。注意:就用户故事分析而言，这是一个潜在的冲突。确定费恩真正需要什么是有意义的。

> 我个人对评论的需求是在文档中加入他们需要的不受支持的特性的注释。目前，这是记录这些日志的出版日期。

## 注释

注释听起来像一个非功能性的注释。它们是源文档的信息，但不会出现在输出中。但是它们会出现在编辑工具中。这是相关的，因为这意味着它们必须存在于 doc-tree 中并在往返过程中存活。这使得它们不像源代码注释那样可以被解析器尽快剥离。

我添加了以`//`开头的整块注释和以`/`开头的单行注释。单行终止于行尾。完整块像普通块一样被解析。两者都作为注释附加到下一段。此文档中有评论，但由于是评论，所以它们不会出现在此更新中。:)

## 重构

我已经简化了文档树结构。每个语义类型不再有一个类，而是只有一个类型为`class`的`Block`类。为了让事情更简单，我认为文档树将基于结构，而不是语义形式。这将导致 Python 类型大大减少，从而更容易处理。

但是它也有一些缺点。如果没有高级编码类型，一些处理器和发射器必须更加小心。退回到基本的段落类型也很容易——但是这是否是想要的还不确定。

目前，文档树看起来像是模仿解析树，很难理解为什么我们需要这种区别。对于到目前为止支持的特性，并不真正需要分离。随着我添加更多的功能，原因会变得更加明显。

* * *

*这是 [MDL 文档处理器项目](https://github.com/mortoray/mdl/)的开发日志条目。*