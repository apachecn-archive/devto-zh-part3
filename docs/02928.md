# 🏇提高 angulars 编译速度的简单技巧

> 原文:[https://dev . to/Marcel _ cremer/a-simple-tip-to-improve-angulars-compilation-speed-5dm 0](https://dev.to/marcel_cremer/a-simple-tip-to-improve-angulars-compilation-speed-5dm0)

你有没有一个大角度的应用程序，编译/服务/编译测试的时间太长？这件小事帮助了我:

### [](#increasing-the-node-process-memory)增加节点进程内存

默认情况下，一个节点进程最多可以占用 1，76GB 的 RAM。这是 Javascript 的原始设计，假设单个线程(节点拥有的)不会超过 2GB RAM。

然而，事情在过去几年变得有点复杂，因为 JavaScript 框架不断发展，允许将不同的库组合成一个框架，或者在我们的情况下——角度编译机制。

如果你的编译进程达到这个限制，节点垃圾收集器将开始与编译进程交替，释放足够的空间，以便 ngc 可以执行下一项工作。

如果你和我一样，你可能会想:**为什么 ngc 会超过这个限制？！？**

简短的回答是:因为它为你做了很多事情😃

好吧，说得具体一点:

*   它将资产捆绑到您的最终构建中
*   它在内存中保存了数百个文件来进行树抖动
*   它编译 scss 文件
*   它将块组织成模块/供应商块
*   它将经常使用的共享代码片段分成一个公共块
*   ...还有更多:)

那么我们如何摆脱这个*“空闲内存/多做一点工作/空闲内存”*-循环呢？

### [](#increasing-the-node-memory-limit-with-maxoldspacesize)用 max_old_space_size 增加节点内存限制

Node 有一个简单的标志，用于在垃圾收集器开始积极释放内存之前更改最大 RAM 消耗。你可以像这样使用它

`node --max_old_space_size=` *大小以 MB 为单位*

因为我的机器中有 24GB 的 RAM，所以将 8 GB 分配给节点进程没有任何问题。但是我也不想失去 ng cli 的舒适性，那么如何自动将参数赋给 ng 命令呢？

解决方案很简单，但可能不太明显:

我们使用节点脚本直接从 node_modules 文件夹中调用 ng cli。我把这个变种叫做**“nghm”***(针对 ng 高内存)*并把它建成这样:

`"nghm": "node --max_old_space_size=8096 ./node_modules/@angular/cli/bin/ng"`

记住这个脚本，我们可以将“ng serve”转换成

`npm run nghm -- serve`

这将消耗高达 8GB 的内存。生产构建可能看起来像

`npm run nghm -- build --prod --progress=false --aot=true --vendor-chunk`

**数字呢？**

这可能因项目而异，但在我的项目中，这种特殊的变化将编译时间从大约 3:26 分钟减少到大约 1:36 分钟(我从我们的 CI 系统中选择了两次，这是相当平均的——这里没有科学依据😉).

它可能会受到您的资产有多大、编译了多少文件等因素的影响，但是如果您苦于编译时间过长，就试一试吧。

*最初发表于[Marcel-cremer . de](https://www.marcel-cremer.de/ng-compilation-speed/)T3】*