# Python 命令行实用程序

> 原文：<https://dev.to/thefern/command-line-utility-with-python-2plj>

## 简介

什么是 CLI，或者我们为什么需要它们？我的工作是工业自动化和控制，有很多重复。备份这个，把这个文件夹复制到另一个文件夹，所有的机器都在 ping，运行这个 bat 文件，等等。当我们第一次学习如何做这些事情时，它们让我们着迷，但在第 1000 次之后，它们很快就会过时。使用图形用户界面执行其他任务需要很长时间，因此使用 CLI 工具会更快，尤其是如果您一天不止一次这样做的话。我不会讨论具体的任务代码，而是更多地讨论如何设计 CLI。

## 最初的想法

每当我一遍又一遍地重复一项任务时，或者如果我认为自动化会减少出错的可能性，我会为该任务或相关任务制作一个 CLI 工具。我的工作是尽可能地抽象，使工具可配置，并被其他人使用。使它可配置也可以帮助非程序员通过定制来帮助你调整它，所以这总是一个优点。

任何人都可以编写一个脚本来做一件事或几件事，但是如果你能设计一个其他人可以使用的脚本就更好了。即，将机器 X1 上的文件夹 A 复制到机器 X2 上的文件夹 B。这些是你脚本中的硬编码路径，这是一个很大的问题。在这种情况下，用一个 ini 文件来配置这些路径会更合适。(以此为例，是的，我知道你可以在大多数操作系统上不用脚本复制文件)

*   如果这些路径后来改变了呢？
*   如果你有另一个文件夹要复制呢？

你明白我的意思了吗？从长远来看，不得不一遍又一遍地修改剧本会让你头疼。配置 ini 文件统治世界。

## CLI 库

这些只是几个模块，当谈到 CLI 时，它们会使你的生活变得更容易，但有大量的模块取决于你试图完成什么。

*   argparse(用于参数)
*   configparser(用于 ini 文件)
*   进度(进度条)
*   pinging 咄！)
*   ftplib(连接到 ftp 站点)
*   日期时间
*   pathlib(对路径有用)
*   glob(查找带有模式的路径名)
*   shutil(复制文件操作)
*   子流程(产生新流程)
*   zipfile (zip 文件操作)
*   getpass(安全密码输入)
*   os(接口)

如果在没有安装 python 的环境中使用该实用程序，可以使用 pyinstaller 创建可执行文件。我在 pyinstaller 上使用 Python 3.4，上面的任何东西我都不能让它工作，在新的 Python 上花了很多时间，直到我在 3.4 上解决了 pyinstaller，就像你知道的那样。[问题详情](https://github.com/pyinstaller/pyinstaller/issues/3600)

## 设计

我设计 CLI 的方法是写下需求。做一点研究，看看有什么模块或库可用，这样我就不必写不必要的代码。然后我开始在测试的时候一点一点的削掉。通常 1.0.0 版本会有一些错误，所以我会分发给用户，然后等待反馈。经过几次迭代后，该工具将足够稳定，并且有望不再被重新编译或更改。

*   职能是按职责划分的
*   菜单
*   配置
*   错误日志
*   异常处理
*   给用户的反馈(进度条和结果)
*   通过 settings.ini 自定义

## 异常和错误

设计 CLI 的一个非常重要的步骤是处理异常和错误。就信息而言，你需要向用户展示什么。需要记录到 log.txt 文件中的内容是您需要做出的非常重要的决定。什么可能使你的程序崩溃，想想你的用户可能给出错误的输入或错误的 ini 设置。

## 反馈

向用户显示反馈是另一个重要的步骤。许多人似乎认为因为是 CLI 反馈就不那么重要。用户应该总是知道发生了什么。当涉及到 CLI 中的用户反馈时，过去的时间、当前时间、进度只是需要考虑的几个项目。

## 结论

请告诉我您对 CLI 工具的看法:

*   你在工作中使用它们，并且喜欢使用它们吗？
*   是你做的吗？
*   不要用它们，不要在意我喜欢 GUI 的。