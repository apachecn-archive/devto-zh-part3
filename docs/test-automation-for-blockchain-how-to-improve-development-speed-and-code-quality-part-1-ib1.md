# 区块链测试自动化——如何提高开发速度和代码质量，第 1 部分

> 原文：<https://dev.to/4miners/test-automation-for-blockchain-how-to-improve-development-speed-and-code-quality-part-1-ib1>

*Today we will discuss the importance of software testing in blockchain, outline benefits of automation testing and explain how to get involved in the Quality Assurance of our open source project. This is part one of the two-part blog post.*

许多区块链项目在达到初始生产状态后并没有持续很长时间。对大多数人来说，缺乏适当的软件测试是他们死亡的主要原因之一。据估计，仅去年一年就有超过 5 亿美元的加密货币因错误代码而丢失。你可能听说过[DAO 的代码漏洞](https://medium.com/swlh/the-story-of-the-dao-its-history-and-consequences-71e6a8a551ee)，它允许攻击者从基于以太坊的智能合约中流出 360 万 ETH(当时价值 7000 万美元)。另一个臭名昭著的案例是[奇偶错误](https://elementus.io/blog/which-icos-are-affected-by-the-parity-wallet-bug/)，导致超过 1 . 5 亿美元被永久冻结。甚至比特币本身也不能幸免于黑客攻击。去年年底，代码中发现的一个漏洞允许恶意个人通过双重输入人为增加比特币的供应量。如果这个漏洞没有被迅速发现和解决，它可能会对网络造成灾难性的影响。这只是冰山一角——还有许多由缺乏经验或粗心的开发人员造成的小事故没有成为头条新闻。

这告诉我们什么？在开发过程中，事情可能会很快出错，结果可能会很糟糕。这就是为什么软件测试对于任何利用区块链技术的项目都是如此重要，比如区块链平台、区块链应用程序或区块链服务。

在本文中，我们将讨论我们在开发区块链应用平台 [Lisk](https://lisk.io) 时的软件测试经验和最佳实践。我们还将向您展示实现自动化测试是如何改进我们的内部工作流程和代码可靠性的。最后，我们将向您展示如何参与测试我们的开源软件。

这是一篇很长的博文，但是我们已经为你把它分成了小块。

第一部分:

1.  *区块链和 Lisk 简介*
2.  *什么是软件测试？*
3.  *测试区块链应用为传统软件测试增加了新的指标*
4.  *为什么区块链开发商需要更加关注细节*
5.  自动化测试可以大大减少发布过程
6.  *不同类型的自动化测试*
7.  *持续集成(CI)是自动化测试的最佳实践*
8.  *挑哪个 CI 平台？特拉维斯 CI vs 切尔莱西 vs 詹金斯*

第二部分:

1.  *软件测试是不够的——引入质量保证*
2.  *手动测试如何减缓我们的软件开发过程*
3.  *我们如何在 Lightcurve 实施质量保证*
4.  *QA 团队到位的结果*
5.  *我们区块链网络的质量保证测试流程*
6.  *参与我们的开源自动化测试*
7.  *如何开始为我们的质量保证做出贡献*
8.  我们可以为您提供哪些 QA 工具？

## 区块链和 Lisk 简介

你可能听说过比特币等加密货币背景下的区块链，但是是什么让这项新技术如此特别呢？[区块链](https://lisk.io/academy/blockchain-basics/what-is-blockchain)，是一种分布式账本技术(DLT)，是一种开放的分布式数据库，能够以高效、可验证的方式永久记录各方之间的交易。那些交易被打包成块，[加密地](https://lisk.io/academy/blockchain-basics/how-does-blockchain-work/blockchain-cryptography-explained)——签名并形成实际的链。存储在区块链的数据不能被更改或篡改，因为所有的记录都是[不可变的](https://lisk.io/academy/blockchain-basics/benefits-of-blockchain/why-is-blockchain-trustless)。数据一旦保存到分类账中，就永远保存在那里。区块链也是一个分散的网络，这意味着没有一个中央权力机构来控制它。

人们很容易对区块链感到兴奋，但是在它的基础上开发一个工作产品却非常困难。出于各种原因，区块链开发者似乎仍然是程序员中的稀有品种，包括所需的陡峭学习曲线。Lisk 计划正面解决这些问题，让每个开发人员都能轻松地用 JavaScript 构建和部署[区块链应用程序。Lightcurve 是一家位于德国柏林的区块链产品开发工作室和咨询公司。我们目前专注于开发 Lisk 的所有方面，包括产品、营销、社区和设计。](https://lisk.io/products)

## 什么是软件测试？

基本上，软件测试被定义为一系列的活动，这些活动可以保证软件按照预期的方式运行并且没有错误。适当的软件测试过程将帮助您识别和防止错误，确保特定功能的实际实现与需求相匹配，并增加对代码的总体信心。

### 测试区块链应用为传统软件测试增加了新的指标

测试区块链应用程序与测试非区块链应用程序没有太大区别。但是，使用区块链时，会涉及额外的测试指标，例如:

*   **链条尺寸**。区块链越长，包含的数据就越多。这导致数据存储区占用更多空间。该链可以增长得非常快，并且其实际大小没有限制，因为新的块会不断添加。我们需要知道在一定时间内存储在链上的最大可能数据量。通过这种方式，我们可以估算出一台区块链能占用多少空间，比如一年后。
*   **区块链的吞吐量**是通过计算每秒的事务数(TPS)来衡量的。较高的 TPS 总是更好，但它会增加整体网络负载，并且不是每个节点都能够赶上。TPS 作为[可伸缩性](https://www.codementor.io/blog/blockchain-scalability-5rs5ra8eej)的一个因素，是区块链行业的一个挑战和热门话题。许多项目盲目地追逐 TPS，而没有关注其他更重要的性能指标。这经常导致项目变得不那么[分散](https://lisk.io/academy/blockchain-basics/benefits-of-blockchain/what-is-decentralization)，这反过来否定了区块链的意识形态。
*   **安全和加密**。需要不断地审查和审计代码，以确保在创建新令牌、维护帐户余额、验证块或交易签名方面没有缺陷。
*   **数据完整性**保证区块链上存储的所有数据在网络[节点](https://lisk.io/academy/blockchain-basics/how-does-blockchain-work/nodes)之间是一致的。这由块和事务的加密来保证。然而，一些区块链应用程序在内存或助手数据库中计算和维护状态(例如实际账户余额),以确保数据的一致性。除了直接在节点之间比较数据之外，没有其他方法。
*   **数据传播**是将数据从一个节点分发到另一个节点。一个分散的网络可以由成千上万的节点组成，所有这些节点都需要保持一定数量的相互连接。当一部分数据到达一个节点时，需要将其无中断地转发到整个网络。这种传播所花费的时间是一个重要的指标。

### 为什么区块链开发者需要更加关注细节

如果一个 bug 被引入到一个集中式系统中，提供一个修复会相对简单。即使它损坏了一些数据，也更容易纠正。这是因为在大多数情况下，维护应用程序的公司对数据有完全的控制权。鉴于区块链是不可变的分类账，损坏的数据即使不是不可能纠正，也是难以置信的困难。使过程更加复杂的是，交付修复需要与分散网络的所有参与者进行协调。使用 Lisk，我们必须与数百个节点操作符以及我们的 [DPoS 共识算法](https://lisk.io/academy/blockchain-basics/how-does-blockchain-work/delegated-proof-of-stake)中称为代表的块生产者协调每个版本。考虑到所有这些情况，区块链应用程序中的错误的后果可能比集中式软件中的更危险。

> 在发展过程中，事情可能会很快出错，结果可能会很糟糕。

### 自动化测试可以大大减少发布过程

既然我们已经讨论了测试在区块链项目中的重要性，我们可以根据我们执行测试的方式来划分实际的测试:

*   **手动测试**由 QA/测试工程师执行，在一些测试场景尚未迁移或准备好以自动化方式执行时非常有用，比如新特性。然而，由于各种原因，包括难度、时间和预算限制，并不是所有事情都可以这样做。总的来说，手工测试是最耗时的方法。
*   **自动化测试**是持续交付的基础。它是一种开发方法，允许开发团队安全地将变更部署到生产中。持续交付使开发人员能够快速发现错误，并帮助团队满怀信心地交付新版本。对于复杂的应用程序，自动化测试可以将发布过程所需的时间从几个月或几年减少到几天甚至几个小时。投入时间来实现高质量的测试套件可以极大地提高开发人员的生产力。然而，它需要一些努力来实现和维护测试场景以及执行它们的基础设施。

## 不同类型的自动化测试

我们可以区分几种类型的自动化测试，比如单元测试、集成测试和功能测试。然而，在一些现有的测试套件中，这些类型相互混淆，它们之间完全没有区别。这使得测试套件不太适合任何特定的东西。对于开发人员来说，理解不同类型的测试非常重要，因为每种测试都有其独特的作用。

*   **单元测试**作为开发人员的快速反馈机制和开发过程中的“第一道防线”。在单元测试中，特定的代码单元(功能)是用模拟输入相互独立地测试的，主要的焦点是测试单元中的逻辑。这意味着 I/O 操作(如文件访问、Ajax/RPC 调用、DOM 交互)、定时器和昂贵的函数(加密)通常是伪造的。
*   **集成测试**是一种针对单元中模拟依赖关系的协议变化(例如参数顺序)的防御机制。在集成测试中通常避免存根，并且测试单元之间的实际交互。因此，集成测试比单元测试更昂贵。
*   **功能测试，**套用[埃里克·埃利奥特](https://medium.com/javascript-scene/mocking-is-a-code-smell-944a70c90a6a)的话，通常被认为是集成测试的子集，因为它们一起测试应用程序的所有部分(在运行应用程序的上下文中)。

> 对于复杂的应用程序，自动化测试可以将发布过程所需的时间从几个月或几年减少到几天甚至几个小时。

### 持续集成是自动化测试的最佳实践

持续集成(CI)是一种软件开发实践，它依赖于频繁地将代码集成到共享存储库中。每当团队成员向版本控制提交一些代码变更(例如 Git)时，构建和测试代码的自动化过程就会被触发。开发人员被鼓励在完成每一个小任务(修复一个问题，实现一个特性)后提交他们的代码和测试(单元，功能，集成)。自动化构建系统从共享存储库中获取最新版本的代码，并在需要时应用更改。然后，它对它执行所有预定的动作，比如执行测试。CI 被认为是最佳实践，因为软件开发人员需要将他们所做的所有更改与开发团队其他成员所做的其余更改集成在一起。它有助于避免合并冲突、困难的错误或重复的工作。这是因为 CI 迫使代码不断地合并到一个共享的版本控制分支中，允许他们更早更容易地识别可能的问题。它还最大限度地减少了花费在调试上的时间和代码审查所需的时间，允许开发人员将更多的精力放在添加功能上。

### 选哪个平台？:特拉维斯·西对切尔莱西对詹金斯

目前可用的几种流行的 CI 平台在功能和灵活性方面各不相同。其中一些是免费的。对于其他人，你需要付出。

*   [CircleCI](https://circleci.com) 非常容易上手。有一些可用的免费计划，但有一些限制，如 1 个容器的 1 个并发作业，没有并行性。这是一个基于云的工具，所以你不需要自己托管基础设施。它有各种集成，如 GitHub，Slack，吉拉等。初始设置非常简单，他们有很好的客户支持。
*   [Travis CI](https://travis-ci.org/) 与 CircleCI 非常相似，然而，Travis CI 更加灵活。它允许你同时在 Linux 和 Mac OS X 上运行构建和测试，并且支持更多的语言(他们甚至为他们提供了教程)。对于开源项目是免费的。
*   Jenkins 是领先的开源自动化服务器，也是最灵活的服务器。您需要自己托管它，所以最初的设置和后期的维护需要更多的努力。Jenkins 允许您完全控制构建的任何方面。它也可以使用插件来扩展，现在已经有数百个可用的插件了，所以你可以把它和任何你想集成的工具集成在一起。虽然在小项目中使用 Jenkins 可能有点矫枉过正，但是对于大项目来说却是非常好的。

如果您想更详细地比较 CI 平台，在 [Stackshare.io](https://stackshare.io/stackups/circleci-vs-jenkins-vs-travis-ci) 上有一个非常好的比较。

这就是第 1 部分！查看本演练的第 2 部分，了解质量保证的重要性，我们在实现自动化测试方面的经验，以及参与区块链 QA 测试的链接。