# 大规模重写

> 原文:[https://dev.to/rhymes/a-big-rewrite-5gl5](https://dev.to/rhymes/a-big-rewrite-5gl5)

民间传说和常识警告开发人员和团队不要进行大的重写。

## [](#to-do-or-not-to-do)做还是不做

有很多理由不从头开始重写应用程序:

*   重写需要时间
*   “遗留”应用程序仍然需要支持，可能还需要调试
*   重写完全相同的应用程序希望改变结果可能是疯狂的早期迹象
*   从开始到结束，需求肯定会发生变化
*   该公司已经为“legacy”应用程序付费，现在你想让它为同样的事情付费两次
*   管理层可能很难被说服

如果重写是合理的，也有一些积极的方面:

*   花在重写上的时间是你将会学到很多东西的时间
*   “遗留”应用程序已经变成了垃圾火(因为更替、功能蔓延、糟糕的设计、缺乏专业知识、土星在对立面等等)，并且正在放缓增长
*   即使你这么想，你也不会重写完全相同的东西
*   需求的变化可能会产生不同的、更好的产品
*   如果你不是一家初创公司，那么“传统”应用通常会资助重写
*   如果你们都能成功做到这一点，管理层和你们的同事在未来几年将会非常信任你们
*   你只需要删除一个文件夹就可以摆脱所有的技术债务(并且你可以创建新的债务:-D，但是我们不要挑剔)

## [](#why-im-writing-this)我为什么要写这个

前几天，我读了两篇关于成功的“大改写”的“旧”帖子。

在第一部《逆天而行:我们如何利用亚马逊、Clojure 和一个滑稽的小团队建立下一代在线旅行社》、[科林·斯蒂尔](https://www.linkedin.com/in/cvillecsteele/)讲述了一个从一大堆将使公司陷入困境的科技债务到一个成功的再造产品的旅程。在争斗中会犯错误...从另一家公司成功收购。

该产品是一个酒店元搜索引擎。

## [](#the-bulk-of-their-story)他们故事的大头

### [](#premise)前提

*   他们最初的商业模式是错误的(这在初创公司中很常见，至少以我的经验来看)
*   这个应用程序是一个巨大的 PHP 的意大利面条，可能由许多人共同开发
*   数据库一片混乱
*   没有测试
*   他被聘为顾问，并使用 Ruby 和异步编程提取了一个关键特性，但在他看来，其余的都太远了

### [](#preexecution)预执行

*   他成为了这家公司的首席技术官，并说服管理层尝试进行改革
*   他们解雇了大部分现有的开发人员，只雇佣了少数资深人员(这是另一个在损失控制领域的创业公司中常见的主题，它们正在消耗资金)
*   他们在保持旧产品运行的同时开始重写
*   他们从托管服务器转向云(请记住，这发生在 2010 年)，这很有说服力

### [](#tech-choices)技术选择

*   前端开发人员用 vanilla JS 编写了一个 SPA(还是在 2010 年)
*   经过彻底的测试和一些尝试后，他们选定了 Clojure(即使他是 Ruby 专家)。Ruby 被放弃了，因为它需要更多的资源来扩展，而他们没有，还因为它内置的并发模型
*   Clojure 是他们的正确选择。正如他所写的:*作为一家资金短缺的初创公司的首席技术官，Clojure 是一个祈祷的答案。*
*   Clojure 可能比平时更容易销售，因为他们的时间和资源非常紧张，管理层非常信任团队(想象一下，在 2010 年，这在 2018 年可能是一次销售)
*   他们拥有的 web 应用程序类型和他们执行的性能测试证明了这一选择的合理性(并为公司节省了资金)

### [](#post-execution)后执行

*   它们是在 2011 年底收购的
*   他们做出的所有技术选择都受到了质疑(为什么是 AWS，为什么是 Clojure)
*   他说，他们能够向新公司“推销”Clojure 的选择，因为它位于 JVM 之上，也因为他向他们展示了关于系统性能的漂亮图表

### [](#end-of-the-story)故事结束

从第二篇文章开始，[使用 Clojure 和 AWS 在 7 个月内增长了 60，000%](http://www.colinsteele.org/post/27929539434/60000-growth-in-7-months-using-clojure-and-aws)

> 在过去的 7 个月里(我们于 2012 年 1 月推出)，我们在 hotelicopter 网站上的点击率从每天 1，000 次上升到每天 600，000 次以上。这意味着 7 个月内增长了 60，000%

所以，重写得到了回报。

另一件需要注意的事情是管理层对他和团队的信任度。如果没有这些，重写可能会失败，或者他们会花光所有的钱，或者他们不得不进行增量重构，这可能会花费更多的时间。我们永远不会知道。

如果你想了解更多关于技术选择和筹码的信息，请阅读第二篇文章。

## 我写的一篇独唱重写本的摘录

我曾经被雇佣去开发一个不可维护的程序，这个程序必须重写。

巧合的是，它也是用 PHP 编写的，而且它的数据库结构也需要夏洛克·福尔摩斯来破译。我花了至少一周的时间盯着 MySQL 表，这些表有着神秘的名称和神秘的字段，搜索 PHP 函数来找出数据发生了什么(大部分数据库逻辑都在应用程序中)，并设计一个新的数据库。

我最终用 Python 在短时间内重写了应用程序(并迁移了数据)。:D 成功了

但是范围更小，我没有选择去证明，他们需要一个有专业知识的人来将一个遗留的应用程序带到一个已知的堆栈中，然后移交它。

这种重写的好处是最终不需要以前的堆栈知识，我很高兴大部分忽略了应用程序代码，并能够专注于要带来的数据和需求。

现在我正在写这篇文章，我认为“遗留应用”也可以作为一个论点，支持在小公司工作的经验较少的开发人员的框架，在小公司他们可能没有资深人士每天与他们互动。但是我跑题了。

## [](#conclusions)结论

请记住，完成重写并没有单一的方法，你可以通过重构和重写的混合来完成，关于这一点的更多内容，我请 [@bosepchuk](https://dev.to/bosepchuk) :

[![bosepchuk](../Images/4a2750bf6275f976448741ffad56eee7.png)](/bosepchuk) [## 重写与重构之争:你需要知道的 8 件事

### Blaine Osepchuk 3 月 26 日 189 分钟读数

#refactoring #softwareengineering #projectmanagement](/bosepchuk/the-rewrite-vs-refactor-debate-8-things-you-need-to-know-2hi4)

如果你想读另一个成功的故事(看起来没那么疯狂)，读读这个由 [@jcreenaune](https://dev.to/jcreenaune) 写的:

[![Atlassian](../Images/1deb978a7154f405c03e60f105df6e25.png)![](../Images/4b646317a00012c59532d2b7a7f8c3a3.png)](/atlassian) [## 我运行了一个复杂得可笑的工程项目(并幸存了下来)

### jcreenaune for Atlassian Dec 12 ' 18 14min read

#cloud #projectmanagement #developers](/atlassian/i-ran-a-ludicrously-complex-engineering-project-and-survived-2a54)