# 为什么干净的代码是移情的代码

> 原文:[https://dev . to/Karen _ p white/why-clean-code-is-empathional-code-2lkn](https://dev.to/karen_pwhite/why-clean-code-is-empathetic-code-2lkn)

*最初发表于 [BigCommerce 开发者博客](https://medium.com/bigcommerce-developer-blog)。*

写这篇文章的想法始于一次啤酒聚会。

在一个周五的欢乐时光里，我正和 BigCommerce 软件工程团队的负责人丹·穆雷尔聊天，话题转到了丹最近在做的一个项目上。他告诉我他是如何顺利地进入一个项目的开发阶段，结果却转身重新开始。他已经意识到，除了他自己，任何人都无法破译密码，正因为如此，需要进行航向修正。不仅仅是因为他觉得质量没有达到他的标准，也是为了将来被分配到这个项目的工程师。他目前正在改造项目，根据一套指导原则组织代码，这套指导原则旨在让其他开发人员在最短的时间内轻松理解代码的作用。

这个想法引起了我的兴趣，因为这是开发人员发现自己处于两方面的事情。在不同的时候，我们可能是继承了意大利面条式代码库的人，或者，不管我们愿不愿意承认，我们可能是创建它的人。丹指出，在整个生命周期中，一个项目会易手多次。每个所有者都有机会让事情变得比他们发现时更好，或者制造一个巨大的混乱，让未来的开发商诅咒他们的名字。

我想更多地了解 Dan 是如何看待编写干净易读的代码的，所以我再次会见了他(这次没有啤酒),以更深入地挖掘对未来的程序员来说以同理心编写代码意味着什么。

## [](#a-life-of-its-own)一个自己的生命

首先要明白的是，大多数软件的寿命远远超过了创建它的最初开发者。

“事实是，如果你为一家公司做任何种类的软件，它几乎肯定会比你预期的持续更长时间，”丹说。但是知道你的代码将继续存在并被传递给多个所有者会改变你对你写的代码的想法。“你的倾向是让你写的代码个性化，你把你所有的经验都放进去。但你不会是唯一一个从事这项工作的人。”

无论你在哪里写软件，很少有机会从一开始就设计出解决方案。更常见的情况是，您正在使用自己继承的代码库:或者是您自己公司内部的遗留代码库，或者是其网站已经在您之前经过多个开发人员之手的客户。处于代码库的列车残骸的接收端，让您直接接触到忽略干净代码最佳实践的后果。

Dan 回忆道:“我在一家机构工作了五年，我参与的第一个项目是在公司从零开始的，但最初的开发人员已经离开了。他没有使用最好的实践，然后这个项目在我之前又经过了三个开发人员。我们开始向它添加新的功能请求，我们必须了解这个东西是做什么的，因为现在我们必须添加新的功能来处理现有的功能。不可避免的是，我们不得不重写大量的代码，因为也许这些代码已经过时了，或者不起作用了，或者一开始就不起作用了。大概是我在那家公司的第一年，它真的只是让我自己适应这个庞大的代码库。”

Dan 在接下来的半年时间里进行了重构，添加了所需的新特性。随着代码库的清理，曾经看似不可能构建的新功能突然变得简单明了。

> “我不得不后退一步，认真考虑发生了什么。我们所做的重构工作使这一特性成为可能。这并不容易做到，只是在我们投入了所有工作之后才容易做到。”

## [](#why-good-developers-write-bad-code)为什么优秀的开发者会写出糟糕的代码

如果我们假设开发人员是好意，为什么会有这么多难以辨认的代码呢？糟糕的开发者真的有那么多吗？

一点也不。事实是，即使是最有经验的开发人员也面临许多不利因素。您可能面临紧迫的截止日期，或者正在构建一个概念证明，这在以后会成为一个永久的解决方案。在这种情况下，尽可能编写最优雅和组织良好的代码可能会让位于让它工作并让项目开始。

另外，你以后会清理项目的想法通常是一厢情愿的。

“即使一个有经验的开发人员已经说过 1000 次了，他们会回去的，但是你从来没有回去过。有时候会，但更多时候不会。因此，在前端处理事情是重要的考虑因素。丹说:“一旦你意识到自己有多少时间可以做一件事，或者意识到自己不会一直做这件事，你就可以围绕如何构建代码做出更好的决定。

## [](#cleaning-up-your-act)清理自己的行为

我们都同意，第一次编写清晰的代码比等待可能永远不会到来的未来重构要好。但是，当我们说易读的代码时，我们实际上指的是什么——以及如何做到这一点？接下来，Dan 分享了一些编写代码的技巧，让你的项目未来的所有者感谢你。

### [](#1-practice)1。练习。

Dan 建议通过小规模的培训来建立干净的编码技能。“你可以做一些练习，叫做[代码式](http://codekata.com/)的小练习，给你一个简单的问题。这是你可以在午休时间或 15 分钟内完成的事情，它给你一个机会来解决一个非常简短的问题，这样你就可以练习干净的代码开发。”

就像锻炼肌肉一样。这些实践会议可以帮助您培养将代码提炼为最简单形式的能力，当最佳实践成为第二天性时，保持它们就更容易了。

### [](#2-extract-extract-extract)2。提取，提取，提取。

代码可读性的最大优势之一是将代码提取到一次性函数中。丹举了一个例子:

“假设你写了一个 20 行的函数，它做了四件不同的事情。你可以将这四种不同的东西提取到它们各自独立的函数中。当你这样做的时候，你就完成了两件事:你把单个的东西隔离到它们自己的容器里，你简化了结构。”

多功能函数总是会带来更多的认知负荷，因为试图破译代码的开发人员必须弄清楚代码在做四件不同的事情。当你把它提取到单独的函数中时，阅读每段代码在做什么就变得容易多了。

“也许你的第一个函数在服务器上存储了一个设置。然后你提取的第二个函数可能会使用这个设置进行 API 调用。然后下一个函数根据结果做出某种反应，以此类推，”Dan 继续说道。“这四个功能读起来基本上就像一本书，告诉你我在做什么。”Dan 建议将代码提取出来，直到每个功能都有一个单独的职责——就这样。

一旦你把所有的东西都提取到单一用途的函数中，你可以通过把这些单一用途的函数放到文件的底部来使你的项目更具可读性。“把它们放在私有函数中，这样它们就不会暴露给全局命名空间，这样你的全局函数就非常简单，非常干净:一个调用其他四个函数的函数。Dan 说:“这使得它在文件的顶部非常干净和线性，人们实际上会在那里阅读，特别是如果私有函数名非常具有描述性的话。”。

> “如果你看到一个以这种方式编写的文件，那么你几乎可以肯定有人使用了干净的代码实践来提取、提取、提取并在顶部留下非常谨慎、非常具体、易于阅读的内容。”

### [](#3-use-descriptive-names)3。使用描述性名称。

描述性地命名函数和变量是一种实践，它对使您的代码对其他人可读大有帮助。“当你给事物起好名字时，它会自动记录你在做什么。没有人想写文档，也没有人想读文档。但是如果你，如果你描述性地命名函数和变量，那它就是自文档化的，然后你就可以把整个文档去掉了。”

在某个时候，最好的做法是尽可能简洁地使用命名约定来节省内存。但如今资源丰富的计算不再是这样的情况。

“在过去，你会使用两个字母的函数名，或者 I、j 和 k 这样的变量名。现在，编译器将编译代码，存储基本上是免费的。因此，在不必要的时候，没有必要简化函数名和变量。”

对于代码中的注释，Dan 也更喜欢自记录的方法。“你确实需要记录那些将要使用框架的人需要知道的任何信息。如果有一个默认的布尔值，你应该把它记录下来。但至于解释代码具体功能的多行注释，我再也看不到了。”

### [](#4-leverage-your-tools)4。利用您的工具

当所有其他方法都失败时，自动化它。依靠从干净的代码中去除猜测的工具，为自己的成功做好准备。

Dan 说，“我用 Xcode，Xcode 里面其实有工具可以让你重构东西。它可以从更大的代码块中提取方法，将其放入新的函数中，并计算出需要输入的内容。”

一致性是有助于代码可读性的另一个因素，linters 是一个执行样式和格式约定的很好的工具。但是只有在项目的早期就确定了 linters 的用法，它才是真正有用的。“棉绒是你想在一开始就放进去的东西之一，因为它会标记出你正在做的所有不符合你为那个项目设定的标准的事情。丹说:“如果一个项目已经进行了六个月，你已经写了 20，000 行代码，你就要在这一点上添加一个 linter 我们就把下个月放在一边，因为你只是要解决合规性问题。

如果你正在继承一个老的项目，linter 在这一点上帮不了你什么。但是，如果你足够幸运，从第一天就开始一个项目，引入 linter 可以做很多事情，使你的代码对分配到该项目的下一个开发人员可读。

## [](#coding-with-empathy)用移情编码

在我和 Dan 的谈话中，真正让我感兴趣的是，这不仅仅是一种学术追求，为了干净的代码而写干净的代码。让你的代码简单易读有一个人的因素。软件是由团队编写的——而不是由孤独的天才。用同理心编码意味着认识到其他开发人员会对您的代码做出贡献，并使您的代码对其他人来说是可接近的。

当你这样做时，你就可以开始创造超越个人的工作，并开始为他人服务。每个人都喜欢被认可，用特别巧妙的方式解决一个问题是令人满足的。但是最终，这不仅仅是你一个人的事——这关系到项目的质量和所有其他团队成员的成功，包括过去的、现在的和未来的，他们也有利害关系。

丹总结道:

> “不要为了聪明而写你的代码。不要试图给任何人留下深刻印象。如果你使用同理心驱动的发展，你会想到下一个正在做某件事的人，你会把他们记在心里做决定。它将会抑制你的自我，把你的自我从等式中去掉。”

## [](#conclusion)结论

大多数开发人员并不打算编写只对他们有意义的代码，但现实是有些因素与这些良好的意图背道而驰。您可能正在构建一个概念证明或 MVP，您打算以后再回来改进，但是以后再也不会来了。或者，你可能从一个项目的唯一所有者开始，只是为了继续前进或扩大你的团队。

一旦你认识到软件的寿命远远超过了它最初的创造者，你就可以通过以下方式开始采用干净的代码实践:

*   通过问题解决练习进行训练
*   将函数提取到单一用途的块中
*   描述性地命名函数和变量
*   使用内置工具和 linters 实现自动化一致性

…并且您将生成不会给从事您项目的未来开发人员带来困难的代码。那不仅仅是用同理心编码，那是善业。

感谢丹·穆雷尔的见解和引发这篇文章的对话。你可以在 Twitter @danimal99 或 tweet us @BigCommerceDevs 上找到丹。干杯！🍻