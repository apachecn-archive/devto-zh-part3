# WTH 是 OAuth？

> 原文:[https://dev.to/bassemibrahim/wth-is-oauth-1o24](https://dev.to/bassemibrahim/wth-is-oauth-1o24)

最近，我不得不在工作中的前端项目中添加单点登录 **SSO** 。我完全不知道 OAuth 是什么。我必须了解它，所以我来了！分享我到目前为止学到的东西😊

# OAuth 是什么

好吧，让我们从最基本的开始。OAuth 代表开放认证。这是第一个版本， **OAuth 1.0** 被设计用来处理**委托授权**问题。假设您需要让某个服务 *X* 访问位于服务 *Y* 中的一些数据。在 OAuth 之前，您必须将服务 *Y* 的密码给服务 *X* 。那就糟了！你不仅仅是给他们一些数据。您让他们完全控制您的帐户。毫无疑问，我们需要一个更好的方法！✋

这就是 OAuth 1.0 协议的由来，它允许服务 *X* 访问服务 *Y* 中的某些数据，而不泄露你的密码。💪

让我们从一些术语开始，只是为了让这篇文章的其余部分清楚。这些也是 OAuth 协议中的不同角色。

1.  **资源所有者**:基本上就是你，你拥有资源服务器中的数据
2.  **客户**:那就是服务 *X* 。换句话说，希望访问资源服务器中的资源的应用程序
3.  **授权服务器**:这个服务器负责授权对资源的访问。
4.  **资源服务器**:那是服务 *Y* ，换句话说，就是包含资源的应用。
5.  **资源** / **范围**:请求的资源。可能是一些数据，也可能是执行某些操作的权限。

注意，授权服务器和资源服务器可以是同一个应用程序，也可以是完全不同的应用程序。

# [](#oauth-flow-authorization-code-flow-)OAuth 流程(授权码流程)

我创建了这个显示整个 OAuth 流程的图表，快速浏览一下，我们将在图表后检查每个步骤。
[![OAuth Authorization Code Flow](../Images/0087c8578014ed5bf68cfd987321f94d.png)T3】](https://res.cloudinary.com/practicaldev/image/fetch/s--ifwiGH3y--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880/https://thepracticaldev.s3.amazonaws.com/i/sp7fy8xlrvi7gboli158.png)

是不是势不可挡？也许我不太擅长图表🙄。别急，我们一步一步来。

让我们用一个例子来说明这个问题。假设你想创建一个 *Spotify* 账户，但是让我们面对现实吧。你太懒了，不能把你所有的信息都加进去😞。你想让*脸书*为你填满它。所以你点击了注册 T4 脸书的按钮。让我们在这里停下来分析一下。

这里发生了什么事？根据 OAuth 术语，谁是谁？

1.  **资源** / **范围**是你的个人资料信息，即 *Spotify* 需要从 *facebook* 获得的数据，以便让你注册。
2.  **资源所有者**显然是你😒。
3.  *Spotify* 是**客户端**应用。
4.  *脸书*同时充当**资源服务器和**授权服务器。

坚持住！在我们深入研究图表之前，OAuth 依赖于一次性的初始配置步骤。基本上，这是认证服务器识别哪个客户端应用请求授权的一种方式。认证服务器生成一个**客户端 ID** 和一个**客户端秘密**，两者对于该客户端都是唯一的。然后，它们被保存在客户端，在接下来的步骤中使用，并且必须保密。
此外，每个客户端需要指定一个**重定向 URL** 。认证服务器在 OAuth 流中使用这个 URL。

### [](#with-that-said-lets-dig-into-that-diagram)说完了，我们来深究一下那个图。

1.  **首先是**，点击“注册脸书”按钮会将你重定向到认证服务器的登录页面。
    *   这一步需要两个参数:客户机 ID 和范围。
    *   认证服务器使用**客户端 ID** 来识别哪个客户端正在请求许可。
    *   **范围**用于标识正在请求哪些数据/权限。
2.  **登录**后，认证服务器将向用户显示同意屏幕
    *   同意屏幕询问资源所有者是否允许客户端访问范围中定义的数据/权限
3.  **授予许可**，认证服务器将把浏览器定向到重定向 URL，同时传递查询参数中的授权代码
4.  **有了代码**，客户端将需要用访问令牌交换代码和客户端秘密
5.  **有了访问令牌**，客户端最终可以从资源服务器访问资源

超级爽！但是，为什么我们需要额外的步骤来用访问令牌交换授权码呢？为什么我们不直接获取访问令牌呢？**嗯**，这是一种安全措施，它确保访问令牌不会暴露在重定向 URL 的参数中。

**否**，因为这个交换也需要客户端秘密，只有客户端应用和授权服务器知道。

这种流程称为授权代码流程，还存在其他类型。此外，OAuth 在最初发布后被滥用。这就是为什么需要 OAuth 2.0 和 OpenID connect。我可能会在以后的文章中更多地讨论这个问题。😌

如果你喜欢这篇博文，请告诉我。别忘了传播消息！

**一如既往，快乐编码🔥🔥**
或者阿拉伯语……**كودبسعادة语**