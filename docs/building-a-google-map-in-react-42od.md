# 在 React 中构建谷歌地图

> 原文：<https://dev.to/kimmiies/building-a-google-map-in-react-42od>

在这篇文章中，我将带你在 React 中构建一个谷歌地图组件，而不需要像 google-map-react 和 google-maps-react 这样的第三方库。相反，我们将在我们的组件中直接使用 Google 的地图 JavaScript API 和一些老式的普通 JavaScript。在评估是使用依赖项还是自己编写时，最好问自己以下问题:

1.  这个库使用了多少依赖项？
2.  这个库的捆绑大小是多少(捆绑恐惧症)？
3.  我能自己实现所需的最小功能吗？
4.  我需要对这个库进行测试吗？

在我们的例子中，两个库都使用了最小的依赖项(0–3 ),并且有一个 6–12KB 的最小捆绑包。这些数字一点也不离谱，但是考虑到任务的低风险性质和所需的最小功能，我们决定自己编写是一个好的(并且有趣的)选择。

**免责声明:本教程假设您对 JavaScript 和 React 有一定的了解。我们将遵循谷歌地图 JavaScript API 教程中的步骤，并在过程中加入我们自己的反应。

**第一步:创建一个名为“map”的 div 元素来保存地图。**

为了让地图显示在网页上，我们必须为它保留一个位置。通常，我们通过创建一个命名的 div 元素并在浏览器的文档对象模型(DOM)中获取对该元素的引用来实现这一点。我们可以使用 React Ref API 或 DOM 方法 getElementById 来获得这个引用。下面的代码片段演示了这两种情况:

第二步:定义一个 JavaScript 函数，在 div 中创建一个地图。
因为我们是以 React-y 的方式做这件事，我们将在 GoogleMap 类上创建一个实例方法。为了实例化 Google 的 map 类，我们将传递一个对 Map 元素的引用(来自步骤 1)以及两个强制选项:centre 和 zoom。这张特殊的地图将被放大到多伦多的街道上，并以加拿大国家电视塔地标为中心。

我们已经选择禁用默认界面，以保持地图尽可能简单。您可以通过添加或移除控件来自定义您自己的地图，这在文档中有更详细的描述。

第三步:使用脚本标签加载地图 JavaScript API。
这可以通过两种方式之一来实现。第一个是将您的脚本标签直接添加到您的 index.html 文件中，第二个是在我们的 Google Map 组件中动态创建一个脚本标签。出于将所有责任封装在 React 组件中的目的，我们将选择后者。

使用一些普通的 JavaScript，我们将创建一个 Script 元素，将其 src 属性设置为 JavaScript 文件的位置，该文件加载使用 Maps API 所需的所有资源，然后将其附加到文档正文。

第四步:创建我们的地图
我们就快到了！创建地图的倒数第二步是调用 createGoogleMap 函数(来自步骤 2)。在调用这个函数时需要注意的一点是，当我们试图在脚本完成加载之前实例化一个新的 Map 类时，很可能会遇到竞争情况，并收到一个 window.google 未定义的错误。为了防止这种情况发生，我们将在脚本标签中添加一个事件监听器，以确保在执行 createGoogleMap 之前加载了所有需要的文件。

**第五步:添加位置标记**
您可能已经注意到，在上面的代码片段中，我们存储了地图对象的实例。这背后的原因是，我们将需要这个相同的实例来实例化 Google 的 Marker 类。类似于我们如何编写一个函数来创建地图(在步骤 2 中),我们将编写一个函数来创建一个标记，这一次传入强制选项:位置和地图。这个特殊的标记将被放置在我们地图上 CN 塔地标的准确位置。

最后一步是在步骤 4 的事件监听器中执行这个函数，瞧，✨，你有一个完全封装在一个 React 组件中的谷歌地图，没有任何第三方库😎。

点击这里查看全文:[https://engineering . universe . com/building-a-Google-map-in-react-b 103 B4 ee 97 f 1](https://engineering.universe.com/building-a-google-map-in-react-b103b4ee97f1)