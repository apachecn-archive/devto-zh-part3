# 我的 web 服务器的计划

> 原文:[https://dev.to/joaopms/plans-for-my-web-server-3fbm](https://dev.to/joaopms/plans-for-my-web-server-3fbm)

我目前拥有一个托管在 OVH 的小型 VPS 服务器。它充当了一些 Linux 实验、一些我需要共享的文件以及安全问题和运行 web 服务的小丑嘉年华的家，我在几个月前设置了 web 服务，但最终忘记了。

虽然我仍在学习如何使用 Linux 以及如何保护服务器，但我已经从错误中吸取了教训，并制定了一个新的改进计划。

## [](#the-old-plan)旧计划

两年前，我对系统管理员和他们如何设置服务器感到惊讶。受到他们的启发，并希望我能加强一些安全性，我写下了一些要点:

*   只有端口 80 (HTTP)、443 (HTTPS)和 22 (SSH)是开放的
*   每个服务都有一个特定的 Linux 帐户
*   每个服务都在本地主机上侦听
*   nginx 通过反向代理公开这些服务
*   nginx 使用子域将流量路由到服务
*   让我们为每个子域加密证书

一切看起来都很棒，我也很兴奋，但随着时间的推移，这个计划很快就在背后捅了我一刀。

## [](#old-plan-flaws)旧计划的缺陷

*   **权限成了眼中钉**

    一些事情不工作，因为一个服务的工作目录不是用正确的帐户创建的，而且每次我想发布一个临时文件时都需要使用`sudo`；不用说，有一些文件和目录的权限设置为 777。

*   **服务的工作目录不集中**

    共享文件在`/var/www/static`上，一个 Node.js 应用在`~/dev/nodejs/app`上运行，...

*   **nginx 的配置文件有很多重复的块**

    由于每个服务/子域都有两个块 HTTP 反向代理和重定向到 HTTPS 的 HTTP 由于所有服务的逻辑都相同，所以许多块是相同的。

*   **每个子域的证书**

    当时，Let's Encrypt 不支持通配符证书；因此，每次我想部署新服务时，都必须更新证书。没那么糟糕，只是现在可以避免了。

*   **未使用/中断的服务**

    服务停止使用，东西坏了，内存泄漏发生了，我甚至没有注意到。这个*肯定*需要改进。

## [](#the-master-plan)主计划

*   使用 Docker 隔离、控制和集中服务；这也允许我测试新的闪亮的 JS 框架服务，而不会用不想要的包污染整个系统
*   图 3 .如何从一个简化的配置文件生成一个 nginx 配置文件
*   升级到“让我们加密”的通配符证书
*   将不经常访问的文件移动到一些外部冷存储解决方案
*   创建一个关于我的个人主页
*   托管 MySQL/MariaDB 数据库，半自动创建和删除帐户
*   开发一个 web 应用程序来管理共享文件

* * *

你认为这个新计划怎么样？你会用不同的方式做某事吗？建议不胜感激！