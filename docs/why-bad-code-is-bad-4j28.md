# 为什么坏代码是坏的

> 原文：<https://dev.to/matthewbdaly/why-bad-code-is-bad-4j28>

这听起来可能有点老套，但是为什么写不好的代码是不好的呢？

假设你是一个客户，或者一个开发团队的直线经理。您经常与开发人员一起工作，但是当他们说代码库不好时，会有什么后果，您如何证明花费时间和金钱来修复它是合理的？我经常听到这样一句话“如果有效，那就没关系”，这句话可能有点道理，但有点言不由衷。在这篇文章中，我将解释当你的代码基础不好时的一些后果。很难给交付糟糕代码的相关成本贴上一个明确的价格标签，但是这应该给你应该考虑的问题提供一些思路。

# 糟糕的代码扼杀了开发者的生产力

坏代码比好代码更难理解、导航和推理。开发人员不是超人，我们一次只能记住这么多，这就是为什么一个干净和可维护的代码库背后的许多原则本质上可以归结为“将其分成小块，以便开发人员可以在看到它们如何组合在一起之前孤立地理解每一个”。

如果一个特定的类或函数变得太大，开始做太多的事情，那么很快你就很难理解这个代码做了什么。开发人员在有效地使用一个类或函数之前，通常必须建立一个关于它如何工作的心理模型，你能保持的每个代码单元越小越简单，这样做所花费的时间和精力就越少。一个熟练的开发人员的标志不是他们代码库的复杂性，而是他们的简单性——他们已经学会了使他们的代码尽可能的小、简单和可读。一个干净的、布局良好的代码库可以让开发人员很容易进入一种被称为“心流”的精神状态，这种状态会大大提高工作效率。

此外，如果应用程序在某些方面不符合公认的惯例，例如使用不适当的 HTTP 动词(例如`GET`来改变某些东西的状态)，那么除了它不能很好地与代理服务器配合之外，它还会迫使开发人员放弃一组关于应用程序如何工作的合理假设，从而给开发人员带来额外的精神负担。如果应用程序使用了正确的 HTTP 动词，有经验的开发人员无需被告知就知道要创建新的报告，您需要向`reports` API 端点发送一个`POST`请求。

在项目的初始阶段，功能可以很快交付，但是如果代码质量很差，那么随着时间的推移，开发速度会降低。确保更高质量的代码库有助于在速度变大时将速度保持在一致的水平。这也意味着估计会更准确，所以如果你为一个特性报给定的小时数，你更有可能在这个小时数内交付。

# 糟糕的代码不利于开发者福利

重复的、组织混乱的、过于复杂的、难以阅读的代码库对于有压力的开发人员来说是一剂良方，更有可能让他们筋疲力尽。如果一个开发人员精疲力竭，他们的生产力将会大大下降。

从长远来看，如果开发人员的倦怠没有得到正确的管理，它可能会很容易地增加开发人员的流动率，因为有压力的开发人员会离开。如果新开发人员面临着处理混乱、压力大的代码库的前景，他们也很难招募到新的开发人员。

# 糟糕的代码阻碍了你的能力

如果您的代码质量很差，这意味着如果需要更改或添加功能，那么需要做更多的工作。重复的代码可能意味着某些东西必须在不止一个地方更新，如果它变得过于繁重，它可能会使更改变得过于耗时或昂贵。

# 糟糕的代码可能会威胁到你项目的长期生存能力

在我们的行业中，有一件事是肯定的，那就是事情会发生变化。库、语言和框架都在不断更新，有时其中一些会有潜在的突破性变化。有时，一个库或框架会被终止，这使得有必要迁移到一个替代品。

糟糕的代码通常与特定的框架或库紧密耦合，有时甚至与特定的版本紧密耦合，这使得在必要时进行移植变得更加困难。如果一个项目是用一种有严重问题的语言或框架版本编写的，并且过于紧密地耦合以至于不能迁移到一个新的版本，那么保持它的运行可能太危险了，或者尽管存在风险，也有必要运行一个不安全的应用程序。

# 糟糕的代码更脆弱

一个糟糕的代码库会崩溃，而且经常是以终端用户清晰可见的方式。重复的代码很容易遗漏需要在多个地方更新的情况，如果代码库缺乏测试，严重的错误可能在很长一段时间内都不会被注意到，尤其是相对微妙的错误。

# 糟糕的代码很难(如果不是不可能的话)编写自动化测试

如果一个特定的类或函数做得太多，为它编写自动化测试就会变得更加困难，因为有更多的变量和更多的预期结果。一个足够混乱的代码库可能只有通过自动化浏览器才是真正可测试的，这往往非常缓慢和脆弱，使得测试驱动的开发不切实际。手动测试不能代替一套合适的自动化测试，因为它更慢，一致性更差，并且不可重复，而且它本身只适用于最琐碎的 web 应用程序。

# 糟糕的代码往往是不安全的

糟糕的代码库可能会无意中暴露用户的数据，或者面临各种攻击的风险，例如跨站点脚本和 SQL 注入攻击，这些攻击也可能会暴露太多的数据。

对于任何拥有 EU-用户的企业来说，暴露用户数据的风险是非常严重的。根据《GDPR 》,潜在罚款高达 2000 万欧元，或营业额的 4%。这对许多公司来说都是潜在的生存风险。

此外，糟糕的代码库通常更容易受到拒绝服务攻击。如果它的缓存很差或者没有缓存，查询过多，或者查询效率低下，那么每次页面加载时，它都会执行比优化站点更多的查询。给定相同的服务器规格，效率低的网站将比效率高的网站更快被淹没。

# 总结

当花在清理上的时间不够支付账单时，很容易只关注交付一个工作产品，而不担心代码库的质量，并且很难向客户证明清理的成本是合理的。

您可以使用一些工具来帮助保持代码质量，比如 linters 和 static analysers，并且研究一下您所使用的语言的可用工具也不失为一个好主意。为了获得最佳结果，它们应该成为您持续集成管道的一部分，这样您就可以随时监控变化，并提示签入有问题代码的开发人员修复问题。代码审查是避免糟糕代码的另一个好方法，因为它们允许开发人员找到有问题的代码，并提供更好的解决方案。

我并不是说有一些瑕疵的代码库没有价值，或者当资金紧张时，你应该投入大量的开发人员时间来重构混乱的代码，因为商业上的考虑必须放在第一位。但是一个糟糕的代码库确实会导致严重的财务问题，谨慎的做法是认识到它可能导致的问题，并采取行动解决它们，或者更好的做法是，从一开始就防止它们发生。